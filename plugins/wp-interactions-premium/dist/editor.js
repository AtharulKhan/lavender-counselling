/*! For license information please see editor.js.LICENSE.txt */
(()=>{var __webpack_modules__={3442:()=>{WPIRunner.addActionConfig({addUrlHash:{initAction:e=>{e.initActionFunction((()=>{window.location.hash=e.getValue("hash")}))}}})},3880:()=>{WPIRunner.addActionConfig({backgroundColor:{initAction:e=>{e.initActionAnimation({backgroundColor:e.getValue("color")})},blockElementSelector:(e,t)=>t.isBlock("core/cover")?`${e} > .wp-block-cover__background`:t.isBlock("core/button")?`${e} > .wp-element-button`:t.isBlock("stackable/button")?`${e} > .stk-button`:e,initialStyles:e=>`background-color: ${e.getValue("color")};`}})},9144:()=>{WPIRunner.addActionConfig({backgroundImage:{initAction:e=>{e.initActionAnimation({backgroundImage:`url(${e.getValue("image")})`})},initialStyles:e=>`background-image: url(${e.getValue("image")});`}})},7782:()=>{WPIRunner.addActionConfig({click:{initAction:e=>{e.initActionFunction((()=>{e.getTargets().forEach((e=>{e.dispatchEvent(new MouseEvent("click",{bubbles:!0,cancelable:!0,view:window}))}))}))}}})},2815:()=>{WPIRunner.addActionConfig({confetti:{initAction:e=>{e.initActionFunction((()=>{const t={x:.5,y:.65},n=e.getTargets();let i=n.length?n[0]:window;if(0===i.clientHeight&&0===i.clientWidth&&(i=window),i!==window&&i!==document){const e=i.getBoundingClientRect();t.x=(e.left+e.width/2)/window.innerWidth,t.y=(e.top+e.height/2+20)/window.innerHeight}window.wpi.confetti(t)}))}}})},805:()=>{WPIRunner.addActionConfig({confirm:{initAction:e=>{e.initActionFunction((()=>{if(!window.confirm(e.getValue("message")))return!1}))}}})},6175:()=>{WPIRunner.addActionConfig({consoleLog:{initAction:action=>{action.initActionFunction((targets=>{const isEditor=!!WPIRunner._editorConfig,value=action.getValue("value"),func=function(){const data=action.getAllProvidedData();try{return console.log("WP Interactions Log:",eval(value)),!0}catch{return!1}};targets.length||targets.push(document);let errored=!0;targets.forEach((e=>{!isEditor&&func.call(e)&&(errored=!1)})),errored&&console.log("WP Interactions Log:",value)}))}}})},7246:()=>{WPIRunner.addActionConfig({copyToClipboard:{initAction:e=>{e.initActionFunction((()=>{if(navigator.clipboard)navigator.clipboard.writeText(e.getValue("text"));else{const t=document.createElement("textarea");t.value=e.getValue("text"),document.body.appendChild(t),t.select(),document.execCommand("copy"),document.body.removeChild(t)}}))}}})},277:()=>{WPIRunner.addActionConfig({cssRule:{initAction:e=>{const t=e.getValue("property"),n=()=>e.getValue("value",e.getValue("property"));if(CSS.supports(t,n())||CSS.supports(t,n()+"px"))return e.initActionAnimation({[t]:n,onBegin:e=>e.refresh()})},initialStyles:e=>`${e.getValue("property")}: ${e.getValue("value")};`}})},9231:()=>{WPIRunner.addActionConfig({customJs:{initAction:action=>{action.initActionFunction((targets=>new Promise((resolve=>{const code=action.getValue("code"),func=function(){const data=action.getAllProvidedData();try{return eval(code)}catch(e){throw e}},results=[];targets.length||targets.push(document),targets.forEach((e=>{const t=func.call(e);results.push(t)})),1===results.length?action.provideData("id",results[0]):action.provideData("id",results),resolve()}))))}}})},5588:()=>{WPIRunner.addActionConfig({customPhp:{initAction:e=>{e.initActionFunction((()=>{const{interactionKey:t,key:n}=e;return new Promise(((i,a)=>{fetch(`${wpi.restUrl}wpi/v1/custom-php`,{method:"POST",mode:"same-origin",credentials:"same-origin",headers:{"Content-Type":"application/json","X-WP-Nonce":wpi.restNonce},body:JSON.stringify({interaction_key:t,action_key:n,data:e.getAllProvidedData()})}).then((e=>{if(e.ok)return e.text();a(e)})).then((t=>{e.provideData("id",t),i(t)})).catch((e=>{a(e)}))}))}))}}})},9397:()=>{WPIRunner.addActionConfig({dataFromAttribute:{initAction:e=>{e.initActionFunction((()=>{const t=e.getValue("attribute"),n=e.getTargets();if(n.length&&t){let i=n[0].getAttribute(t);if(null===i){const e=n[0].querySelector(`[${t}]`);e&&(i=e.getAttribute(t))}e.provideData("id",i)}}))}}})},9382:()=>{WPIRunner.addActionConfig({dispatchEvent:{initAction:e=>{e.initActionFunction((()=>{e.getTargets().forEach((t=>{t.dispatchEvent(new CustomEvent(e.getValue("event"),{detail:e.getValue("value")}))}))}))}}})},8608:()=>{WPIRunner.addActionConfig({display:{initAction:e=>{e.initActionAnimation({display:e.getValue("display")})},initialStyles:e=>`display: ${e.getValue("display")};`}})},335:()=>{WPIRunner.addActionConfig({focus:{initAction:e=>{e.initActionFunction((()=>{const t=e.getTargets();if(t.length){const e=t[0];if(e.focus)try{e.focus()}catch(e){}if(document.activeElement!==e){const t=e.querySelector('button, [href], input, select, textarea, [tabindex]:not([tabindex="-1"])');t&&t.focus()}}}))}}})},7587:()=>{WPIRunner.addActionConfig({getParameterUrl:{initAction:e=>{e.initActionFunction((()=>{const t=e.getValue("parameter"),n=new URLSearchParams(window.location.search).get(t);if(n){const t=n.replace(/[<>"'`]/g,(e=>({"<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;","`":"&#x60;"}[e])));e.provideData("id",t)}}))}}})},1777:()=>{WPIRunner.addActionConfig({getPostData:{initAction:e=>{e.initActionFunction((()=>new Promise(((t,n)=>{const i={post_id:"current-post"===e.getValue("post")?wpi.currentPostId:e.getValue("post_id"),data_type:e.getValue("data_type"),meta_key:"meta"===e.getValue("data_type")?e.getValue("meta_key"):void 0};fetch(`${wpi.restUrl}wpi/v1/get-post-data`,{method:"POST",mode:"same-origin",credentials:"same-origin",headers:{"Content-Type":"application/json","X-WP-Nonce":wpi.restNonce},body:JSON.stringify(i)}).then((e=>{if(e.ok)return e.text();n(e)})).then((n=>{e.provideData("id",n),t(n)})).catch((e=>{n(e)}))}))))}}})},7159:()=>{WPIRunner.addActionConfig({incrementDecrement:{initAction:e=>{e.initActionFunction((()=>{e.getTargets().forEach((t=>{const n="decrement"===e.getValue("mode")?-1:1,i=e.getValue("property");if(i){let e=parseInt(t.getAttribute(i));isNaN(e)&&(e=0),t.setAttribute(i,e+n)}else!function(e,t){const n=document.createTreeWalker(e,NodeFilter.SHOW_TEXT,null,!1);for(;n.nextNode();){const e=n.currentNode,i=e.parentNode.nodeName.toLowerCase();if(["style","script","pre","code","svg","g","path","circle","ellipse","line","polygon","polyline","rect","text","use","defs","linearGradient","radialGradient","stop","image","view","animate","animateTransform","mask","pattern","clipPath","filter","feGaussianBlur","feOffset","feMerge","desc","title"].includes(i))continue;let a=e.nodeValue;const r=a.match(/\d+/g);if(r){const n=r[0],i=parseInt(n),o=i+t;return a=a.replace(i,o),void(e.nodeValue=a)}}}(t,n)}))}))}}})},1320:()=>{WPIRunner.addActionConfig({input:{initAction:e=>{e.initActionFunction((()=>{const t=e.getValue("value");e.getTargets().forEach((e=>{let n=e;e.tagName&&e.tagName.toLowerCase().match(/^(input|textarea|select)$/)||(n=e.querySelector("input, textarea, select")),n&&("checkbox"===n.type||"radio"===n.type?n.checked=!(!t||"false"===t):n.value=t)}))}))}}})},3543:()=>{WPIRunner.addActionConfig({insertHtml:{initAction:e=>{e.initActionFunction((()=>{e.getTargets().forEach((t=>{t.insertAdjacentHTML(e.getValue("position"),e.getValue("html"))}))}))}}})},9425:()=>{WPIRunner.addActionConfig({localStorage:{initAction:e=>{e.initActionFunction((()=>{localStorage.setItem(e.getValue("key"),e.getValue("value"))}))},initialStyles:e=>{localStorage.setItem(e.getValue("key"),e.getValue("value"))}}})},7507:()=>{WPIRunner.addActionConfig({move:{initAction:e=>{const t={};void 0!==e.getValue("x")&&(t.translateX=e.getValue("x")),void 0!==e.getValue("y")&&(t.translateY=e.getValue("y")),void 0!==e.getValue("z")&&(t.translateZ=e.getValue("z")),e.initActionAnimation(t)},initialStyles:e=>{const t=[];return void 0!==e.getValue("x")&&t.push(`translateX(${e.getValue("x")}px)`),void 0!==e.getValue("y")&&t.push(`translateY(${e.getValue("y")}px)`),void 0!==e.getValue("z")&&t.push(`translateZ(${e.getValue("z")}px)`),0===t.length?"":`transform: ${t.join(" ")};`}}})},2051:()=>{WPIRunner.addActionConfig({opacity:{initAction:e=>{e.initActionAnimation({opacity:e.getValue("opacity")})},initialStyles:e=>`opacity: ${e.getValue("opacity")};`}})},7337:()=>{let e="";WPIRunner.addActionConfig({pageState:{initAction:t=>{t.initActionFunction((()=>{dispatchEvent(new CustomEvent("wpi/page-state",{detail:{oldValue:e,newValue:t.getValue("state")}})),e=t.getValue("state")}))},initialStyles:t=>{e=t.getValue("state")}}})},671:()=>{WPIRunner.addActionConfig({redirectToUrl:{initAction:e=>{e.initActionFunction((()=>{window.location.href=e.getValue("url")}))}}})},4517:()=>{WPIRunner.addActionConfig({renderShortcode:{initAction:e=>{e.initActionFunction((()=>{const{interactionKey:t,key:n}=e;return new Promise(((i,a)=>{fetch(`${wpi.restUrl}wpi/v1/render-shortcode`,{method:"POST",mode:"same-origin",credentials:"same-origin",headers:{"Content-Type":"application/json","X-WP-Nonce":wpi.restNonce},body:JSON.stringify({interaction_key:t,action_key:n,data:e.getAllProvidedData()})}).then((e=>{if(e.ok)return e.text();a(e)})).then((t=>{e.provideData("id",t),i(t)})).catch((e=>{a(e)}))}))}))}}})},8143:()=>{WPIRunner.addActionConfig({replaceHtml:{initAction:e=>{e.initActionFunction((()=>{e.getTargets().forEach((t=>{t.innerHTML=e.getValue("html")}))}))}}})},1070:()=>{WPIRunner.addActionConfig({replaceText:{initAction:e=>{e.initActionFunction((()=>{e.getTargets().forEach((t=>{!function(e,t){const n=document.createTreeWalker(e,NodeFilter.SHOW_TEXT,null,!1);for(;n.nextNode();){const e=n.currentNode,i=e.parentNode.nodeName.toLowerCase();if(!["style","script","pre","code","svg","g","path","circle","ellipse","line","polygon","polyline","rect","text","use","defs","linearGradient","radialGradient","stop","image","view","animate","animateTransform","mask","pattern","clipPath","filter","feGaussianBlur","feOffset","feMerge","desc","title"].includes(i))return void(e.nodeValue=t)}}(t,e.getValue("text"))}))}))}}})},2750:()=>{WPIRunner.addActionConfig({rotate:{initAction:e=>{e.initActionAnimation({rotate:e.getValue("rotate")})},initialStyles:e=>`transform: rotate(${e.getValue("rotate")}deg);`}})},7071:()=>{WPIRunner.addActionConfig({rotate3d:{initAction:e=>{const t={perspective:"1500px"};void 0!==e.getValue("x")&&(t.rotateX=e.getValue("x")),void 0!==e.getValue("y")&&(t.rotateY=e.getValue("y")),void 0!==e.getValue("z")&&(t.rotateZ=e.getValue("z")),e.initActionAnimation(t)},initialStyles:e=>{const t=["perspective(1500px)"];return void 0!==e.getValue("x")&&t.push(`rotateX(${e.getValue("x")}deg)`),void 0!==e.getValue("y")&&t.push(`rotateY(${e.getValue("y")}deg)`),void 0!==e.getValue("z")&&t.push(`rotateZ(${e.getValue("z")}deg)`),1===t.length?"":`transform: ${t.join(" ")};`}}})},1369:()=>{WPIRunner.addActionConfig({scale:{initAction:e=>{e.initActionAnimation({scaleX:e.getValue("x"),scaleY:e.getValue("y")})},initialStyles:e=>`transform: scaleX(${e.getValue("x")}) scaleY(${e.getValue("y")});`}})},8838:(e,t,n)=>{"use strict";n.r(t);var i={};!function e(t,n,i,a){var r=!!(t.Worker&&t.Blob&&t.Promise&&t.OffscreenCanvas&&t.OffscreenCanvasRenderingContext2D&&t.HTMLCanvasElement&&t.HTMLCanvasElement.prototype.transferControlToOffscreen&&t.URL&&t.URL.createObjectURL),o="function"==typeof Path2D&&"function"==typeof DOMMatrix,s=function(){if(!t.OffscreenCanvas)return!1;var e=new OffscreenCanvas(1,1),n=e.getContext("2d");n.fillRect(0,0,1,1);var i=e.transferToImageBitmap();try{n.createPattern(i,"no-repeat")}catch(e){return!1}return!0}();function l(){}function c(e){var i=n.exports.Promise,a=void 0!==i?i:t.Promise;return"function"==typeof a?new a(e):(e(l,l),null)}var u,p,d,m,h,g,_,f,w,y,v,b=(u=s,p=new Map,{transform:function(e){if(u)return e;if(p.has(e))return p.get(e);var t=new OffscreenCanvas(e.width,e.height);return t.getContext("2d").drawImage(e,0,0),p.set(e,t),t},clear:function(){p.clear()}}),E=(h=Math.floor(1e3/60),g={},_=0,"function"==typeof requestAnimationFrame&&"function"==typeof cancelAnimationFrame?(d=function(e){var t=Math.random();return g[t]=requestAnimationFrame((function n(i){_===i||_+h-1<i?(_=i,delete g[t],e()):g[t]=requestAnimationFrame(n)})),t},m=function(e){g[e]&&cancelAnimationFrame(g[e])}):(d=function(e){return setTimeout(e,h)},m=function(e){return clearTimeout(e)}),{frame:d,cancel:m}),k=(y={},function(){if(f)return f;if(!i&&r){var t=["var CONFETTI, SIZE = {}, module = {};","("+e.toString()+")(this, module, true, SIZE);","onmessage = function(msg) {","  if (msg.data.options) {","    CONFETTI(msg.data.options).then(function () {","      if (msg.data.callback) {","        postMessage({ callback: msg.data.callback });","      }","    });","  } else if (msg.data.reset) {","    CONFETTI && CONFETTI.reset();","  } else if (msg.data.resize) {","    SIZE.width = msg.data.resize.width;","    SIZE.height = msg.data.resize.height;","  } else if (msg.data.canvas) {","    SIZE.width = msg.data.canvas.width;","    SIZE.height = msg.data.canvas.height;","    CONFETTI = module.exports.create(msg.data.canvas);","  }","}"].join("\n");try{f=new Worker(URL.createObjectURL(new Blob([t])))}catch(e){return void 0!==typeof console&&"function"==typeof console.warn&&console.warn("🎊 Could not load worker",e),null}!function(e){function t(t,n){e.postMessage({options:t||{},callback:n})}e.init=function(t){var n=t.transferControlToOffscreen();e.postMessage({canvas:n},[n])},e.fire=function(n,i,a){if(w)return t(n,null),w;var r=Math.random().toString(36).slice(2);return w=c((function(i){function o(t){t.data.callback===r&&(delete y[r],e.removeEventListener("message",o),w=null,b.clear(),a(),i())}e.addEventListener("message",o),t(n,r),y[r]=o.bind(null,{data:{callback:r}})}))},e.reset=function(){for(var t in e.postMessage({reset:!0}),y)y[t](),delete y[t]}}(f)}return f}),S={particleCount:50,angle:90,spread:45,startVelocity:45,decay:.9,gravity:1,drift:0,ticks:200,x:.5,y:.5,shapes:["square","circle"],zIndex:100,colors:["#26ccff","#a25afd","#ff5e7e","#88ff5a","#fcff42","#ffa62d","#ff36ff"],disableForReducedMotion:!1,scalar:1};function C(e,t,n){return function(e,t){return t?t(e):e}(e&&null!=e[t]?e[t]:S[t],n)}function T(e){return e<0?0:Math.floor(e)}function x(e){return parseInt(e,16)}function I(e){return e.map(A)}function A(e){var t=String(e).replace(/[^0-9a-f]/gi,"");return t.length<6&&(t=t[0]+t[0]+t[1]+t[1]+t[2]+t[2]),{r:x(t.substring(0,2)),g:x(t.substring(2,4)),b:x(t.substring(4,6))}}function D(e){e.width=document.documentElement.clientWidth,e.height=document.documentElement.clientHeight}function P(e){var t=e.getBoundingClientRect();e.width=t.width,e.height=t.height}function N(e,n){var s,l=!e,u=!!C(n||{},"resize"),p=!1,d=C(n,"disableForReducedMotion",Boolean),m=r&&C(n||{},"useWorker")?k():null,h=l?D:P,g=!(!e||!m||!e.__confetti_initialized),_="function"==typeof matchMedia&&matchMedia("(prefers-reduced-motion)").matches;function f(t,n,r){for(var l,u,p,d,m=C(t,"particleCount",T),g=C(t,"angle",Number),_=C(t,"spread",Number),f=C(t,"startVelocity",Number),w=C(t,"decay",Number),y=C(t,"gravity",Number),v=C(t,"drift",Number),k=C(t,"colors",I),S=C(t,"ticks",Number),x=C(t,"shapes"),A=C(t,"scalar"),D=!!C(t,"flat"),P=function(e){var t=C(e,"origin",Object);return t.x=C(t,"x",Number),t.y=C(t,"y",Number),t}(t),N=m,M=[],O=e.width*P.x,B=e.height*P.y;N--;)M.push((void 0,void 0,u=(l={x:O,y:B,angle:g,spread:_,startVelocity:f,color:k[N%k.length],shape:x[(0,d=x.length,Math.floor(Math.random()*(d-0))+0)],ticks:S,decay:w,gravity:y,drift:v,scalar:A,flat:D}).angle*(Math.PI/180),p=l.spread*(Math.PI/180),{x:l.x,y:l.y,wobble:10*Math.random(),wobbleSpeed:Math.min(.11,.1*Math.random()+.05),velocity:.5*l.startVelocity+Math.random()*l.startVelocity,angle2D:-u+(.5*p-Math.random()*p),tiltAngle:(.5*Math.random()+.25)*Math.PI,color:l.color,shape:l.shape,tick:0,totalTicks:l.ticks,decay:l.decay,drift:l.drift,random:Math.random()+2,tiltSin:0,tiltCos:0,wobbleX:0,wobbleY:0,gravity:3*l.gravity,ovalScalar:.6,scalar:l.scalar,flat:l.flat}));return s?s.addFettis(M):(s=function(e,t,n,r,s){var l,u,p=t.slice(),d=e.getContext("2d"),m=c((function(t){function c(){l=u=null,d.clearRect(0,0,r.width,r.height),b.clear(),s(),t()}l=E.frame((function t(){!i||r.width===a.width&&r.height===a.height||(r.width=e.width=a.width,r.height=e.height=a.height),r.width||r.height||(n(e),r.width=e.width,r.height=e.height),d.clearRect(0,0,r.width,r.height),(p=p.filter((function(e){return function(e,t){t.x+=Math.cos(t.angle2D)*t.velocity+t.drift,t.y+=Math.sin(t.angle2D)*t.velocity+t.gravity,t.velocity*=t.decay,t.flat?(t.wobble=0,t.wobbleX=t.x+10*t.scalar,t.wobbleY=t.y+10*t.scalar,t.tiltSin=0,t.tiltCos=0,t.random=1):(t.wobble+=t.wobbleSpeed,t.wobbleX=t.x+10*t.scalar*Math.cos(t.wobble),t.wobbleY=t.y+10*t.scalar*Math.sin(t.wobble),t.tiltAngle+=.1,t.tiltSin=Math.sin(t.tiltAngle),t.tiltCos=Math.cos(t.tiltAngle),t.random=Math.random()+2);var n=t.tick++/t.totalTicks,i=t.x+t.random*t.tiltCos,a=t.y+t.random*t.tiltSin,r=t.wobbleX+t.random*t.tiltCos,s=t.wobbleY+t.random*t.tiltSin;if(e.fillStyle="rgba("+t.color.r+", "+t.color.g+", "+t.color.b+", "+(1-n)+")",e.beginPath(),o&&"path"===t.shape.type&&"string"==typeof t.shape.path&&Array.isArray(t.shape.matrix))e.fill(function(e,t,n,i,a,r,o){var s=new Path2D(e),l=new Path2D;l.addPath(s,new DOMMatrix(t));var c=new Path2D;return c.addPath(l,new DOMMatrix([Math.cos(o)*a,Math.sin(o)*a,-Math.sin(o)*r,Math.cos(o)*r,n,i])),c}(t.shape.path,t.shape.matrix,t.x,t.y,.1*Math.abs(r-i),.1*Math.abs(s-a),Math.PI/10*t.wobble));else if("bitmap"===t.shape.type){var l=Math.PI/10*t.wobble,c=.1*Math.abs(r-i),u=.1*Math.abs(s-a),p=t.shape.bitmap.width*t.scalar,d=t.shape.bitmap.height*t.scalar,m=new DOMMatrix([Math.cos(l)*c,Math.sin(l)*c,-Math.sin(l)*u,Math.cos(l)*u,t.x,t.y]);m.multiplySelf(new DOMMatrix(t.shape.matrix));var h=e.createPattern(b.transform(t.shape.bitmap),"no-repeat");h.setTransform(m),e.globalAlpha=1-n,e.fillStyle=h,e.fillRect(t.x-p/2,t.y-d/2,p,d),e.globalAlpha=1}else if("circle"===t.shape)e.ellipse?e.ellipse(t.x,t.y,Math.abs(r-i)*t.ovalScalar,Math.abs(s-a)*t.ovalScalar,Math.PI/10*t.wobble,0,2*Math.PI):function(e,t,n,i,a,r,o,s,l){e.save(),e.translate(t,n),e.rotate(r),e.scale(i,a),e.arc(0,0,1,0,s,void 0),e.restore()}(e,t.x,t.y,Math.abs(r-i)*t.ovalScalar,Math.abs(s-a)*t.ovalScalar,Math.PI/10*t.wobble,0,2*Math.PI);else if("star"===t.shape)for(var g=Math.PI/2*3,_=4*t.scalar,f=8*t.scalar,w=t.x,y=t.y,v=5,E=Math.PI/v;v--;)w=t.x+Math.cos(g)*f,y=t.y+Math.sin(g)*f,e.lineTo(w,y),g+=E,w=t.x+Math.cos(g)*_,y=t.y+Math.sin(g)*_,e.lineTo(w,y),g+=E;else e.moveTo(Math.floor(t.x),Math.floor(t.y)),e.lineTo(Math.floor(t.wobbleX),Math.floor(a)),e.lineTo(Math.floor(r),Math.floor(s)),e.lineTo(Math.floor(i),Math.floor(t.wobbleY));return e.closePath(),e.fill(),t.tick<t.totalTicks}(d,e)}))).length?l=E.frame(t):c()})),u=c}));return{addFettis:function(e){return p=p.concat(e),m},canvas:e,promise:m,reset:function(){l&&E.cancel(l),u&&u()}}}(e,M,h,n,r),s.promise)}function w(n){var i=d||C(n,"disableForReducedMotion",Boolean),a=C(n,"zIndex",Number);if(i&&_)return c((function(e){e()}));l&&s?e=s.canvas:l&&!e&&(e=function(e){var t=document.createElement("canvas");return t.style.position="fixed",t.style.top="0px",t.style.left="0px",t.style.pointerEvents="none",t.style.zIndex=e,t}(a),document.body.appendChild(e)),u&&!g&&h(e);var r={width:e.width,height:e.height};function o(){if(m){var t={getBoundingClientRect:function(){if(!l)return e.getBoundingClientRect()}};return h(t),void m.postMessage({resize:{width:t.width,height:t.height}})}r.width=r.height=null}function w(){s=null,u&&(p=!1,t.removeEventListener("resize",o)),l&&e&&(document.body.contains(e)&&document.body.removeChild(e),e=null,g=!1)}return m&&!g&&m.init(e),g=!0,m&&(e.__confetti_initialized=!0),u&&!p&&(p=!0,t.addEventListener("resize",o,!1)),m?m.fire(n,r,w):f(n,r,w)}return w.reset=function(){m&&m.reset(),s&&s.reset()},w}function M(){return v||(v=N(null,{useWorker:!0,resize:!0})),v}n.exports=function(){return M().apply(this,arguments)},n.exports.reset=function(){M().reset()},n.exports.create=N,n.exports.shapeFromPath=function(e){if(!o)throw new Error("path confetti are not supported in this browser");var t,n;"string"==typeof e?t=e:(t=e.path,n=e.matrix);var i=new Path2D(t),a=document.createElement("canvas").getContext("2d");if(!n){for(var r,s,l=1e3,c=l,u=l,p=0,d=0,m=0;m<l;m+=2)for(var h=0;h<l;h+=2)a.isPointInPath(i,m,h,"nonzero")&&(c=Math.min(c,m),u=Math.min(u,h),p=Math.max(p,m),d=Math.max(d,h));r=p-c,s=d-u;var g=Math.min(10/r,10/s);n=[g,0,0,g,-Math.round(r/2+c)*g,-Math.round(s/2+u)*g]}return{type:"path",path:t,matrix:n}},n.exports.shapeFromText=function(e){var t,n=1,i="#000000",a='"Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol", "Noto Color Emoji", "EmojiOne Color", "Android Emoji", "Twemoji Mozilla", "system emoji", sans-serif';"string"==typeof e?t=e:(t=e.text,n="scalar"in e?e.scalar:n,a="fontFamily"in e?e.fontFamily:a,i="color"in e?e.color:i);var r=10*n,o=r+"px "+a,s=new OffscreenCanvas(r,r),l=s.getContext("2d");l.font=o;var c=l.measureText(t),u=Math.ceil(c.actualBoundingBoxRight+c.actualBoundingBoxLeft),p=Math.ceil(c.actualBoundingBoxAscent+c.actualBoundingBoxDescent),d=c.actualBoundingBoxLeft+2,m=c.actualBoundingBoxAscent+2;u+=4,p+=4,(l=(s=new OffscreenCanvas(u,p)).getContext("2d")).font=o,l.fillStyle=i,l.fillText(t,d,m);var h=1/n;return{type:"bitmap",bitmap:s.transferToImageBitmap(),matrix:[h,0,0,h,-u*h/2,-p*h/2]}}}(function(){return"undefined"!=typeof window?window:"undefined"!=typeof self?self:this||{}}(),i,!1);const a=i.exports;var r;i.exports.create,window.wpi=null!==(r=window.wpi)&&void 0!==r?r:{},window.wpi.confetti=e=>{const t=(t,n)=>{a({origin:e,...n,particleCount:Math.floor(120*t)})};t(.25,{spread:26,startVelocity:55}),t(.2,{spread:60}),t(.35,{spread:100,decay:.91,scalar:.8}),t(.1,{spread:120,startVelocity:25,decay:.92,scalar:1.2}),t(.1,{spread:120,startVelocity:45})}},9967:()=>{WPIRunner.addActionConfig({scrollToElement:{initAction:e=>{const t={pos:0};e.initActionAnimation({targets:t,pos:()=>{const t=e.getTargets();if(t.length){const{top:n,height:i}=t[0].getBoundingClientRect();let a=n+window.scrollY;const r=e.getValue("scrollPosition");return"center"===r?a-=window.innerHeight/2-i/2:"bottom"===r&&(a-=window.innerHeight-i),a+=e.getValue("offset")||0,[window.scrollY,a]}},onUpdate:()=>{window.scrollTo(0,t.pos)}})}}})},4846:()=>{WPIRunner.addActionConfig({scrubVideo:{initAction:e=>{var t;const n=e.getTargets();let i=parseFloat(e.getValue("targetTime"));const a=n[0]?.querySelector("video");if(!a)return;let r=null!==(t=a.paused)&&void 0!==t&&t;const o=()=>{r=a.paused,i=Math.min(i,a.duration),a.pause();const t=e.timeline.type;if("percentage"===t)e.initActionAnimation({targets:[a],currentTime:i,onUpdate:()=>{a.paused||a.pause()}});else if("time"===t){var n;const t={time:null!==(n=a.currentTime)&&void 0!==n?n:0};e.initActionAnimation({targets:[t],time:i,onUpdate:()=>{a.paused||a.pause(),a.currentTime=t.time}})}};a.readyState>=1?o():a.addEventListener("loadedmetadata",o,{once:!0}),window.addEventListener("wpi/timeline-stop-preview",(()=>{setTimeout((()=>{r||a.play()}))}),{once:!0})}}})},3321:()=>{WPIRunner.addActionConfig({skew:{initAction:e=>{e.initActionAnimation({skewX:e.getValue("x"),skewY:e.getValue("y")})},initialStyles:e=>`transform: skewX(${e.getValue("x")}) skewY(${e.getValue("y")});`}})},922:()=>{WPIRunner.addActionConfig({stop:{initAction:e=>{e.initActionFunction((()=>{const t=e.getValue("value"),n=e.getValue("condition"),i=e.getValue("comparison_value"),a=e.getValue("comparison_multi_value").split("\\n").map((e=>e.trim()));if("equals"===n){if(t===i)return!1}else if("not-equals"===n){if(t!==i)return!1}else if("contains"===n){if(t.includes(i))return!1}else if("not-contains"===n){if(!t.includes(i))return!1}else if("greater-than"===n){if(t>i)return!1}else if("greater-than-or-equal-to"===n){if(t>=i)return!1}else if("less-than"===n){if(t<i)return!1}else if("less-than-or-equal-to"===n){if(t<=i)return!1}else if("is-empty"===n){if(""===t)return!1}else if("is-not-empty"===n){if(""!==t)return!1}else if("matches-regex"===n){if(new RegExp(i).test(t))return!1}else if("does-not-match-regex"===n){if(!new RegExp(i).test(t))return!1}else if("is-truthy"===n){if(t)return!1}else if("is-falsey"===n){if(!t)return!1}else if("is-in"===n){if(a.includes(t))return!1}else if("is-not-in"===n&&!a.includes(t))return!1}))}}})},5431:()=>{WPIRunner.addActionConfig({textColor:{initAction:e=>{e.initActionAnimation({color:e.getValue("color")})},blockElementSelector:(e,t)=>t.isBlock("core/button")?`${e} > .wp-element-button`:t.isBlock("stackable/button")?`${e} .stk-button__inner-text`:e,initialStyles:e=>`color: ${e.getValue("color")};`}})},2784:()=>{WPIRunner.addActionConfig({textFromElement:{initAction:e=>{e.initActionFunction((()=>{const t=e.getTargets();if(t.length){const n=t[0].innerText;e.provideData("id",n||"")}}))}}})},245:()=>{WPIRunner.addActionConfig({toggleClass:{initAction:e=>{e.initActionFunction((()=>{const t=e.getValue("class"),n=e.getValue("action");t&&e.getTargets().forEach((e=>{"toggle"===n?e.classList.toggle(t):"add"===n?e.classList.add(t):"remove"===n&&e.classList.remove(t)}))}))}}})},964:()=>{WPIRunner.addActionConfig({toggleVideo:{initAction:e=>{e.initActionFunction((()=>{const t=e.getTargets();let n=parseFloat(e.getValue("startTime"));const i=e.getValue("mode"),a=t[0]?.querySelector("video");if(!a)return;a.preload="auto";const r=()=>{switch(n=Math.min(n,a.duration),i){case"play":n&&(a.currentTime=n),a.play();break;case"pause":a.pause();break;case"toggle":a.paused?a.play():a.pause()}};a.readyState>=1?r():a.addEventListener("loadedmetadata",r,{once:!0})}))}}})},1419:()=>{WPIRunner.addActionConfig({updateAttribute:{initAction:e=>{e.initActionFunction((()=>{const t=e.getValue("attribute"),n=e.getValue("value"),i=e.getValue("action");t&&e.getTargets().forEach((e=>{"toggle"===i?e.getAttribute(t)===n?e.removeAttribute(t):e.setAttribute(t,n):"update"===i?e.setAttribute(t,n):"remove"===i&&e.removeAttribute(t)}))}))}}})},5505:()=>{WPIRunner.addActionConfig({updatePostMeta:{initAction:e=>{e.initActionFunction((()=>{const{interactionKey:t,key:n}=e;return new Promise(((i,a)=>{const r={interaction_key:t,action_key:n,post_id:"current-post"===e.getValue("post")?wpi.currentPostId:e.getValue("post_id"),meta_key:e.getValue("meta_key"),update_type:e.getValue("update_type"),value:e.getValue("value")};fetch(`${wpi.restUrl}wpi/v1/update-post-meta`,{method:"POST",mode:"same-origin",credentials:"same-origin",headers:{"Content-Type":"application/json","X-WP-Nonce":wpi.restNonce},body:JSON.stringify(r)}).then((e=>{if(e.ok)return e.text();a(e)})).then((t=>{e.provideData("id",t),i(t)})).catch((e=>{a(e)}))}))}))}}})},5743:()=>{WPIRunner.addActionConfig({valueFromInput:{initAction:e=>{e.initActionFunction((()=>{const t=e.getTargets();if(t.length){const n=t[0];if("INPUT"===n.tagName)e.provideData("id",n.value);else{const t=n.querySelector("input");t&&e.provideData("id",t.value)}}}))}}})},9717:()=>{WPIRunner.addActionConfig({visibility:{initAction:e=>{e.initActionFunction((()=>{const t=e.getValue("visibility"),n=e=>{e.removeAttribute("hidden"),e.setAttribute("aria-hidden",!1),e.style.removeProperty("display")},i=e=>{e.setAttribute("hidden",!0),e.setAttribute("aria-hidden",!0),e.style.setProperty("display","none","important")};e.getTargets().forEach((e=>{const a=e.hasAttribute("hidden");"toggle"===t?a?n(e):i(e):"show"===t&&a?n(e):"hide"!==t||a||i(e)}))}))},initialStyles:e=>{const t=e.getValue("visibility");if("hide"===t||"toggle"===t)return"display: none !important;"},runInitialScript:(e,t)=>{const n=e.getValue("visibility");t.forEach((e=>{const t=e=>{e.removeAttribute("hidden"),e.setAttribute("aria-hidden",!1),e.style.removeProperty("display")},i=e=>{e.setAttribute("hidden",!0),e.setAttribute("aria-hidden",!0),e.style.setProperty("display","none","important")},a=e.hasAttribute("hidden");"toggle"===n?a?t(e):i(e):"show"===n&&a?t(e):"hide"!==n||a||i(e)})),e.removeStartingStyles()}}})},1275:()=>{WPIRunner.addInteractionEditorConfig({mouseHovering:{initTimeline:(e,t,n=0)=>{const i=t.getOption("smoothness",200),a=t.getOption("resetToCenter",!0),r=t.getOption("resetDelay",1e3);let o=null;const s=t=>{if(t.currentTarget!==c)return;clearTimeout(o);const a=c.getBoundingClientRect(),r=t.clientX-a.left,s=t.clientY-a.top,l=r/a.width,u=s/a.height;0===n?e.seekPercentage(l,i):e.seekPercentage(u,i)},l=t=>{a&&t.currentTarget===c&&(clearTimeout(o),o=setTimeout((()=>{e.seekPercentage(.5,700)}),r))},c=t.getCurrentTrigger();return c.addEventListener("mousemove",s),c.addEventListener("mouseleave",l),e.seekPercentage(.5),()=>{c.removeEventListener("mousemove",s),c.removeEventListener("mouseleave",l),clearTimeout(o)}}}})},9578:()=>{WPIRunner.addInteractionEditorConfig({pageScrolling:{initTimeline:(e,t)=>{const n=t.getOption("smoothness",200),i=t.getRunner().getDocument();let a=null;a="BODY"===i.tagName?i.ownerDocument:i.closest(".interface-navigable-region");const r=(t,i=!1)=>{const a=t.target.scrollingElement||t.target,r=a.scrollTop/(a.scrollHeight-a.clientHeight);e.seekPercentage(r,!0===i?0:n)};return a&&(a.addEventListener("scroll",r),setTimeout((()=>{r({target:a},!0)}))),()=>{a.removeEventListener("scroll",r)}}}})},2797:()=>{WPIRunner.addInteractionEditorConfig({scrollStrength:{initTimeline:(e,t)=>{const n=t.getOption("smoothness",200),i=t.getOption("max_scroll",100),a=t.getRunner().getDocument();let r=null;r="BODY"===a.tagName?a.ownerDocument:a.closest(".interface-navigable-region");let o=Math.max(document.body.scrollTop||document.documentElement.scrollTop,document.body.scrollLeft||document.documentElement.scrollLeft),s=0;const l=t=>{const a=t.target.scrollingElement||t.target,r=Math.max(a.scrollTop,a.scrollLeft),l=Math.abs(r-o);s=Math.min(l/i,1),e.seekPercentage(s,n),o=r};let c;const u=()=>{window.clearTimeout(c),c=setTimeout((function(){s=0,e.seekPercentage(s,n)}),66)};return r&&(r.addEventListener("scroll",l),r.addEventListener("scroll",u)),()=>{r.removeEventListener("scroll",l),r.removeEventListener("scroll",u)}}}})},4184:(e,t)=>{var n;!function(){"use strict";var i={}.hasOwnProperty;function a(){for(var e=[],t=0;t<arguments.length;t++){var n=arguments[t];if(n){var r=typeof n;if("string"===r||"number"===r)e.push(n);else if(Array.isArray(n)){if(n.length){var o=a.apply(null,n);o&&e.push(o)}}else if("object"===r){if(n.toString!==Object.prototype.toString&&!n.toString.toString().includes("[native code]")){e.push(n.toString());continue}for(var s in n)i.call(n,s)&&n[s]&&e.push(s)}}}return e.join(" ")}e.exports?(a.default=a,e.exports=a):void 0===(n=function(){return a}.apply(t,[]))||(e.exports=n)}()},2408:(e,t)=>{"use strict";var n=Symbol.for("react.element"),i=(Symbol.for("react.portal"),Symbol.for("react.fragment")),a=(Symbol.for("react.strict_mode"),Symbol.for("react.profiler"),Symbol.for("react.provider"),Symbol.for("react.context"),Symbol.for("react.forward_ref"),Symbol.for("react.suspense"),Symbol.for("react.memo"),Symbol.for("react.lazy"),Symbol.iterator,{isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}}),r=Object.assign,o={};function s(e,t,n){this.props=e,this.context=t,this.refs=o,this.updater=n||a}function l(){}function c(e,t,n){this.props=e,this.context=t,this.refs=o,this.updater=n||a}s.prototype.isReactComponent={},s.prototype.setState=function(e,t){if("object"!=typeof e&&"function"!=typeof e&&null!=e)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,t,"setState")},s.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")},l.prototype=s.prototype;var u=c.prototype=new l;u.constructor=c,r(u,s.prototype),u.isPureReactComponent=!0;Array.isArray;var p=Object.prototype.hasOwnProperty,d={current:null},m={key:!0,ref:!0,__self:!0,__source:!0};t.Fragment=i,t.createElement=function(e,t,i){var a,r={},o=null,s=null;if(null!=t)for(a in void 0!==t.ref&&(s=t.ref),void 0!==t.key&&(o=""+t.key),t)p.call(t,a)&&!m.hasOwnProperty(a)&&(r[a]=t[a]);var l=arguments.length-2;if(1===l)r.children=i;else if(1<l){for(var c=Array(l),u=0;u<l;u++)c[u]=arguments[u+2];r.children=c}if(e&&e.defaultProps)for(a in l=e.defaultProps)void 0===r[a]&&(r[a]=l[a]);return{$$typeof:n,type:e,key:o,ref:s,props:r,_owner:d.current}}},7294:(e,t,n)=>{"use strict";e.exports=n(2408)},165:(e,t,n)=>{var i={"./addUrlHash.js":3442,"./backgroundColor.js":3880,"./backgroundImage.js":9144,"./click.js":7782,"./confetti.js":2815,"./confirm.js":805,"./consoleLog.js":6175,"./copyToClipboard.js":7246,"./cssRule.js":277,"./customJs.js":9231,"./customPhp.js":5588,"./dataFromAttribute.js":9397,"./dispatchEvent.js":9382,"./display.js":8608,"./focus.js":335,"./getParameterUrl.js":7587,"./getPostData.js":1777,"./incrementDecrement.js":7159,"./input.js":1320,"./insertHtml.js":3543,"./localStorage.js":9425,"./move.js":7507,"./opacity.js":2051,"./pageState.js":7337,"./redirectToUrl.js":671,"./renderShortcode.js":4517,"./replaceHtml.js":8143,"./replaceText.js":1070,"./rotate.js":2750,"./rotate3d.js":7071,"./scale.js":1369,"./scripts/confetti.js":8838,"./scrollToElement.js":9967,"./scrubVideo.js":4846,"./skew.js":3321,"./stop.js":922,"./textColor.js":5431,"./textFromElement.js":2784,"./toggleClass.js":245,"./toggleVideo.js":964,"./updateAttribute.js":1419,"./updatePostMeta.js":5505,"./valueFromInput.js":5743,"./visibility.js":9717};function a(e){var t=r(e);return n(t)}function r(e){if(!n.o(i,e)){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}return i[e]}a.keys=function(){return Object.keys(i)},a.resolve=r,e.exports=a,a.id=165},9038:(e,t,n)=>{var i={"./mouseHovering.js":1275,"./pageScrolling.js":9578,"./scrollStrength.js":2797};function a(e){var t=r(e);return n(t)}function r(e){if(!n.o(i,e)){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}return i[e]}a.keys=function(){return Object.keys(i)},a.resolve=r,e.exports=a,a.id=9038}},__webpack_module_cache__={};function __webpack_require__(e){var t=__webpack_module_cache__[e];if(void 0!==t)return t.exports;var n=__webpack_module_cache__[e]={exports:{}};return __webpack_modules__[e](n,n.exports,__webpack_require__),n.exports}__webpack_require__.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return __webpack_require__.d(t,{a:t}),t},__webpack_require__.d=(e,t)=>{for(var n in t)__webpack_require__.o(t,n)&&!__webpack_require__.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},__webpack_require__.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),__webpack_require__.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})};var __webpack_exports__={};(()=>{"use strict";var e=__webpack_require__(7294);const t=t=>(0,e.createElement)("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",...t},(0,e.createElement)("path",{d:"M13.2 12.2 10 15.4c1 .7 2.2 1 3.5 1 3.5 0 6.4-2.9 6.4-6.4S17 3.6 13.5 3.6c-1.3 0-2.5.4-3.5 1l3.2 3.2c1.2 1.2 1.2 3.2 0 4.4zM5.8 10c0-2.1.9-4.1 2.3-5.5l-.4-.4c-.3-.3-.8-.5-1.3-.5-.4 0-.9.2-1.2.5L.6 8.7C.2 9 0 9.5 0 10s.2.9.5 1.3l4.6 4.6c.3.3.8.5 1.3.5s.9-.2 1.3-.5l.4-.4c-1.4-1.4-2.3-3.4-2.3-5.5z"}),(0,e.createElement)("path",{d:"M7.1 10c0 1.8.7 3.4 1.9 4.6l3.3-3.3c.7-.7.7-1.9 0-2.6L9 5.4A6.42 6.42 0 0 0 7.1 10z"})),n=t=>(0,e.createElement)("svg",{xmlns:"http://www.w3.org/2000/svg",height:"1em",viewBox:"0 0 512 512",...t},(0,e.createElement)("path",{d:"M256 464c114.9 0 208-93.1 208-208S370.9 48 256 48 48 141.1 48 256c0 5.5.2 10.9.6 16.3L1.8 286.1C.6 276.2 0 266.2 0 256 0 114.6 114.6 0 256 0s256 114.6 256 256-114.6 256-256 256c-10.2 0-20.2-.6-30.1-1.8l13.8-46.9c5.4.4 10.8.6 16.3.6zm-2.4-48 14.3-48.6c56.3-6 100.1-53.6 100.1-111.4 0-61.9-50.1-112-112-112-57.8 0-105.4 43.8-111.4 100.1L96 258.4V256c0-88.4 71.6-160 160-160s160 71.6 160 160-71.6 160-160 160h-2.4zM0 320l272-80-80 272-48-96-1.4-1.4-96 96-45.2-45.2 96-96L96 368 0 320z"})),i=t=>(0,e.createElement)("svg",{xmlns:"http://www.w3.org/2000/svg",height:"1em",viewBox:"0 0 512 512",...t},(0,e.createElement)("path",{d:"M0 32h512v448H0V32zm464 192H48v208h416V224zM128 96H64v64h64V96zm32 0v64h64V96h-64zm160 0h-64v64h64V96z"}));var a=__webpack_require__(4184),r=__webpack_require__.n(a);const o=wp.components,s=wp.blockEditor,l=wp.hooks,c=wp.i18n,u={value:"",onChange:()=>{},preOnChange:e=>e,colors:[],isGradient:!1},p=t=>{const{onChange:n,preOnChange:i,value:a,colors:r}={...u,...t},c=r.reduce(((e,t)=>[...e,...t.colors||t.gradients]),[]);let p,d=a;return c.some((e=>(e.color===a||e.gradient===a)&&(d=e.name,p=e.name,!0))),p=d||("transparent"===a?"Transparent":a),(0,e.createElement)(e.Fragment,null,(0,e.createElement)(o.ColorPicker,{onChange:e=>{n(i(e,a))},color:a,enableAlpha:!0}),(0,e.createElement)(o.ColorPalette,{value:a,onChange:e=>{const t=(0,s.getColorObjectByColorValue)(c,e);n(i((0,l.applyFilters)("stackable.color-palette-control.change",e,t),a))},disableCustomColors:!0,label:p,clearable:!1,colors:r,__experimentalHasMultipleOrigins:!0}))},d={placement:"left-start",offset:36,shift:!0},m=()=>{},h=({colorValue:t,label:n})=>(0,e.createElement)(o.__experimentalHStack,{justify:"flex-start"},(0,e.createElement)(o.ColorIndicator,{className:"stk-color-indicator block-editor-panel-color-gradient-settings__color-indicator",colorValue:t}),(0,e.createElement)(o.FlexItem,{className:"stk-color-name block-editor-panel-color-gradient-settings__color-name",title:n},n)),g=t=>{const{onChange:n=m,value:i,...a}=t,c=(0,l.applyFilters)("stackable.color-palette-control.color-value",i),{colors:u}=(0,l.applyFilters)("stackable.color-palette-control.colors",(0,s.__experimentalUseMultipleOriginColorsAndGradients)()),g=u.reduce(((e,t)=>[...e,...t.colors]),[]);let _,f=c;g.some((e=>(e.color===c||e.gradient===c)&&(f=e.name,_=e.name,!0))),_=f||("transparent"===c?"Transparent":c);const w={colorValue:c,label:_},y=(0,e.createElement)(p,{value:c,onChange:n,colors:u});return(0,e.createElement)(o.BaseControl,{className:"wpi-color-control",...a},(0,e.createElement)(o.Dropdown,{popoverProps:d,className:"block-editor-tools-panel-color-gradient-settings__dropdown",renderToggle:(v=w,({onToggle:t,isOpen:n})=>{const{colorValue:i,label:a}=v,s={onClick:t,className:r()("block-editor-panel-color-gradient-settings__dropdown",{"is-open":n}),"aria-expanded":n};return(0,e.createElement)(o.Button,{...s},(0,e.createElement)(h,{colorValue:i,label:a}))}),renderContent:()=>(0,e.createElement)("div",{className:"wpi-color-palette-control__popover-content"},y)}));var v},_=interactions,f=lodash,w=wp.element,y=wp.data,v=wp.apiFetch;var b=__webpack_require__.n(v);const E=()=>{},k=(e,t,n,i)=>{const a=(0,f.cloneDeep)(e);return t>=a.length?(a.push([i]),a):n>=a[t].length?(a[t].push(i),a):(a[t].splice(n,0,i),a)},S={};_.locationRuleTypes.forEach((({options:e})=>{e.forEach((({value:e,editorOptions:t})=>{S[e]=t}))}));const C=t=>{const{param:n="",operator:i="==",value:a="",onChange:r=E,onRemove:s=E,onClickAnd:l=E,showRemove:u=!0}=t,[p,d]=(0,w.useState)([]),[m,h]=(0,w.useState)(!1);(0,w.useEffect)((()=>{h(!0),b()({path:`/wpi/v1/get_location_rules/${n}`,method:"GET"}).then((e=>{h(!1);const t=e;if("post"===n||"page"===n){const e=(0,y.select)("core/editor").getCurrentPostType();t.some((({post_type:t,options:n})=>{if(t===e){const t=(0,y.select)("core/editor").getCurrentPostId(),i=n.some((({value:e})=>e===t));if(!i){const i={value:t,label:(0,c.sprintf)((0,c.__)("Current %s","wp-interactions"),"page"===e?(0,c.__)("Page","wp-interactions"):(0,c.__)("Post","wp-interactions"))};n.unshift(i)}return!0}return!1}))}d(t)})).catch((e=>{console.error("WP Interactions error getting location rules:",e)}))}),[n]);const{hasValueControl:g=!0}=S[n];return(0,e.createElement)("div",{className:"wpi-location-rule"},(0,e.createElement)(o.SelectControl,{className:"wpi-location-rule__param",value:n,onChange:e=>{r({param:e,operator:i,value:a})}},_.locationRuleTypes.map((({label:t,options:n})=>(0,e.createElement)("optgroup",{key:t,label:t},n.map((({value:t,label:n})=>(0,e.createElement)("option",{key:t,value:t},n))))))),g&&(0,e.createElement)(o.SelectControl,{className:"wpi-location-rule__operator",value:i,onChange:e=>{r({param:n,operator:e,value:a})}},(0,e.createElement)("option",{value:"=="},(0,c.__)("is equal to","wp-interactions")),(0,e.createElement)("option",{value:"!="},(0,c.__)("is not equal to","wp-interactions"))),g&&(0,e.createElement)(o.SelectControl,{className:"wpi-location-rule__value",value:a,disabled:m,onChange:e=>{r({param:n,operator:i,value:e})}},p.map((({label:t,value:n,options:i})=>{if(!i&&n)return(0,e.createElement)("option",{key:n,value:n},t);const a=i.map((({value:t,label:n})=>(0,e.createElement)("option",{key:t,value:t},n)));return t?(0,e.createElement)("optgroup",{key:t,label:t},a):a}))),(0,e.createElement)("div",{className:"wpi-location-rule__buttons"},(0,e.createElement)(o.Button,{variant:"secondary",label:(0,c.__)("and","wp-interactions"),onClick:l},(0,c.__)("and","wp-interactions")),u&&(0,e.createElement)(o.Button,{className:"wpi-location-rule__remove-button",variant:"tertiary",isDestructive:!0,icon:"trash",label:(0,c.__)("Remove rule","wp-interactions"),onClick:s})))},T=t=>{const{locations:n=[],onChange:i=E}=t,a=1===n.length&&1===n[0].length;return(0,e.createElement)(o.BaseControl,{label:(0,c.__)("Show this interaction if","wp-interactions")},n.map(((t,r)=>(0,e.createElement)(w.Fragment,{key:r},t.map(((t,o)=>(0,e.createElement)(C,{key:o,param:t.param,operator:t.operator,value:t.value,showRemove:!a,onChange:e=>{i(((e,t,n,i)=>{const a=(0,f.cloneDeep)(e);return a[t][n]=i,a})(n,r,o,e))},onRemove:()=>{i(((e,t,n)=>{const i=(0,f.cloneDeep)(e);return i[t].splice(n,1),0===i[t].length&&i.splice(t,1),i})(n,r,o))},onClickAnd:()=>{const e=0===n.length?(0,y.select)("core/editor").getCurrentPostId():"";i(k(n,r,o+1,{param:"post",operator:"==",value:e||""}))}}))),(0,e.createElement)("div",{className:"wpi-location-rule__or"},(0,c.__)("or","wp-interactions"))))),(0,e.createElement)(o.Button,{label:(0,c.__)("Add rule group","wp-interactions"),variant:"secondary",onClick:()=>{const e=0===n.length?(0,y.select)("core/editor").getCurrentPostId():"";i(k(n,n.length,0,{param:"post",operator:"==",value:e||""}))}},(0,c.__)("Add rule group","wp-interactions")))},x=()=>(0,e.createElement)(e.Fragment,null,(0,e.createElement)("optgroup",{label:"Default"},(0,e.createElement)("option",{value:"linear"},(0,c.__)("Linear (None)","wp-interactions")),(0,e.createElement)("option",{value:"custom"},(0,c.__)("Custom","wp-interactions"))),(0,e.createElement)("optgroup",{label:"Ease In"},(0,e.createElement)("option",{value:"inQuad"},(0,c.sprintf)((0,c.__)("Ease In %s","wp-interactions"),(0,c.__)("Quad","wp-interactions"))),(0,e.createElement)("option",{value:"inCubic"},(0,c.sprintf)((0,c.__)("Ease In %s","wp-interactions"),(0,c.__)("Cubic","wp-interactions"))),(0,e.createElement)("option",{value:"inQuart"},(0,c.sprintf)((0,c.__)("Ease In %s","wp-interactions"),(0,c.__)("Quart","wp-interactions"))),(0,e.createElement)("option",{value:"inQuint"},(0,c.sprintf)((0,c.__)("Ease In %s","wp-interactions"),(0,c.__)("Quint","wp-interactions"))),(0,e.createElement)("option",{value:"inSine"},(0,c.sprintf)((0,c.__)("Ease In %s","wp-interactions"),(0,c.__)("Sine","wp-interactions"))),(0,e.createElement)("option",{value:"inExpo"},(0,c.sprintf)((0,c.__)("Ease In %s","wp-interactions"),(0,c.__)("Expo","wp-interactions"))),(0,e.createElement)("option",{value:"inCirc"},(0,c.sprintf)((0,c.__)("Ease In %s","wp-interactions"),(0,c.__)("Circ","wp-interactions"))),(0,e.createElement)("option",{value:"inBack"},(0,c.sprintf)((0,c.__)("Ease In %s","wp-interactions"),(0,c.__)("Back","wp-interactions"))),(0,e.createElement)("option",{value:"inBounce"},(0,c.sprintf)((0,c.__)("Ease In %s","wp-interactions"),(0,c.__)("Bounce","wp-interactions")))),(0,e.createElement)("optgroup",{label:"Ease Out"},(0,e.createElement)("option",{value:"outQuad"},(0,c.sprintf)((0,c.__)("Ease Out %s","wp-interactions"),(0,c.__)("Quad","wp-interactions"))),(0,e.createElement)("option",{value:"outCubic"},(0,c.sprintf)((0,c.__)("Ease Out %s","wp-interactions"),(0,c.__)("Cubic","wp-interactions"))),(0,e.createElement)("option",{value:"outQuart"},(0,c.sprintf)((0,c.__)("Ease Out %s","wp-interactions"),(0,c.__)("Quart","wp-interactions"))),(0,e.createElement)("option",{value:"outQuint"},(0,c.sprintf)((0,c.__)("Ease Out %s","wp-interactions"),(0,c.__)("Quint","wp-interactions"))),(0,e.createElement)("option",{value:"outSine"},(0,c.sprintf)((0,c.__)("Ease Out %s","wp-interactions"),(0,c.__)("Sine","wp-interactions"))),(0,e.createElement)("option",{value:"outExpo"},(0,c.sprintf)((0,c.__)("Ease Out %s","wp-interactions"),(0,c.__)("Expo","wp-interactions"))),(0,e.createElement)("option",{value:"outCirc"},(0,c.sprintf)((0,c.__)("Ease Out %s","wp-interactions"),(0,c.__)("Circ","wp-interactions"))+" ("+(0,c.__)("default","wp-interactions")+")"),(0,e.createElement)("option",{value:"outBack"},(0,c.sprintf)((0,c.__)("Ease Out %s","wp-interactions"),(0,c.__)("Back","wp-interactions"))),(0,e.createElement)("option",{value:"outBounce"},(0,c.sprintf)((0,c.__)("Ease Out %s","wp-interactions"),(0,c.__)("Bounce","wp-interactions")))),(0,e.createElement)("optgroup",{label:"Ease In Out"},(0,e.createElement)("option",{value:"inOutQuad"},(0,c.sprintf)((0,c.__)("Ease In Out %s","wp-interactions"),(0,c.__)("Quad","wp-interactions"))),(0,e.createElement)("option",{value:"inOutCubic"},(0,c.sprintf)((0,c.__)("Ease In Out %s","wp-interactions"),(0,c.__)("Cubic","wp-interactions"))),(0,e.createElement)("option",{value:"inOutQuart"},(0,c.sprintf)((0,c.__)("Ease In Out %s","wp-interactions"),(0,c.__)("Quart","wp-interactions"))),(0,e.createElement)("option",{value:"inOutQuint"},(0,c.sprintf)((0,c.__)("Ease In Out %s","wp-interactions"),(0,c.__)("Quint","wp-interactions"))),(0,e.createElement)("option",{value:"inOutSine"},(0,c.sprintf)((0,c.__)("Ease In Out %s","wp-interactions"),(0,c.__)("Sine","wp-interactions"))),(0,e.createElement)("option",{value:"inOutExpo"},(0,c.sprintf)((0,c.__)("Ease In Out %s","wp-interactions"),(0,c.__)("Expo","wp-interactions"))),(0,e.createElement)("option",{value:"inOutCirc"},(0,c.sprintf)((0,c.__)("Ease In Out %s","wp-interactions"),(0,c.__)("Circ","wp-interactions"))),(0,e.createElement)("option",{value:"inOutBack"},(0,c.sprintf)((0,c.__)("Ease In Out %s","wp-interactions"),(0,c.__)("Back","wp-interactions"))),(0,e.createElement)("option",{value:"inOutBounce"},(0,c.sprintf)((0,c.__)("Ease In Out %s","wp-interactions"),(0,c.__)("Bounce","wp-interactions")))),(0,e.createElement)("optgroup",{label:"Ease Out In"},(0,e.createElement)("option",{value:"outInQuad"},(0,c.sprintf)((0,c.__)("Ease Out In %s","wp-interactions"),(0,c.__)("Quad","wp-interactions"))),(0,e.createElement)("option",{value:"outInCubic"},(0,c.sprintf)((0,c.__)("Ease Out In %s","wp-interactions"),(0,c.__)("Cubic","wp-interactions"))),(0,e.createElement)("option",{value:"outInQuart"},(0,c.sprintf)((0,c.__)("Ease Out In %s","wp-interactions"),(0,c.__)("Quart","wp-interactions"))),(0,e.createElement)("option",{value:"outInQuint"},(0,c.sprintf)((0,c.__)("Ease Out In %s","wp-interactions"),(0,c.__)("Quint","wp-interactions"))),(0,e.createElement)("option",{value:"outInSine"},(0,c.sprintf)((0,c.__)("Ease Out In %s","wp-interactions"),(0,c.__)("Sine","wp-interactions"))),(0,e.createElement)("option",{value:"outInExpo"},(0,c.sprintf)((0,c.__)("Ease Out In %s","wp-interactions"),(0,c.__)("Expo","wp-interactions"))),(0,e.createElement)("option",{value:"outInCirc"},(0,c.sprintf)((0,c.__)("Ease Out In %s","wp-interactions"),(0,c.__)("Circ","wp-interactions"))),(0,e.createElement)("option",{value:"outInBack"},(0,c.sprintf)((0,c.__)("Ease Out In %s","wp-interactions"),(0,c.__)("Back","wp-interactions"))),(0,e.createElement)("option",{value:"outInBounce"},(0,c.sprintf)((0,c.__)("Ease Out In %s","wp-interactions"),(0,c.__)("Bounce","wp-interactions"))))),I=t=>(0,e.createElement)("svg",{xmlns:"http://www.w3.org/2000/svg",width:14,height:16,viewBox:"0 0 448 512",...t},(0,e.createElement)("path",{d:"M16 288 320 0l-59.3 197.6L432 224 128 512l59.3-197.6L16 288z"})),A=()=>{},D=[],P={placement:"bottom-end",shift:!0},N=[{label:(0,c.__)("No values available","wp-interactions"),value:"",disabled:!0}],M=t=>{const{property:n={},properties:i={},value:a="",onChange:r=A,hasDynamic:s=!1,stepProvidedValues:l=D}=t;let u=n.help?(0,e.createElement)("span",{dangerouslySetInnerHTML:{__html:n.help}}):null;const{hasDynamic:p=!0}=n,d=!!s&&p,m=("professional"===_.plan||"agency"===_.plan)&&d;if(n.condition){const{property:e,value:t}=n.condition;if(Array.isArray(t)){if(!t.includes(i[e]))return null}else if(i[e]!==t)return null}if("number"===n.type)return(0,e.createElement)(o.BaseControl,{className:"wpi-property-control wpi-property-control--number",label:n.name,help:u},(0,e.createElement)(o.__experimentalHStack,null,(0,e.createElement)(o.RangeControl,{value:(0,f.clamp)(a,n.min||0,n.max||100),onChange:r,min:n.min||0,max:n.max||100,step:n.step||1,withInputField:!1}),(0,e.createElement)(o.__experimentalNumberControl,{value:a,onChange:r,step:n.step||1})));if("select"===n.type)return(0,e.createElement)(o.SelectControl,{label:n.name,value:a,onChange:r,options:n.options,help:u});if("note"===n.type)return(0,e.createElement)("p",null,n.name);if("color"===n.type)return(0,e.createElement)(g,{label:n.name,value:a,onChange:r,help:u});if("toggle"===n.type)return(0,e.createElement)(o.ToggleControl,{label:n.name,checked:a,onChange:r,help:u});const h="textarea"===n.type||"code"===n.type?o.TextareaControl:o.TextControl,w={};if("id"===n.type){const t=(0,c.__)("Give this data a unique name to make it available to other actions. Can only be lowercase letters, numbers and underscore.","wp-interactions");u=n.help?(0,e.createElement)(e.Fragment,null,u," ",t):t,w.hasDynamic=!1,w.onBlur=()=>{const e=a.toLowerCase().replace(/[^\d\w]+/g,"_").replace(/[^a-z0-9_]/gi,"");e!==a&&r(e)}}return(0,e.createElement)(o.BaseControl,{className:"wpi-property-control wpi-property-control--text",label:n.name,help:u},(0,e.createElement)(o.__experimentalHStack,{alignment:"top"},(0,e.createElement)(h,{value:a,onChange:r,placeholder:n.placeholder||"",...w}),m&&(0,e.createElement)(o.Dropdown,{popoverProps:P,focusOnMount:!0,renderToggle:({isOpen:t,onToggle:n})=>(0,e.createElement)(o.Button,{className:"wpi-property-control__dynamic-button",variant:"secondary",onClick:n,"aria-expanded":t,label:(0,c.__)("Use value from earlier step","wp-interactions")},(0,e.createElement)(I,null)),renderContent:({onToggle:t})=>(0,e.createElement)("div",{className:"wpi-property-control__dynamic-popover-content"},(0,e.createElement)("h4",{style:{marginTop:0}},(0,c.__)("Use a Value From an Earlier Step","wp-interactions")),(0,e.createElement)("p",null,(0,c.__)("This list shows all previously acquired data in your timeline.","wp-interactions")),(0,e.createElement)(o.MenuGroup,null,(0,e.createElement)(o.MenuItemsChoice,{choices:l.length?l.map((e=>({label:e,value:e}))):N,onSelect:e=>{e&&("php"===n.language?r(`$data->${e}`):r(`data.${e}`),t())}})))})))},O=()=>{const e=document.querySelector('iframe[name="editor-canvas"]');let t=document.querySelector(".editor-styles-wrapper");return e&&(t=e.contentDocument.querySelector(".editor-styles-wrapper")),t},B=t=>(0,e.createElement)("svg",{xmlns:"http://www.w3.org/2000/svg",height:"1em",viewBox:"0 0 640 512",...t},(0,e.createElement)("path",{d:"M160 64v64H96V64h64zm-8 112h56V16H48v160h56v56H0v48h296v56h-56v160h160V336h-56v-56h296v-48H536v-56h56V16H432v160h56v56H152v-56zm192 208h8v64h-64v-64h56zM480 64h64v64h-64V64z"}));let R=e=>crypto.getRandomValues(new Uint8Array(e)),L=(e,t=21)=>((e,t,n)=>{let i=(2<<Math.log(e.length-1)/Math.LN2)-1,a=-~(1.6*i*t/e.length);return(r=t)=>{let o="";for(;;){let t=n(a),s=a;for(;s--;)if(o+=e[t[s]&i]||"",o.length===r)return o}}})(e,t,R);const F=wp.compose,V=[],$=[],j=(0,F.createHigherOrderComponent)((t=>n=>((0,w.useEffect)((()=>{if(n.attributes.anchor){const e=$.indexOf(n.clientId);-1!==e&&($.splice(e,1),V.splice(e,1)),$.push(n.clientId),V.push(n.attributes.anchor)}}),[n.clientId,n.attributes?.anchor]),(0,e.createElement)(t,{...n}))),"withTrackedAnchors");(0,l.addFilter)("editor.BlockEdit","wpi/track-anchors",j);const W=e=>{const t=V.indexOf(e);return-1!==t?$[t]:null},q=e=>{const t=(0,y.select)("wpi/interactions").getInteractions();let n=1,i=0,a=e;for(;i<100&&(i++,t.some((t=>t.title===a&&(a=e+` (${++n})`,!0)))););return a},z=()=>{const e=(0,y.select)("core/editor").getCurrentPostType();let t="page"===e?"page":"wp_template"===e?"wp_template":e?"post":null,n=(0,y.select)("core/editor").getCurrentPostId();return t||(t="all",n=""),{param:t,operator:"==",value:n}},H=(e,t={})=>{const n=L("1234567890abcdef",10);return{...(0,f.cloneDeep)(e),key:`interaction_${n(10)}`,title:q(e.title),...t}},U=e=>{const t=L("1234567890abcdef",10);return{...(0,f.cloneDeep)(e),key:`action_${t(10)}`}},Y=e=>`wpi-${e.replace(/^(.*?)\//,"").replace(/[^\d\w]/g,"-").replace(/\-+/g,"-").toLowerCase()}-${L("1234567890abcdef",10)(6)}`,G={},Q=(e,t=!0)=>{if(!e)return"";const{attributes:n,name:i}=(0,y.select)("core/block-editor").getBlock(e);if(n.anchor)return n.anchor;if(G[e]){const n=G[e];return t&&((0,y.dispatch)("core/block-editor").updateBlockAttributes(e,{anchor:n}),(0,y.dispatch)("wpi/interactions").setDidModifyPostContent(!0),delete G[e]),n}const a=Y(i);return t?((0,y.dispatch)("core/block-editor").updateBlockAttributes(e,{anchor:a}),(0,y.dispatch)("wpi/interactions").setDidModifyPostContent(!0)):G[e]=a,((e,t)=>{$.push(e),V.push(t)})(e,a),a},X=(e,t=!0)=>{if(!e)return"";const{attributes:n,name:i}=(0,y.select)("core/block-editor").getBlock(e);if(n.className){const e=n.className?.split(" ")?.[0]||"";if(e)return e}const a=Y(i);return t&&((0,y.dispatch)("core/block-editor").updateBlockAttributes(e,{className:a}),(0,y.dispatch)("wpi/interactions").setDidModifyPostContent(!0)),a},K=()=>(0,y.dispatch)("core/edit-post")?(0,y.dispatch)("core/edit-post").openGeneralSidebar("wpi-editor/sidebar"):(0,y.dispatch)("core/edit-site").openGeneralSidebar("wpi-editor/sidebar");function J(e){"undefined"!=typeof document&&("complete"!==document.readyState&&"interactive"!==document.readyState?document.addEventListener("DOMContentLoaded",e):e())}const Z={interactions:[],loadingError:null,didModifyPostContent:!1},ee={setInteractions:e=>({type:"SET_INTERACTIONS",interactions:e.map((e=>{try{return(e=>{if(!(e.type in _.interactions)){const t=new Error(`Cannot load interaction "${e.title}", missing interaction type "${e.type}"`);throw t.interaction=e,t}const t=L("1234567890abcdef",10),n=_.interactions[e.type||"click"];return{key:`interaction_${t(10)}`,title:(0,c.__)("Interaction","wp-interactions"),active:!0,type:"click",target:{type:"block",value:""},timelines:(0,f.range)(n.timelines.length).map((()=>({loop:!1,onceOnly:!1,alternate:!1,reset:!1,reverse:!1,actions:[]}))),options:{},locations:[[{...z()}]],...e}})(e)}catch(e){return console.error(e),null}})).filter((e=>!!e))}),setLoadingError:e=>({type:"SET_LOADING_ERROR",error:e}),setDidModifyPostContent:e=>({type:"SET_DID_MODIFY_POST_CONTENT",didModifyPostContent:e})};(0,y.register)((0,y.createReduxStore)("wpi/interactions",{reducer:(e=Z,t)=>{switch(t.type){case"SET_INTERACTIONS":return{...e,interactions:t.interactions};case"SET_LOADING_ERROR":return{...e,loadingError:t.error};case"SET_DID_MODIFY_POST_CONTENT":return{...e,didModifyPostContent:t.didModifyPostContent};default:return e}},actions:ee,selectors:{getInteractions:e=>e.interactions,getLoadingError:e=>e.loadingError,didModifyPostContent:e=>e.didModifyPostContent}}));const te=(e,t)=>!!t("core/editor")&&e.locations.some((e=>e.every((e=>{const{param:n,operator:i,value:a}=e;switch(n){case"post":case"page":{if(!a||isNaN(+a)){const e=t("core/editor").getCurrentPostType(),r=a||n;return"=="===i?e===r:e!==r}const e=a.toString()===t("core/editor").getCurrentPostId()?.toString();return"=="===i?e:!e}case"post_type":{const e=a.toString()===t("core/editor").getCurrentPostType()?.toString();return"=="===i?e:!e}case"post_status":case"post_format":case"post_category":case"post_taxonomy":case"all":return!0;case"post_template":case"page_template":{const e=a.toString()===t("core/editor").getCurrentPost()?.template.toString();return"=="===i?e:!e}case"post_parent":case"page_parent":{const e=a.toString()===t("core/editor").getCurrentPost()?.parent.toString();return"=="===i?e:!e}case"wp_template":if("wp_template"===t("core/editor").getCurrentPostType()){const e=a.toString()===t("core/editor").getCurrentPostId()?.toString();return"=="===i?e:!e}break;case"post_archive":return!1}return!1}))));J((()=>{const e=(e,t=[],n="")=>{const i=t.flat().filter((e=>"=="===e.operator)).map((e=>e.value)),a=i.includes("post")?"All posts":i.join(",");console.error("WP Interactions loading error. If you need to contact support, you can copy this entire message and send to support:\n\n",e,"\nPlugin Version:",wpi.pluginVersion,"\nWordPress Version:",wpi.wpVersion,"\n\nPost Content:",n,a?`\n\nYou can remove the interaction that errored by deleting the post with the post ID: ${a}`:"")};b()({path:"/wpi/v1/get_interactions"}).then((e=>{(0,y.dispatch)("wpi/interactions").setInteractions(e)})).catch((t=>{const n=t.interaction?.key,i=t.interaction?.locations,a=t.message;if(t.interactionKey=n,!n)return e(a),void(0,y.dispatch)("wpi/interactions").setLoadingError(t);b()({path:`/wp/v2/wpi-interaction?slug=${n}&context=edit`}).then((t=>{e(a,i,t?.[0]?.content?.raw||"Unavailable")})).catch((()=>{e(a,i)})).finally((()=>{(0,y.dispatch)("wpi/interactions").setLoadingError(t)}))}))}));const ne=()=>{const e=(0,y.useSelect)((e=>{const t=t=>{if("function"==typeof t){const n=e("wpi/interactions").getInteractions();return(0,y.dispatch)("wpi/interactions").setInteractions(t(n))}return(0,y.dispatch)("wpi/interactions").setInteractions(t)},n=e("wpi/interactions").getInteractions(),i=n.filter((t=>te(t,e)));return{interactions:n,interactionsFiltered:i,setInteractions:t,updateInteraction:n=>{if(e("wpi/interactions").didModifyPostContent()&&confirm((0,c.__)("Some block anchors have been updated for your interactions to work correctly. Do you want to save these post changes? (Any modified synced patterns will also be saved)","wp-interactions"))){(0,y.dispatch)("wpi/interactions").setDidModifyPostContent(!1),(0,y.dispatch)("core/editor").savePost();try{e("core").__experimentalGetDirtyEntityRecords().forEach((e=>{const{key:t}=e;(0,y.dispatch)("core").saveEditedEntityRecord("postType","wp_block",t)}))}catch(e){alert((0,c.__)("Error saving synced patterns, please save manually","wp-interactions")),console.error("WP Interactions saving reusable blocks error:",e)}}return b()({path:"/wpi/v1/update_interaction",method:"POST",data:{data:JSON.stringify(n)}}).then((()=>{let i=!1,a=(0,f.cloneDeep)(e("wpi/interactions").getInteractions());a=a.map((e=>e.key===n.key?(i=!0,n):e)),i||a.push(n),t(a)})).catch((e=>{console.error("WP Interactions saving error:",e),alert((0,c.__)("Error saving interaction, got this error:","wp-interactions")+"\n"+e.message+"\n"+e.code)}))},deleteInteraction:n=>b()({path:"/wpi/v1/delete_interaction",method:"POST",data:{key:n}}).then((()=>{const i=e("wpi/interactions").getInteractions().filter((e=>e.key!==n));t(i)})).catch((e=>{console.error("WP Interactions deleting error:",e),alert((0,c.__)("Error deleting interaction, got this error:","wp-interactions")+"\n"+e.message+"\n"+e.code)}))}}),[]);return{loadingError:(0,y.useSelect)((e=>e("wpi/interactions").getLoadingError()),[]),...e}},ie=()=>{const[e,t]=(0,w.useState)(!1);return(0,w.useEffect)((()=>{const e=e=>{t(!!e.shiftKey)};return window?.addEventListener("keydown",e),window?.addEventListener("keyup",e),window?.addEventListener("focus",e),()=>{window?.removeEventListener("keydown",e),window?.removeEventListener("keyup",e),window?.removeEventListener("focus",e)}}),[]),e},ae=()=>{const[e,t]=(0,w.useState)(!1);return(0,w.useEffect)((()=>{const e=e=>{t(!!(/Mac|iPod|iPhone|iPad/i.test(window.navigator?.platform||"")?e.metaKey:e.ctrlKey))};return window?.addEventListener("keydown",e),window?.addEventListener("keyup",e),window?.addEventListener("focus",e),()=>{window?.removeEventListener("keydown",e),window?.removeEventListener("keyup",e),window?.removeEventListener("focus",e)}}),[]),e},re=()=>{},oe="undefined"!=typeof window,se=oe?window:null,le=oe?document:null,ce={replace:0,none:1,blend:2},ue=Symbol(),pe=Symbol(),de=Symbol(),me=Symbol(),he=(Symbol(),Symbol()),ge=1e-11,_e=1e12,fe=1e3,we="",ye=new Map;ye.set("x","translateX"),ye.set("y","translateY"),ye.set("z","translateZ");const ve=["translateX","translateY","translateZ","rotate","rotateX","rotateY","rotateZ","scale","scaleX","scaleY","scaleZ","skew","skewX","skewY","perspective","matrix","matrix3d"],be=ve.reduce(((e,t)=>({...e,[t]:t+"("})),{}),Ee=()=>{},ke=/(^#([\da-f]{3}){1,2}$)|(^#([\da-f]{4}){1,2}$)/i,Se=/rgb\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*\)/i,Ce=/rgba\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*,\s*(-?\d+|-?\d*.\d+)\s*\)/i,Te=/hsl\(\s*(-?\d+|-?\d*.\d+)\s*,\s*(-?\d+|-?\d*.\d+)%\s*,\s*(-?\d+|-?\d*.\d+)%\s*\)/i,xe=/hsla\(\s*(-?\d+|-?\d*.\d+)\s*,\s*(-?\d+|-?\d*.\d+)%\s*,\s*(-?\d+|-?\d*.\d+)%\s*,\s*(-?\d+|-?\d*.\d+)\s*\)/i,Ie=/[-+]?\d*\.?\d+(?:[eE][-+]?\d+)?/g,Ae=/^([-+]?\d*\.?\d+(?:[eE][-+]?\d+)?)+([a-z]+|%)$/i,De=/([a-z])([A-Z])/g,Pe=/(\w+)(\([^)]+\)+)/g,Ne=/(\*=|\+=|-=)/,Me={id:null,keyframes:null,playbackEase:null,playbackRate:1,frameRate:120,loop:0,reversed:!1,alternate:!1,autoplay:!0,duration:fe,delay:0,loopDelay:0,ease:"outQuad",composition:ce.replace,modifier:e=>e,onBegin:Ee,onUpdate:Ee,onTick:Ee,onRender:Ee,onLoop:Ee,onComplete:Ee},Oe=(e,t)=>0===e.indexOf(t),Be=Date.now,Re=e=>Array.isArray(e),Le=e=>e&&e.constructor===Object,Fe=e=>"number"==typeof e&&!isNaN(e),Ve=e=>"string"==typeof e,$e=e=>"function"==typeof e,je=e=>void 0===e,We=e=>je(e)||null===e,qe=e=>oe&&e instanceof SVGElement,ze=e=>ke.test(e),He=e=>Oe(e,"rgb"),Ue=e=>Oe(e,"hsl"),Ye=e=>!Me.hasOwnProperty(e),Ge=e=>Ve(e)?parseFloat(e):e,Qe=Math.pow,Xe=Math.sqrt,Ke=Math.sin,Je=Math.cos,Ze=Math.abs,et=(Math.exp,Math.ceil),tt=Math.floor,nt=Math.asin,it=Math.max,at=(Math.atan2,Math.PI),rt=(e,t,n)=>e<t?t:e>n?n:e,ot=(e,t)=>{const n=10**(t||0);return Math.round(e*n)/n},st=(e,t,n)=>e+(t-e)*n,lt=e=>e===1/0?_e:e===-1/0?-_e:e,ct=e=>e<ge?ge:e,ut=e=>oe?(Ve(e)&&(e=(e=>{try{return le.querySelectorAll(e)}catch(e){}})(e)||e),e instanceof NodeList||e instanceof HTMLCollection?[].slice.call(e):[e]):[e],pt=e=>Re(e)?[...e]:e,dt=(e,t)=>{const n={...e};for(const i in t)n[i]=je(e[i])?t[i]:e[i];return n},mt=(e,t,n,i="_prev",a="_next")=>{let r=e._head,o=a;for(n&&(r=e._tail,o=i);r;){const e=r[o];t(r),r=e}},ht=(e,t,n="_prev",i="_next")=>{const a=t[n],r=t[i];a?a[i]=r:e._head=r,r?r[n]=a:e._tail=a,t[n]=null,t[i]=null},gt=(e,t,n,i="_prev",a="_next")=>{let r=e._tail;for(;r&&n&&n(r,t);)r=r[i];const o=r?r[a]:e._head;r?r[a]=t:e._head=t,o?o[i]=t:e._tail=t,t[i]=r,t[a]=o};class _t{constructor(){this.currentTime=0,this.deltaTime=0,this._elapsedTime=0,this._startTime=0,this._lastTime=0,this._scheduledTime=0,this._frameDuration=fe/120,this._fps=120,this._speed=1,this._hasChildren=!1}get frameRate(){return this._fps}set frameRate(e){const t=this._frameDuration,n=+e,i=n<ge?ge:n,a=fe/i;this._fps=i,this._frameDuration=a,this._scheduledTime+=a-t}get playbackRate(){return this._speed}set playbackRate(e){const t=+e;this._speed=t<ge?ge:t}requestTick(e){const t=this._scheduledTime,n=this._elapsedTime;if(this._elapsedTime+=e-n,n<t)return 0;const i=this._frameDuration,a=n-t;return this._scheduledTime+=a<i?i:a,1}computeDeltaTime(e){const t=e-this._lastTime;return this.deltaTime=t,this._lastTime=e,t}}const ft=(e,t,n,i,a)=>{const r=e.duration,o=e.currentTime,s=e._currentIteration,l=e._iterationDuration,c=e._iterationCount,u=e._loopDelay,p=e._reversed,d=e._alternate,m=e._hasChildren,h=e._delay,g=h+l,_=rt(t-h,-h,r),f=_-o,w=_>=r,y=2===a,v=1===a,b=y||(f<0?-1*f:f)>=200;let E=e.began,k=0,S=_;if(c>1){const t=~~(_/(l+(w?0:u)));e._currentIteration=rt(t,0,c),w&&e._currentIteration--,k=e._currentIteration%2,S=_%(l+u)}const C=p^(d&&k),T=e._ease;let x=w?C?0:r:C?l-S:S;T&&(x=l*T(x/l)||0);const I=x<e._iterationTime,A=b?I?2:1:0;e._iterationTime=x,e._backwards=I&&!C,!n&&!E&&_>0&&(E=e.began=!0,e.onBegin(e)),e.currentTime=_;let D=0;if(E&&e._currentIteration!==s&&(e.onLoop(e),m&&mt(e,(e=>e.reset()),!0)),(y||v&&(t>=h&&t<=g||t<=h&&o>0||t>=g&&o!==r)||x>=g&&o!==r||x<=h&&o>0||t<=o&&o===r&&e.completed)&&(E&&(e.computeDeltaTime(o),e.onUpdate(e)),!m)){let t,n,a,r,o=e._head,s=0;const l=e._offset+h+x;for(;o;){const e=o._composition,c=o._currentTime,u=o._changeDuration,p=o._absoluteStartTime+o._changeDuration,d=o._nextRep,m=o._prevRep,h=e===ce.blend,g=e===ce.none;if((A||(c!==u||l<=p+(d?d._delay:0))&&(0!==c||l>=o._absoluteStartTime))&&(g||!o._isOverridden&&(!o._isOverlapped||l<=p)&&(!d||d._isOverridden||l<=d._absoluteStartTime)&&(!m||m._isOverridden||l>=m._absoluteStartTime+m._changeDuration+o._delay))){const e=o._currentTime=rt(x-o._startTime,0,u),l=o._ease(e/o._updateDuration),c=o._modifier,p=o._valueType;let d,m;if(0===p)d=m=c(st(o._fromNumber,o._toNumber,l));else if(1===p)m=c(ot(st(o._fromNumber,o._toNumber,l),3)),d=`${m}${o._unit}`;else if(2===p){const e=o._fromNumbers,t=o._toNumbers;try{const n=ot(rt(c(st(e[0],t[0],l)),0,255),0),i=ot(rt(c(st(e[1],t[1],l)),0,255),0);d=`rgba(${n},${i},${ot(rt(c(st(e[2],t[2],l)),0,255),0)},${rt(c(st(e[3],t[3],l)),0,1)})`}catch(e){console.error(e)}}else if(3===p){d=o._strings[0];for(let e=0,t=o._toNumbers.length;e<t;e++){const t=c(ot(st(o._fromNumbers[e],o._toNumbers[e],l),5)),n=o._strings[e+1];d+=`${n?t+n:t}`,h&&(o._numbers[e]=t)}}if(g||(o._number=m),i||h)o._value=d;else{const e=o.property,i=o._tweenType;t=o.target,1===i?"currentTime"===e&&t.seeking||(t[e]=d):2===i?t.setAttribute(e,d):(n=t.style,4===i?(t!==a&&(a=t,r=t[me]),r[e]=d,s=1):3===i?n.setProperty(e,d,"important"):5===i&&n.setProperty(e,d)),E&&(D=1)}}if(s&&o._renderTransforms){let e=we;"perspective"in r&&(e=`perspective(${r.perspective}) ${e}`,delete r.perspective);for(const t in r)e+=`${be[t]}${r[t]}) `;n.setProperty("transform",e,"important"),s=0}o=o._next}D&&e.onRender(e)}return E&&w&&(c===1/0?e._startTime+=e.duration:e._currentIteration>=c-1&&(e.paused=!0,e.completed||(e.completed=!0,e.onComplete(e),e._resolve(e)))),D},wt=(e,t,n,i,a)=>{if(ft(e,t,n,i,a),e._hasChildren){let r=0;const o=i?t:e._iterationTime,s=Be();mt(e,(t=>{r+=ft(t,(o-t._offset)*t._speed,n,i,t._fps<e._fps?t.requestTick(s):a)}),e._backwards),e.began&&r&&e.onRender(e)}},yt={animation:null,update:Ee},vt=oe?requestAnimationFrame:setImmediate,bt=oe?cancelAnimationFrame:clearImmediate,Et=new class extends _t{constructor(){super();const e=Be();this.currentTime=e,this._elapsedTime=e,this._startTime=e,this._lastTime=e,this.useDefaultMainLoop=!0,this.suspendWhenHidden=!0,this._reqId=0,this._head=null,this._tail=null}update(){const e=this.currentTime=Be();if(this.requestTick(e)){this.computeDeltaTime(e);const t=this._speed,n=this._fps;let i=this._head;for(;i;){const a=i._next;i.paused?(ht(Et,i),this._hasChildren=!!this._tail,i._running=!1,i.completed&&!i._cancelled&&i.cancel()):wt(i,(e-i._startTime)*i._speed*t,0,0,i._fps<n?i.requestTick(e):1),i=a}yt.update()}}start(){return this.useDefaultMainLoop&&!this._reqId?this._reqId=vt(kt):0}resume(){return mt(this,(e=>e.resetTime())),this.start()}suspend(){return this._reqId=bt(this._reqId),this}get playbackRate(){return super.playbackRate}set playbackRate(e){super.playbackRate=e,mt(this,(e=>e.playbackRate=e._speed))}},kt=()=>{Et._head?(Et._reqId=vt(kt),Et.update()):Et._reqId=0},St=e=>{if(!We(e)){if(Re(e)){const t=[].concat(...e.map(ut));return t.filter(((e,n)=>t.indexOf(e)===n))}return ut(e)}},Ct=e=>{if(We(e))return;const t=St(e);for(let e=0,n=t.length;e<n;e++){const n=t[e];if(!n[ue]){n[ue]=!0;const e=qe(n);(n.nodeType||e)&&(n[pe]=!0,n[de]=e,n[me]={})}}return t},Tt=e=>e,xt=(e,t,n)=>(((1-3*n+3*t)*e+(3*n-6*t))*e+3*t)*e,It=at/2,At=2*at,Dt=(e=1.64)=>t=>Qe(t,+e),Pt={[we]:Dt,Quad:Dt(2),Cubic:Dt(3),Quart:Dt(4),Quint:Dt(5),Sine:e=>1-Je(e*It),Circ:e=>1-Xe(1-e*e),Expo:e=>e?Qe(2,10*e-10):0,Bounce:e=>{let t,n=4;for(;e<((t=Qe(2,--n))-1)/11;);return 1/Qe(4,3-n)-7.5625*Qe((3*t-2)/22-e,2)},Back:(e=1.70158)=>t=>(+e+1)*t*t*t-+e*t*t,Elastic:(e=1,t=.3)=>{const n=rt(+e,1,10),i=rt(+t,ge,2),a=i/At*nt(1/n),r=At/i;return e=>0===e||1===e?e:-n*Qe(2,-10*(1-e))*Ke((1-e-a)*r)}},Nt={in:e=>t=>e(t),out:e=>t=>1-e(1-t),inOut:e=>t=>t<.5?e(2*t)/2:1-e(-2*t+2)/2,outIn:e=>t=>t<.5?(1-e(1-2*t))/2:(e(2*t-1)+1)/2},Mt=(...e)=>{const t=e.length;if(!t)return Tt;const n=t-1,i=e[0],a=e[n],r=[0],o=[Ge(i)];for(let t=1;t<n;t++){const i=e[t],a=Ve(i)?i.trim().split(" "):[i],s=a[0],l=a[1];r.push(je(l)?t/n:Ge(l)/100),o.push(Ge(s))}return o.push(Ge(a)),r.push(1),function(e){for(let t=1,n=r.length;t<n;t++){const n=r[t];if(e<=n){const i=r[t-1],a=o[t-1];return a+(o[t]-a)*(e-i)/(n-i)}}return o[o.length-1]}},Ot={linear:Mt,irregular:(e=10,t=1)=>{const n=[0],i=e-1;for(let e=1;e<i;e++){const a=n[e-1],r=e/i,o=r*(1-t)+(r+((e+1)/i-r)*Math.random())*t;n.push(rt(o,a,1))}return n.push(1),Mt(...n)},steps:(e=10,t)=>{const n=t?et:tt;return t=>n(rt(t,0,1)*e)*(1/e)},cubicBezier:(e,t,n,i)=>e===t&&n===i?Tt:a=>0===a||1===a?a:xt(((e,t,n)=>{let i,a,r=0,o=1,s=0;do{i=r+(o-r)/2,a=xt(i,t,n)-e,a>0?o=i:r=i}while(Ze(a)>1e-7&&++s<100);return i})(a,e,n),t,i)},Bt={linear:Tt};for(const e in Nt)for(const t in Pt){const n=Pt[t],i=Nt[e],a=t===we||"Back"===t||"Elastic"===t,r=a?(e,t)=>i(n(e,t)):i(n),o=e+t;Ot[o]=r,Bt[o]=a?r():r}const Rt=e=>$e(e)?e:Ve(e)?Bt[e]?Bt[e]:(e=>{if(e.indexOf("(")<=-1)return Tt;const t=e.slice(0,-1).split("("),n=Ot[t[0]];return n?Bt[e]=n(...t[1].split(",")):Tt})(e):Tt,Lt=["opacity","rotate","overflow","color"],Ft=(e,t,n)=>(n<0&&(n+=1),n>1&&(n-=1),n<1/6?e+6*(t-e)*n:n<.5?t:n<2/3?e+(t-e)*(2/3-n)*6:e),Vt=(e,t)=>je(e)?t:e,$t=(e,t,n,i,a)=>{if($e(e)){const r=()=>{const a=e(t,n,i);return isNaN(+a)?a||0:+a};return a&&(a.func=r),r()}return e},jt=(e,t)=>{const n=e[pe]?e[de]&&((e,t)=>{if(Lt.includes(t))return!1;if(t in e.style||t in e){if("scale"===t){const t=e.parentNode;return t&&"filter"===t.tagName}return!0}})(e,t)?2:ve.includes(t)||ye.get(t)?4:Oe(t,"--")?5:t in e.style?3:We(e.getAttribute(t))?je(e[t])?0:1:2:1;return 0===n&&console.warn(`Can't find property '${t}' on target '${e}'.`),n},Wt=(e,t,n)=>{const i=e.style[t];i&&n&&(n[t]=i);const a=i||getComputedStyle(e[he]||e).getPropertyValue(t);return"auto"===a?"0":a},qt=(e,t,n,i)=>{const a=je(n)?jt(e,t):n;return 1===a?e[t]||0:2===a?e.getAttribute(t):4===a?((e,t,n)=>{const i=e.style.transform;let a;if(i){const r=e[me];let o;for(;o=Pe.exec(i);){const e=o[1],i=o[2].slice(1,-1);r[e]=i,e===t&&(a=i,n&&(n[t]=i))}}return i&&!je(a)?a:Oe(t,"scale")?"1":Oe(t,"rotate")||Oe(t,"skew")?"0deg":"0px"})(e,t,i):5===a?Wt(e,t,i).trimStart():Wt(e,t,i)},zt=(e,t,n)=>"-"===n?e-t:"+"===n?e+t:e*t,Ht=(e,t)=>{if(t.t=0,t.n=0,t.u=null,t.o=null,t.d=null,t.s=null,!e)return t;let n=e;const i=+n;if(!isNaN(i))return t.n=i,t;const a=Ne.exec(n);a&&(n=n.slice(2),t.o=a[0][0]);const r=!n.includes(" ")&&Ae.exec(n);if(r)return t.t=1,t.n=+r[1],t.u=r[2],t;if(t.o)return t.n=+n,t;if(ze(s=n)||He(s)||Ue(s))return t.t=2,t.d=He(o=n)?(e=>{const t=Se.exec(e)||Ce.exec(e),n=je(t[4])?1:+t[4];return[+t[1],+t[2],+t[3],n]})(o):ze(o)?(e=>{const t=e.length,n=4===t||5===t;return[+("0x"+e[1]+e[n?1:2]),+("0x"+e[n?2:3]+e[n?2:4]),+("0x"+e[n?3:5]+e[n?3:6]),5===t||9===t?+(+("0x"+e[n?4:7]+e[n?4:8])/255).toFixed(3):1]})(o):Ue(o)?(e=>{const t=Te.exec(e)||xe.exec(e),n=+t[1]/360,i=+t[2]/100,a=+t[3]/100,r=je(t[4])?1:+t[4];let o,s,l;if(0===i)l=s=o=a;else{const e=a<.5?a*(1+i):a+i-a*i,t=2*a-e;l=ot(255*Ft(t,e,n+1/3),0),s=ot(255*Ft(t,e,n),0),o=ot(255*Ft(t,e,n-1/3),0)}return[l,s,o,r]})(o):[0,0,0,1],t;var o,s;const l=n+we,c=l.match(Ie);return t.t=3,t.d=c?c.map(Number):[],t.s=l.split(Ie)||[],t},Ut=(e,t)=>(t.t=e._valueType,t.n=e._toNumber,t.u=e._unit,t.o=null,t.d=pt(e._toNumbers),t.s=pt(e._strings),t),Yt={t:0,n:0,u:null,o:null,d:null,s:null},Gt={},Qt=(e,t,n)=>{if(4===n){return ye.get(e)||e}if(3===n||2===n&&qe(t)&&e in t.style){const t=Gt[e];if(t)return t;const n=e.replace(De,"$1-$2").toLowerCase();return Gt[e]=n,n}return e},Xt={deg:1,rad:180/at,turn:360},Kt=e=>(e.offsetWidth||0)/100,Jt={},Zt=(e,t,n)=>{const i=t.u,a=t.n;if(1===t.t&&i===n)return t;const r=a+i+n,o=Jt[r];if(je(o)){let o;if(i in Xt)o=a*Xt[i]/Xt[n];else{const t=100,r=le.createElement(e.tagName),s=r.style,l=e.parentNode,c=l&&l!==le?l:le.body;c.appendChild(r),s.position="absolute",s.width=t+i;const u=Kt(r);s.width=t+n;const p=u/Kt(r);c.removeChild(r),o=p*a}t.n=o,Jt[r]=o}else t.n=o;return t.t,t.u=n,t},en={_rep:new WeakMap,_add:new Map},tn=(e,t,n="_rep")=>{const i=en[n];let a=i.get(e);return a||(a={},i.set(e,a)),a[t]?a[t]:a[t]={_head:null,_tail:null}},nn=(e,t)=>e._isOverridden||e._absoluteStartTime>t._absoluteStartTime,an=e=>{e._isOverlapped=1,e._isOverridden=1,e._changeDuration=ge,e._currentTime=ge},rn=(e,t)=>{const n=e._composition;if(n===ce.replace){const n=e._absoluteStartTime;gt(t,e,nn,"_prevRep","_nextRep");const i=e._prevRep;if(i){const t=i.parent,a=i._absoluteStartTime+i._changeDuration;if(e.parent.id!==t.id&&t._iterationCount>1&&a+(t.duration-t._iterationDuration)>n){an(i);let e=i._prevRep;for(;e&&e.parent.id===t.id;)an(e),e=e._prevRep}const r=n-e._delay;if(a>r){const e=i._startTime,t=a-(e+i._updateDuration);i._changeDuration=r-t-e,i._currentTime=i._changeDuration,i._isOverlapped=1,i._changeDuration<ge&&an(i)}let o=0;mt(t,(e=>{o-=e._isOverridden-1})),0===o&&(t.completed=!0,t.pause())}}else if(n===ce.blend){const t=tn(e.target,e.property,"_add"),n=(e=>{let t=yt.animation;return t||(t={duration:ge,_offset:0,_delay:0,_head:null,_tail:null},yt.animation=t,yt.update=()=>{e.forEach((e=>{for(const t in e){const n=e[t],i=n._head,a=3===i._valueType?pt(i._fromNumbers):null;let r=i._fromNumber,o=n._tail;for(;o&&o!==i;)a?o._numbers.forEach(((e,t)=>a[t]+=e)):r+=o._number,o=o._prevAdd;i._toNumber=r,i._toNumbers=a}})),wt(t,1,1,0,2)}),t})(en._add);let i=t._head;i||(i={...e},i._composition=ce.replace,i._updateDuration=ge,i._startTime=0,i._numbers=pt(e._fromNumbers),i._number=0,i._next=null,i._prev=null,gt(t,i),gt(n,i));const a=e._toNumber;if(e._fromNumber=i._fromNumber-a,e._toNumber=0,e._numbers=pt(e._fromNumbers),e._number=0,i._fromNumber=a,e._toNumbers){const t=pt(e._toNumbers);t&&t.forEach(((t,n)=>{e._fromNumbers[n]=i._fromNumbers[n]-t,e._toNumbers[n]=0})),i._fromNumbers=t}gt(t,e,null,"_prevAdd","_nextAdd")}return e},on=e=>{const t=e._composition;if(t!==ce.none){const n=e.target,i=e.property,a=tn(n,i);if(ht(a,e,"_prevRep","_nextRep"),t===ce.blend){const t=tn(n,i,"_add");ht(t,e,"_prevAdd","_nextAdd")}}return e},sn=e=>(e.paused=!0,e.began=!1,e.completed=!1,e),ln=e=>e._cancelled?(e._hasChildren?mt(e,ln):mt(e,(e=>{e._composition!==ce.none&&rn(e,tn(e.target,e.property))})),e._cancelled=0,e):e;let cn=0;class un extends _t{constructor(e={},t=null,n=0){super();const{id:i,delay:a,duration:r,reversed:o,alternate:s,loop:l,loopDelay:c,autoplay:u,frameRate:p,playbackRate:d,onComplete:m,onLoop:h,onBegin:g,onUpdate:_}=e,f=t?0:Et._elapsedTime,w=t?t.defaults:Me,y=$e(a)||je(a)?w.delay:+a,v=$e(r)||je(r)?1/0:+r,b=Vt(l,w.loop),E=Vt(c,w.loopDelay),k=!0===b||b===1/0||b<0?1/0:b+1;this.id=je(i)?r===ge?0:++cn:i,this.duration=lt((v+E)*k-E),this.paused=!0,this.began=!1,this.completed=!1,this.onBegin=g||w.onBegin,this.onUpdate=_||w.onUpdate,this.onLoop=h||w.onLoop,this.onComplete=m||w.onComplete,this._autoplay=!t&&Vt(u,w.autoplay),this._offset=t?n:Et._elapsedTime-Et._startTime,this._delay=y,this._loopDelay=E,this._iterationTime=0,this._iterationDuration=v,this._iterationCount=k,this._currentIteration=0,this._resolve=Ee,this._hasChildren=!1,this._running=!1,this._cancelled=0,this._reversed=+Vt(o,w.reversed),this._alternate=Vt(s,w.alternate),this._backwards=!1,this._prev=null,this._next=null,this._elapsedTime=f,this._startTime=f,this._lastTime=f,this._fps=Vt(p,w.frameRate),this._speed=Vt(d,w.playbackRate)}reset(e=0){return ln(this),this._iterationTime=this._iterationDuration,wt(this,0,1,e,2),sn(this),this._hasChildren&&mt(this,sn),this}init(e=0){return this.frameRate=this._fps,this.playbackRate=this._speed,!e&&this._hasChildren&&wt(this,this.duration,1,e,2),this.reset(e),this._autoplay&&this.play(),this}resetTime(){const e=1/(this._speed*Et._speed);return this._startTime=Be()-(this.currentTime+this._delay)*e-12,this}pause(){return this.paused||(this.paused=!0),this}play(){return this.paused?((this.completed||this._cancelled)&&this.reset(0),this.paused=!1,this.duration<=ge?wt(this,1,0,0,2):(this._running||(gt(Et,this),Et._hasChildren=!0,this._running=!0),this.resetTime(),Et.start()),this):this}restart(){return this.reset(0).play()}seek(e,t){ln(this),this.completed=!1;const n=this.paused;return this.paused=!0,wt(this,e+this._delay,~~t,0,1),n?this:this.play()}reverse(){const e=this._reversed;return this._reversed=+(!this._alternate||this._iterationCount%2?!e:e),this.seek(this.duration-this.currentTime),this.resetTime(),this}cancel(){return this._hasChildren?mt(this,(e=>e.cancel()),!0):mt(this,on),this._cancelled=1,this.pause()}stretch(e){const t=this.duration;if(t===e)return this;const n=e/t;return this.duration=ct(lt(t*n)),this._iterationDuration=ct(lt(this._iterationDuration*n)),this._offset*=n,this._delay*=n,this._loopDelay*=n,this}then(e=Ee){const t=()=>{this.then=null,e(this)};return new Promise((e=>this.completed?e(t()):this._resolve=()=>e(t())))}get progress(){return ot(this.currentTime/this.duration,3)}set progress(e){const t=this.paused;this.pause().seek(this.duration*+e),t||this.play()}get playbackRate(){return super.playbackRate}set playbackRate(e){super.playbackRate=e,this.resetTime()}}const pn=e=>{if(e._hasChildren)mt(e,pn,!0);else{const t=e;t.pause(),mt(t,(e=>{const n=e.property,i=e.target;if(i[pe]){const a=i.style,r=t._inlineStyles[n];if(4===e._tweenType){const t=i[me];if(je(r)||r===we?delete t[n]:t[n]=r,e._renderTransforms)if(Object.keys(t).length){let e=we;for(const n in t)e+=be[n]+t[n]+") ";a.transform=e}else a.removeProperty("transform")}else je(r)||r===we?a.removeProperty(n):a[n]=r;t._tail===e&&t.targets.forEach((e=>{e.getAttribute("style")===we&&e.removeAttribute("style")}))}}))}return e},dn={t:0,n:0,u:null,o:null,d:null,s:null},mn={t:0,n:0,u:null,o:null,d:null,s:null},hn={func:null},gn=[null],_n=[null,null],fn={to:null};let wn,yn,vn=0;class bn extends un{constructor(e,t,n,i,a=!1,r=0,o=0){super(t,n,i),this._head=null,this._tail=null;const s=Ct(e),l=s.length,c=t.keyframes,u=c?dt(((e,t)=>{const n={};if(Re(e)){const t=[].concat(...e.map((e=>Object.keys(e)))).filter(Ye);for(let i=0,a=t.length;i<a;i++){const a=t[i],r=e.map((e=>{const t={};for(const n in e){const i=e[n];Ye(n)?n===a&&(t.to=i):t[n]=i}return t}));n[a]=r}}else{const i=Vt(t.duration,Me.duration),a=Object.keys(e).map((t=>({o:parseFloat(t)/100,p:e[t]}))).sort(((e,t)=>e.o-t.o));a.forEach((e=>{const t=e.o,a=e.p;for(const e in a)if(Ye(e)){let r=n[e];r||(r=n[e]=[]);const o=t*i,s=r.length,l=r[s-1],c={to:a[e]};let u=0;for(let e=0;e<s;e++)u+=r[e].duration;1===s&&(c.from=l.to),a.ease&&(c.ease=a.ease),c.duration=o-(s?u:0),r.push(c)}return e}));for(const e in n){const t=n[e];let i;for(let e=0,n=t.length;e<n;e++){const n=t[e],a=n.ease;i&&(n.ease=i),i=a}t[0].duration||t.shift()}}return n})(c,t),t):t,{delay:p,duration:d,ease:m,playbackEase:h,modifier:g,composition:_,onRender:f}=u,w=n?n.defaults:Me,y=Vt(h,w.playbackEase),v=y?Rt(y):null,b=!je(m)&&Le(m),E=b?m.solver:Vt(m,v?"linear":w.ease),k=b?m.duration:Vt(d,w.duration),S=Vt(p,w.delay),C=g||w.modifier,T=je(_)&&l>=fe?ce.none:je(_)?Fe(w.composition)?w.composition:ce[w.composition]:Fe(_)?_:ce[_],x={},I=this._offset;let A=NaN,D=NaN,P=0;for(let e=0;e<l;e++){const t=s[e],i=r||e,c=o||l;let p=NaN,d=NaN;for(const e in u)if(Ye(e)){const r=jt(t,e);if(0!==r){const o=Qt(e,t,r);let s=u[e];if(a&&(_n[0]=s,_n[1]=s,s=_n),Re(s)){const e=s.length,t=!Le(s[0]);2===e&&t?(fn.to=s,gn[0]=fn,wn=gn):e>2&&t?(wn=[],s.forEach(((e,t)=>{t?1===t?(_n[1]=e,wn.push(_n)):wn.push(e):_n[0]=e}))):wn=s}else gn[0]=s,wn=gn;let l=null,m=null,h=NaN,g=0,_=0;for(let e=wn.length;_<e;_++){const a=wn[_];Le(a)?yn=a:(fn.to=a,yn=fn),hn.func=null;const s=$t(yn.to,t,i,c,hn);let u;Le(s)&&!je(s.to)?(yn=s,u=s.to):u=s;const p=$t(yn.from,t,i,c),d=yn.ease,f=!je(d)&&Le(d),w=f?d.solver:d||E,y=f?d.duration:$t(Vt(yn.duration,e>1?$t(k,t,i,c)/e:k),t,i,c),v=$t(Vt(yn.delay,_?0:S),t,i,c),b=$t(Vt(yn.composition,T),t,i,c),A=yn.modifier||C,D=Re(u),N=D||!je(p)&&!je(u),M=m?g+v:v,O=I+M;let B=m;if(b!==ce.none){l||(l=tn(t,o));let e=l._head;for(;e&&!e._isOverridden&&e._absoluteStartTime<=O;)if(B=e,e=e._nextRep,e&&e._absoluteStartTime>=O)for(;e;)an(e),e=e._nextRep}if(N?(Ht(D?$t(u[0],t,i,c):p,dn),Ht(D?$t(u[1],t,i,c,hn):u,mn),0===dn.t&&(B?1===B._valueType&&(dn.t=1,dn.u=B._unit):(Ht(qt(t,o,r,x),Yt),1===Yt.t&&(dn.t=1,dn.u=Yt.u)))):(je(u)?m?Ut(m,mn):Ht(n&&B?B._value:qt(t,o,r,x),mn):Ht(u,mn),je(p)?m?Ut(m,dn):Ht(n&&B?B._value:qt(t,o,r,x),dn):Ht(p,dn)),dn.o&&(dn.n=zt(B?B._toNumber:Ht(qt(t,o,r,x),Yt).n,dn.n,dn.o)),mn.o&&(mn.n=zt(dn.n,mn.n,mn.o)),dn.t!==mn.t)if(3===dn.t||3===mn.t){const e=3===dn.t?dn:mn,t=3===dn.t?mn:dn;t.t=3,t.s=pt(e.s),t.d=e.d.map((()=>t.n))}else if(1===dn.t||1===mn.t){const e=1===dn.t?dn:mn,t=1===dn.t?mn:dn;t.t=1,t.u=e.u}else if(2===dn.t||2===mn.t){const e=2===dn.t?dn:mn,t=2===dn.t?mn:dn;t.t=2,t.s=e.s,t.d=[0,0,0,1]}if(dn.u!==mn.u){let e=mn.u?dn:mn;e=Zt(t,e,mn.u?mn.u:dn.u)}if(mn.d&&dn.d&&mn.d.length!==dn.d.length){const e=dn.d.length>mn.d.length?dn:mn,t=e===dn?mn:dn;t.d=e.d.map(((e,n)=>je(t.d[n])?0:t.d[n])),t.s=pt(e.s)}const R=+y||ge,L={parent:this,id:vn++,property:o,target:t,_value:null,_func:hn.func,_ease:Rt(w),_fromNumbers:pt(dn.d),_toNumbers:pt(mn.d),_strings:pt(mn.s),_fromNumber:dn.n,_toNumber:mn.n,_numbers:null,_number:0,_unit:mn.u,_modifier:A,_currentTime:0,_startTime:M,_delay:+v,_updateDuration:R,_changeDuration:R,_absoluteStartTime:O,_tweenType:r,_valueType:mn.t,_composition:b,_isOverlapped:0,_isOverridden:0,_renderTransforms:0,_prevRep:null,_nextRep:null,_prevAdd:null,_nextAdd:null,_prev:null,_next:null};b!==ce.none&&rn(L,l),isNaN(h)&&(h=L._startTime),g=M+R,m=L,P++,gt(this,L)}(isNaN(D)||h<D)&&(D=h),(isNaN(A)||g>A)&&(A=g),4===r&&(p=P-_,d=P)}}if(!isNaN(p)){let e=0;mt(this,(t=>{e>=p&&e<d&&(t._renderTransforms=1,t._composition===ce.blend&&mt(yt.animation,(e=>{e.id===t.id&&(e._renderTransforms=1)}))),e++}))}}l||console.warn("No target found. Make sure the element you're trying to animate is accessible before creating your animation."),D?(mt(this,(e=>{e._startTime-e._delay||(e._delay-=D),e._startTime-=D})),A-=D):D=0,A||(A=ge,this._iterationCount=0),this.targets=s,this.duration=lt((A+this._loopDelay)*this._iterationCount-this._loopDelay)||ge,this.onRender=f||w.onRender,this._ease=v,this._delay=D,this._iterationDuration=A,this._inlineStyles=x}stretch(e){const t=this.duration;if(t===e)return this;const n=e/t;return mt(this,(e=>{e._updateDuration=ct(e._updateDuration*n),e._changeDuration=ct(e._changeDuration*n),e._currentTime*=n,e._startTime*=n,e._absoluteStartTime*=n})),super.stretch(e)}refresh(){return mt(this,(e=>{const t=qt(e.target,e.property,e._tweenType);Ht(t,Yt),e._fromNumbers=pt(Yt.d),e._fromNumber=Yt.n,e._func&&(Ht(e._func(),mn),e._toNumbers=pt(mn.d),e._toNumber=mn.n)})),this}revert(){return wt(this,0,1,0,2),pn(this),this.cancel()}then(e){return super.then(e)}}const En=(e,t)=>{let n=e._iterationDuration;if(n===ge&&(n=0),je(t))return n;if(Fe(+t))return+t;const i=t,a=e?e.labels:null,r=!We(a),o=((e,t)=>{if(Oe(t,"<")){const n="<"===t[1],i=e._tail,a=i?i._offset+i._delay:0;return n?a:a+i.duration}})(e,i),s=!je(o),l=Ne.exec(i);if(l){const e=l[0],t=i.split(e),c=r&&t[0]?a[t[0]]:n,u=s?o:r?c:n,p=+t[1];return zt(u,p,e[0])}return s?o:r?je(a[i])?n:a[i]:n};function kn(e,t,n,i,a,r){const o=Fe(e.duration)&&e.duration<=ge?n-ge:n;wt(t,o,1,1,1);const s=i?new bn(i,e,t,o,!1,a,r):new un(e,t,o);return s.init(1),gt(t,s),mt(t,(e=>{const n=e._offset+e._delay+e.duration;n>t._iterationDuration&&(t._iterationDuration=n)})),t.duration=lt((t._iterationDuration+t._loopDelay)*t._iterationCount-t._loopDelay),t}class Sn extends un{constructor(e={}){super(e,null,0),this.duration=0,this.labels={};const t=e.defaults;this.defaults=e&&t?dt(t,Me):Me,this.onRender=e.onRender||Me.onRender;const n=Vt(e.playbackEase,Me.playbackEase);this._ease=n?Rt(n):null,this._iterationDuration=0,this._head=null,this._tail=null}add(e,t,n){const i=Le(t),a=Le(e),r=$e(e);if(i||a||r){if(this._hasChildren=!0,i){const i=t;if($e(n)){const t=n,a=St(e),r=this.duration,o=this._iterationDuration,s=i.id;let l=0;const c=a.length;a.forEach((e=>{const n={...i};this.duration=r,this._iterationDuration=o,je(s)||(n.id=s+"-"+l),kn(n,this,t(e,l,c,this),e,l,c),l++}))}else kn(i,this,En(this,n),e)}else kn(a?e:{onComplete:e,duration:ge},this,En(this,t));return this.init(1),this._autoplay?this.play():this}if(Ve(e))return this.labels[e]=En(this,t),this}set(e,t,n){return je(t)?this:(t.duration=ge,t.composition=ce.replace,this.add(e,t,n))}stretch(e){const t=this.duration;if(t===e)return this;const n=e/t,i=this.labels;mt(this,(e=>{e.stretch(e.duration*n)}));for(const e in i)i[e]*=n;return super.stretch(e)}refresh(){return mt(this,(e=>{e.refresh()})),this}revert(){return wt(this,0,1,0,2),pn(this),mt(this,(e=>e.revert),!0),this.cancel()}then(e){return super.then(e)}}const Cn=(e,t)=>{let n=!1;return mt(t,(i=>{e.includes(i.target)&&(ht(t,i),n=!0)}),!0),n},Tn=(e,t)=>{const n=St(e),i=t||Et;let a;if(i._hasChildren?mt(i,(t=>{t._hasChildren||(a=Cn(n,t),a&&!t._head&&ht(i,t)),t._head?Tn(e,t):t._hasChildren=!1}),!0):a=Cn(n,i),a&&!i._head){i._hasChildren=!1;const e=i;e.pause&&e.pause()}return n},xn=(e,t,n)=>{const i=10**(n||0);return tt((Math.random()*(t-e+1/i)+e)*i)/i},In=e=>(...t)=>{const n=e(...t);return new Proxy(Ee,{apply:(e,t,[i])=>n(i),get:(e,t)=>In(((...e)=>{const i=Dn[t](...e);return e=>i(n(e))}))})},An=(e,t=0)=>(...n)=>(n.length<e.length?In(((e,t=0)=>(...n)=>t?t=>e(...n,t):t=>e(t,...n))(e,t)):e)(...n),Dn={$:Ct,get:function(e,t,n){const i=Ct(e);if(!(We(i)||Re(i)&&!i.length)&&i&&i.length){const[e]=i,a=jt(e,t),r=Qt(t,e,a),o=qt(e,r);if(je(n))return o;if(Ht(o,Yt),0===Yt.t||1===Yt.t){if(!1===n)return Yt.n;const t=Zt(e,Yt,n);return`${ot(t.n,3)}${t.u}`}}},set:(e,t)=>{if(!je(t))return t.duration=ge,t.composition=Vt(t.composition,ce.none),new bn(e,t,null,0,!0).play()},remove:Tn,cleanInlineStyles:pn,random:xn,randomPick:e=>e[xn(0,e.length-1)],shuffle:e=>{let t,n,i=e.length-1;for(;i;)n=xn(0,i--),t=e[i],e[i]=e[n],e[n]=t;return e},lerp:(e,t,n,i)=>{const a=i||Et._hasChildren&&Et;let r=n;return a&&a.deltaTime&&(r=1-Math.exp(-n*a.deltaTime*.1)),(1-r)*e+r*t},clamp:An(rt),round:An(ot),snap:An(((e,t)=>t?Math.round(e/t)*t:e)),wrap:An(((e,t,n)=>((e-t)%(n-t)+(n-t))%(n-t)+t)),interpolate:An(st,1),mapRange:An(((e,t,n,i,a)=>i+(e-t)/(n-t)*(a-i))),roundPad:An(((e,t)=>e.toFixed(t))),padStart:An(((e,t,n)=>`${e}`.padStart(t,n))),padEnd:An(((e,t,n)=>`${e}`.padEnd(t,n))),degToRad:An((e=>e*at/180)),radToDeg:An((e=>180*e/at))},Pn=(new Map,(e,t={})=>{let n=[],i=0;const a=t.from,r=t.reversed,o=t.ease,s=!je(o),l=s&&Le(o)?o.solver:s?Rt(o):null,c=t.grid,u=t.axis,p=je(a)||0===a||"first"===a,d="center"===a,m="last"===a,h=Re(e),g=Ge(h?e[0]:e),_=h?Ge(e[1]):0,f=Ae.exec(h?e[1]:e),w=t.start||0+(h?g:0);let y=p?0:Fe(a)?a:0;return(e,a,o,s)=>{if(d&&(y=(o-1)/2),m&&(y=o-1),!n.length){for(let e=0;e<o;e++){if(c){const t=d?(c[0]-1)/2:y%c[0],i=d?(c[1]-1)/2:tt(y/c[0]),a=t-e%c[0],r=i-tt(e/c[0]);let o=Xe(a*a+r*r);"x"===u&&(o=-a),"y"===u&&(o=-r),n.push(o)}else n.push(Ze(y-e));i=it(...n)}l&&(n=n.map((e=>l(e/i)*i))),r&&(n=n.map((e=>u?e<0?-1*e:-e:Ze(i-e))))}const p=h?(_-g)/i:g;let v=(s?En(s,je(t.start)?s._iterationDuration:w):w)+(p*ot(n[a],2)||0);return t.modifier&&(v=t.modifier(v)),f&&(v=`${v}${f[2]}`),v}}),Nn=(e,t)=>new bn(e,t,null,0,!1).init(),Mn=e=>new Sn(e).init();oe&&(se.AnimeJS||(se.AnimeJS=[]),se.AnimeJS.push({version:"4.0.0-beta.99.1",engine:Et}),le.addEventListener("visibilitychange",(()=>Et.suspendWhenHidden?le.hidden?Et.suspend():Et.resume():0)));class On{constructor(e,t){this.data=e,this.timeline=t,this.interactionKey=this.timeline.interaction.key,this.isPreviewEditing=!1}get type(){return this.data.type}get timing(){return this.data.timing}get target(){return this.data.target}get key(){return this.data.key}get debugMode(){return this.timeline.debugMode}stopTimeline(){this.timeline.destroy(!1)}getRunner(){return this.timeline.getRunner()}getRawValue(e){return this.data.value[e]}getValue(e,t){let n=this.getRawValue(e);if("string"!=typeof n)return n;let i=!1,a=!1;const r=e=>{const t=e?e.trim():"",n=this.timeline.getProvidedValue(t);return void 0!==n?(a=!0,n):""};return n=n.trim(),n=n.replace(/data\.([\w\d\-_]+)/g,((e,t)=>(i=!0,r(t)))),n=n.replace(/(\{\{\s*.*?\s*\}\})/g,(e=>{i=!0;const t=e.slice(2,-2);return r(t)})),!i||a||!t?.toLowerCase().includes("color")&&"background"!==t?n:""}getAllProvidedData(){return this.timeline.getAllProvidedData()}provideData(e,t){const n=this.getValue(e);this.timeline.provideData({[n]:t}),this.debugMode&&console.debug(`[WPI Debug] Data for "${n}" updated:`,{...this.timeline.getAllProvidedData()})}getTargets(){return this.timeline.interaction.getTargets(this.data.target,this,this.timeline.interaction.getCurrentTrigger())}fixColorOptions(e,t){Object.keys(e).forEach((n=>{if("string"==typeof e[n]&&e[n].startsWith("var(")){const i=e[n];e[n]=()=>{const e=window.getComputedStyle(t[0]),n=i.replace(/^var\((.+)\)$/,"$1").split(",")[0];return e.getPropertyValue(n)}}}))}initActionAnimation(e){const t=e.targets||this.getTargets();if(this.debugMode){const n=e.onBegin?e.onBegin:null;e.onBegin=e=>{console.debug("[WPI Debug] Running action:",{...this.data},"on targets:",t),n&&n(e)}}if(this.isPreviewEditing&&1===t.length&&(t[0]===document.body||t[0]===window))return;this.timeline._targets.push(t);const n={};if(this.fixColorOptions(e,t),"time"===this.timeline.type)this.timing.isStartingState?this._didStartingSet?this._animationWithStartingState.play():(this._animationWithStartingState=Dn.set(t,{...e,...n}),this._didStartingSet=!0):this.timeline._animation.add(t,{..."custom"===this.timing.easing?{ease:this.timing.customEasing}:this.timing.easing?{ease:this.timing.easing}:{},duration:this.isPreviewEditing?0:1e3*this.timing.duration,...e,...n},this.getStartTime(1e3*this.timing.start+50));else{const i=this.getUniqueId(t);if(void 0===this.timeline._actionStarts[i]&&(this.timeline._actionStarts[i]={}),void 0===this.timeline._actionStarts[i][this.type])this.timing.isStartingState||(this.timeline._actionStarts[i][this.type]={action:this,options:e},this.timeline._animation._hasStarted||(this.timeline._animation.add(t,{duration:0,...e,...n},0),this.timeline._animation.seek(0)));else{const{action:t,options:a}=this.timeline._actionStarts[i][this.type],r=t.timing,o=this.timing.start-r.start,s=Object.keys(a).reduce(((t,n)=>(n.startsWith("on")||"modifier"===n||"composition"===n?t[n]=e[n]:t[n]=[a[n],e[n]],t)),{});this.timeline._animation.add(a.targets||t.getTargets(),{..."custom"===r.easing?{ease:r.customEasing}:r.easing?{ease:r.easing}:{},duration:o,...s,...n},this.getStartTime(r.start,r)),this.timeline._actionStarts[i][this.type]={action:this,options:e}}}}initActionFunction(e){if(void 0===this.timeline._funcPromises&&(this.timeline._funcPromises={}),void 0===this.timeline._funcPromises[this.timing.start]&&(this.timeline._funcPromises[this.timing.start]=[]),this.timeline._funcPromises[this.timing.start].push((()=>(this.debugMode&&console.debug("[WPI Debug] Running action:",{...this.data}),e(this.getTargets())))),-1===this.timing.start){const e=this.timeline._funcPromises[this.timing.start];e[e.length-1]?.()}1===this.timeline._funcPromises[this.timing.start].length&&-1!==this.timing.start&&("time"===this.timeline.type?this.timeline._animation.add((()=>{if(this.getRunner().actionFuncsDisabled)return;const e=this.timeline._animation.paused;this.timeline.pause();let t=Promise.resolve();this.timeline._funcPromises[this.timing.start].forEach((e=>{t=t.then((()=>{const t=e();return!1===t?Promise.reject():t}))})),t.then((()=>{e||this.timeline._animation.play()})).catch((()=>{this.debugMode&&console.debug("[WPI Debug] Timeline was stopped")}))}),1e3*this.timing.start):this.timeline._animation.add((()=>{let e=Promise.resolve();this.timeline._funcPromises[this.timing.start].forEach((t=>{e=e.then((()=>t()))}))}),this.timing.start))}getStartTime(e,t=null){const n=t||this.timing;return n.stagger?Pn(1e3*n.stagger,{start:e}):e}getUniqueId(e){return e.reduce(((e,t)=>(t._wpiuid||(t._wpiuid=Bn++),e+"-"+t._wpiuid)),"wpi")}removeStartingStyles(){this._ignoreStartingStyles=!0,this.getRunner().recomputeStartingActionStyles()}}let Bn=1;class Rn{constructor(e,t){this.timelineData=e,this.interaction=t,this.type=this.getRunner().getTimelineType(t),e&&(this.actions=this.timelineData.actions.map((e=>new On(e,this))),this._resetAtStart=!!e.reset,this._onceOnly=!!e.onceOnly,this._actionStarts={}),this._targets=[]}get debugMode(){return this.timelineData.debug}get hasActions(){return this.actions.length>0}createInstance(e){if(this.getRunner().isFrontend&&this.timelineData.onceOnly&&this.timelineData._played)return null;this._funcPromises={},this.timelineData._played=!0;const t={};"percentage"===this.type&&(t.duration=100);const n={loop:this.timelineData.loop?this.timelineData.loopTimes||!0:!!this.timelineData.alternate&&1,loopDelay:this.timelineData.loop?1e3*this.timelineData.loopDelay||0:void 0,reversed:this.timelineData.reverse,alternate:this.timelineData.alternate,...e,...t},i={onBegin:()=>{const e=e=>e.style?.setProperty("transition","none","important");this._targets.forEach((t=>{Array.isArray(t)?t.forEach(e):e(t)})),this.debugMode&&console.debug("[WPI Debug] Timeline started. Triggered by:",this.interaction.getCurrentTrigger())},onComplete:()=>{const e=e=>e.style?.removeProperty("transition");this._targets.forEach((t=>{Array.isArray(t)?t.forEach(e):e(t)})),this.debugMode&&console.debug("[WPI Debug] Timeline completed")},onLoop:()=>{if(this.debugMode){this._debugLoopCount=(this._debugLoopCount||0)+1;const e=1===this._debugLoopCount?"1st":2===this._debugLoopCount?"2nd":3===this._debugLoopCount?"3rd":`${this._debugLoopCount}th`;console.debug(`[WPI Debug] Looping: ${e} time`)}}},a=Mn({...n,autoplay:!1,defaults:{ease:"outCirc",autoplay:!1},...this.getRunner().isFrontend?i:{}});return"percentage"===this.type&&a.add({duration:100},0),this._targets=[],this._actionStarts={},this._dynamicData={},this.debugMode&&(console.debug("[WPI Debug] Interaction starting: ",this.interaction.data),console.debug("[WPI Debug] Initializing timeline with arguments:",n)),this._animation=a,this.actions.forEach((e=>{const t=this.getRunner().getActionConfig(e.type);t&&t.initAction(e)})),this}getRunner(){return this.interaction.getRunner()}getProvidedValue(e){if(this._dynamicData[e])return this._dynamicData[e]}getAllProvidedData(){return this._dynamicData}provideData(e){this._dynamicData={...this._dynamicData,...e}}getStartTime(e,t){return t.stagger?Pn(1e3*t.stagger,{start:e}):e}getProgress(){return this._animation?this._animation.currentTime/this._animation.duration:0}play(){this._animation&&(this._animation.reset(),this._animation.play())}seek(e){this._animation&&this._animation.seek(e)}seekPercentage(e,t=0){if(this._animation)if(t){const n=parseInt(t,10);let i=Dn.lerp(0,1,Math.abs(e-this._animation.progress));i*=i,i=Dn.interpolate(n,n+300,i),Nn(this._animation,{progress:e,duration:i,ease:"outQuad",composition:this.getRunner().isFrontend?"blend":"replace"})}else this._animation.seek(this._animation.duration*e)}pause(){this._animation&&this._animation.pause()}destroy(e=!0){if((!this.timelineData.loop||!this.timelineData.onceOnly)&&this._animation){const t=this._resetAtStart&&!this._onceOnly;this._animation.pause(),e||t?this._animation.revert():this._animation.cancel()}}}class Ln{constructor(e,t){this.interactionData=e,this.runner=t,this._destroyFuncs=[],this.interactionData&&(this.timelines=this.interactionData.timelines.map((e=>new Rn(e,this))))}get data(){return this.interactionData}get key(){return this.interactionData.key}get type(){return this.interactionData.type}getRunner(){return this.runner}getDocument(){return this.runner.getDocument()}getOption(e,t){return void 0!==this.interactionData.options?.[e]&&""!==this.interactionData.options?.[e]?this.interactionData.options?.[e]:t}createTimelineInstance(e=0,t={}){return this.timelines[e].createInstance(t)}cloneWithTrigger(e){const t=new Ln;return Object.assign(t,this),t._currentTrigger=e,t.timelines=this.timelines.map(((e,n)=>new Rn(this.interactionData.timelines[n],t))),t}init(){let e=this.getTargets(this.interactionData.target);const t=this.runner.getInteractionConfig(this.interactionData.type);"page"===t?.type&&0===e.length&&(e=[document.body]),this.triggerElements=e,t&&e.forEach((e=>{const n=this.cloneWithTrigger(e),i=t.initTimeline(n);i&&this._destroyFuncs.push(i)}))}getTriggers(){return this.triggerElements}getCurrentTrigger(){return this._currentTrigger||this.triggerElements&&this.triggerElements[0]}destroy(){this._destroyFuncs.forEach((e=>e()))}compileStartingStyles(){const e=this.getTargetsSelector(this.interactionData.target),t={};this.timelines.forEach((n=>{n.actions.forEach((n=>{if(!n.timing.isStartingState)return"";if(n._ignoreStartingStyles)return"";const i=this.runner.getActionConfig(n.type);if(!i)return"";let a=this.getTargetsSelector(n.target,e);if(i.blockElementSelector&&("block"===n.target.type||"block-name"===n.target.type||"class"===n.target.type)){const e="block"===n.target.type?n.target.blockName:n.target.value;a=i.blockElementSelector(a,new Fn(e))}if(i.initialStyles){const e=i.initialStyles(n);t[a]||(t[a]=[]),e&&t[a].push(e)}}))}));let n="";return Object.keys(t).length&&Object.keys(t).forEach((e=>{let i=`${e} {`;t[e].forEach((e=>{e.startsWith("transform:")&&i.includes("transform:")?i=i.replace("transform:",e.replace(/;$/,"")):i+=e})),i+="}",n+=i})),n}compileStartingScripts(){const e=[];return this.timelines.forEach((t=>{t.actions.forEach((t=>{const n=this.runner.getActionConfig(t.type);return n&&t.timing.isStartingState?void(n.runInitialScript&&e.push((()=>{try{this.getTargets(this.interactionData.target).forEach((e=>{const i=this.getTargets(t.target,null,e);n.runInitialScript(t,i)}))}catch(e){console.log("[WPI] Error in runInitialScript: ",e)}}))):""}))})),e}getTargets(e,t=null,n=null){const i=this._getTargets(e,n);return t?this.fixTargetForBlock(i,t):i}_getTargets(e,t){const{type:n,value:i,options:a=""}=e;if("trigger"===n)return Array.isArray(t)?t:[t];if("window"===n)return[window];if("document"===n)return[document];const r="block"===n?`#${i}`:"class"===n?`.${i}`:"block-name"===n?this._getBlockNameSelector(i):i;let o=[];try{o=Array.from(this.getDocument().querySelectorAll(r))}catch(e){}return a?this._filterTargets(o,a,t):o}_filterTargets(e,t,n){return"first"===t?e.slice(0,1):"last"===t?e.slice(-1):e.reduce(((e,i)=>{if("content-area"===t)this.isFrontend?i.closest(".entry-content")&&e.push(i):e.push(i);else if("not-trigger"===t)i!==n&&e.push(i);else if("children"===t)n?.contains(i)&&i!==n&&e.push(i);else if("siblings"===t)i.parentElement===n?.parentElement&&i!==n&&e.push(i);else if("siblings-with-trigger"===t)i.parentElement===n?.parentElement&&e.push(i);else if("parent"===t)i.contains(n)&&e.push(i);else if("same-index"===t){const t=Array.from(n?.parentElement.children||[]).indexOf(n);i.parentElement.children[t]===i&&i!==n&&e.push(i)}else if("same-index-with-trigger"===t){const t=Array.from(n?.parentElement.children||[]).indexOf(n);i.parentElement.children[t]===i&&e.push(i)}else if("not-same-index"===t){const t=Array.from(n?.parentElement.children||[]).indexOf(n);i.parentElement.children[t]!==i&&i!==n&&e.push(i)}else"first"===t&&0===e.length&&e.push(i);return e}),[])}getTargetsSelector(e,t=""){const{type:n,value:i,options:a}=e;if("trigger"===n)return t;const r="block"===n?this._getBlockSelector(i):"class"===n?`.${i}`:"block-name"===n?this._getBlockNameSelector(i):i;return a?this._filterTargetsSelector(r,a,t):r}_filterTargetsSelector(e,t,n){const i=e.includes(",")?`:is(${e})`:e;return"content-area"===t?this.isFrontend?`.entry-content ${i}`:i:"not-trigger"===t?`${i}:not(${n})`:"children"===t?`${n} ${i}`:"siblings"===t?`*:has(> ${n}) > ${i}:not(${n})`:"siblings-with-trigger"===t?`*:has(> ${n}) > ${i}`:"parent"===t?`*:has(> ${n}) ${i}`:i}_getBlockSelector(e){if(this.runner.isFrontend)return`#${e}`;const t=this.runner.getBlockClientId(e);return t?`#block-${t}`:`#${e}`}_getBlockNameSelector(e){return this.runner.isFrontend?e.startsWith("core/")?`.wp-block-${e.replace("core/","")}`:`.wp-block-${e.replace("/","-")}`:`[data-type="${e}"]`}fixTargetForBlock(e,t){const n=this.runner.getConfig().actions[t.type];return n?e.map((e=>{if(n.blockElementSelector){const t=n.blockElementSelector(":scope",new Fn(e));if(":scope"!==t)return e.querySelector(t)||e}return e})).filter((e=>null!=e)):e}}class Fn{constructor(e){this.blockNameOrElement=e}isBlock(e){if(!this.blockNameOrElement)return!1;if("string"==typeof this.blockNameOrElement)return this.blockNameOrElement===e;const t=e.replace(/^core\//g,"").replace(/\//g,"-");return this.blockNameOrElement.classList.contains(`wp-block-${t}`)}}const Vn=class{constructor(){this._config={interactions:{},actions:{}},this._interactionData={},this._initialCallbacks=[],this._startingStyles="",this.isFrontend=!0,this.interactions=[]}spawn(){const e=new this.constructor;return Object.assign(e,this),e}addInteractionConfig(e){Object.keys(e).forEach((t=>{this._config.interactions[t]={...this._config.interactions[t]||{},...e[t]}}))}addActionConfig(e){this._config.actions={...this._config.actions,...e}}getConfig(){return this._config}getInteractionConfig(e){return this._config.interactions[e]}getActionConfig(e){return this._config.actions[e]}getDocument(){return document}getTimelineType(e){return this.getInteractionConfig(e.type)?.timelineType}configure(e){this.interactions.length&&this.interactions.forEach((e=>{e.destroy(!0)})),this._interactionData=e,this.interactions=[],this._interactionData.forEach((e=>{this.interactions.push(new Ln({...e},this))})),this.configureStartingActions()}configureStartingActions(){this._startingStyles="",this._initialCallbacks=[],this.interactions.forEach((e=>{this._startingStyles+=e.compileStartingStyles(),this._initialCallbacks=[...this._initialCallbacks,...e.compileStartingScripts()]})),this.isFrontend&&(this._initStylesEl=document.createElement("style"),this._initStylesEl.setAttribute("id","wpi-action-starting-states"),this._initStylesEl.innerHTML=this._startingStyles,document.head.appendChild(this._initStylesEl))}recomputeStartingActionStyles(){this._startingStyles=this.interactions.map((e=>e.compileStartingStyles())).join(""),this.isFrontend&&this._initStylesEl&&(this._initStylesEl.innerHTML=this._startingStyles)}getStartingActionStyles(){return this._startingStyles}init(){this.isFrontend&&this._initialCallbacks.length&&J((()=>{this._initialCallbacks.forEach((e=>e()))})),this.interactions.forEach((e=>{e.init()}))}destroy(){this.interactions.forEach((e=>{e.destroy()}))}},$n=()=>{},jn=new class extends Vn{constructor(e,t){super(e,t),this.isFrontend=!1,this.actionFuncsDisabled=!1,this._previewInit=null,this._previewTimeline=null,this._domPreviews=[],this._interactionDestroyer=null,this._editorConfig={interactions:{},actions:{}}}addInteractionEditorConfig(e){this._editorConfig.interactions={...this._editorConfig.interactions,...e}}addActionConfig(e){Object.keys(e).forEach((t=>{_.actions[t]?.hasPreview||(e[t].initAction=$n)})),super.addActionConfig(e)}getDocument(){const e=document.querySelector('iframe[name="editor-canvas"]');let t=document.querySelector(".editor-styles-wrapper");return e&&(t=e.contentDocument.querySelector(".editor-styles-wrapper")),t}getTimelineType(e){return _.interactions[e.interactionData.type]?.timelineType||"time"}namedNodeMapToObject(e){const t={};if(void 0!==e)for(let n=0;n<e.length;n++){const i=e[n];t[i.name]=i.value}return t}applyAttributesToObject(e,t){if(void 0!==e.attributes)for(;e.attributes.length>0;)e.removeAttribute(e.attributes[0].name);for(const n in t)t.hasOwnProperty(n)&&e.setAttribute(n,t[n])}_resetPreview(){this._previewTimeline?.destroy(!0),this._previewTimeline=null,this._interactionDestroyer&&(this._interactionDestroyer(),this._interactionDestroyer=null),this._domPreviews.forEach((e=>{e._initialState&&(this.applyAttributesToObject(e,e._initialState),e._initialState=null)})),this._domPreviews=[],this._previewInit=!1}_initPreview(){this._resetPreview(),this._previewInit||(this._previewInit=!0,this.interactions[0].timelines[0].actions.forEach((e=>{e.getTargets().forEach((e=>{e&&!this._domPreviews.includes(e)&&(e._initialState||(e._initialState=this.namedNodeMapToObject(e.attributes)),this._domPreviews.push(e))}))})))}playPreview(e=0){this._initPreview(),this.actionFuncsDisabled=!1;const t=t=>{window.dispatchEvent(new window.CustomEvent(`wpi/timeline/animation-update/${e}`,{detail:{animation:t}}))},n=this.interactions[0],i=this.getTimelineType(n);n.timelines[0].actions.forEach((e=>{e.isPreviewEditing=!1}));const a=n.createTimelineInstance(0,{onUpdate:t}),r=this._editorConfig.interactions[n.interactionData.type];r&&(this._interactionDestroyer=r.initTimeline(a,n,e),setTimeout((()=>{t(a._animation)}),1)),"time"===i&&a.play(),this._previewTimeline=a}stopPreview(){this._resetPreview(),window.dispatchEvent(new CustomEvent("wpi/timeline-stop-preview"))}editPreview(e){this._initPreview(),this.actionFuncsDisabled=!0;const t=this.interactions[0];let n=0;t.timelines[0].actions.find((t=>t.key===e&&(n=t.timing.start,t.isPreviewEditing=!0,!0))),t.timelines[0].actions.forEach((e=>{e.timing.start===n&&(e.isPreviewEditing=!0)}));const i=t.createTimelineInstance(0,{autoplay:!1});"time"===i.type?i.seek(1e3*n+50):i.seek(n),this._previewTimeline=i}getBlockClientId(e){return W(e)}};window.WPIRunner=jn;const Wn=__webpack_require__(165);Wn.keys().forEach(Wn);const qn=__webpack_require__(9038);qn.keys().forEach(qn);const zn=(e,t,n,i)=>{if("percentage"===i){const t=e.type;if(_.actions[t].isAnimation&&!e.timing.isStartingState){const{options:i,...a}=e.target,r=n.reduce(((e,n)=>{if(n.type===t){const{options:t,...i}=n.target;if((0,f.isEqual)(i,a))return e+1}return e}),0);if(r<=1)return{type:"need-another-action",message:(0,c.sprintf)((0,c.__)("You need another %s action with the same target for this animation effect to work.","wp-interactions"),t)}}}return null},Hn=()=>{},Un={},Yn=[];let Gn=1;const Qn=t=>{const{type:n="time",actions:i=[],onChange:a=Hn,interaction:s=Un,timelineIndex:l=0}=t,[u,p]=(0,w.useState)(null),[d,m]=(0,w.useState)([]),[h,g]=(0,w.useState)(-1),[v,b]=(0,w.useState)(!1),[E,k]=(0,w.useState)(!1),[S,C]=(0,w.useState)(null),[T,x]=(0,w.useState)(!1),I=(0,w.useRef)(),A=(0,w.useRef)(),D=(0,y.useSelect)((e=>e("core/edit-site")?.__experimentalGetPreviewDeviceType()||e("core/edit-post")?.__experimentalGetPreviewDeviceType()||"Desktop"),[]),P=ae(),N=ie(),M=(0,w.useRef)(Gn++),R=(0,w.useRef)();(e=>{const{onCopy:t=re,onPaste:n=re,onDelete:i=re,onSelectAll:a=re,onEscape:r=re}=e;(0,w.useEffect)((()=>{const e=e=>{if(e.target.closest("input"))return;const o=/Mac|iPod|iPhone|iPad/i.test(window.navigator?.platform||"")?e.metaKey:e.ctrlKey;"c"===e.key&&o&&t&&t(e),"v"===e.key&&o&&n&&n(e),"Delete"!==e.key&&"Backspace"!==e.key||i(e),"a"===e.key&&o&&a(e),"Escape"===e.key&&r(e)};return window?.addEventListener("keydown",e),window?.addEventListener("keyup",e),()=>{window?.removeEventListener("keydown",e),window?.removeEventListener("keyup",e)}}),[t,n,i,a,r])})({onCopy:()=>{if(E&&d.length){const e=i.filter((({key:e})=>d.includes(e)));localStorage.setItem("wpi-copied-actions",JSON.stringify(e)),(0,y.dispatch)("core/notices").createNotice("success",(0,c.sprintf)((0,c._n)("Copied %d action to clipboard.","Copied %d actions to clipboard",d.length,"wp-interactions"),d.length),{type:"snackbar",isDismissible:!0,id:"COPY_ACTIONS"})}},onPaste:()=>{if(!E)return;const e=JSON.parse(localStorage.getItem("wpi-copied-actions")||null);if(!e)return void(0,y.dispatch)("core/notices").createNotice("error",(0,c.__)("No actions to paste.","wp-interactions"),{type:"snackbar",isDismissible:!0,id:"PASTE_ERROR_ACTIONS"});const t=e.map(U).reverse(),n=i.findIndex((e=>e.key===(0,f.last)(d)))||i.length-1,r=i.findIndex((e=>e.key===(0,f.last)(d))),o=i[r]?.timing.start;o&&t.forEach((e=>{e.timing.start=-1===e.timing.start?e.timing.start:o}));const s=[...i];s.splice(n+1,0,...t),a(s),m(t.map((e=>e.key))),p((0,f.first)(t)?.key||null),(0,y.dispatch)("core/notices").createNotice("success",(0,c.sprintf)((0,c._n)("Pasted %d action.","Pasted %d actions",t.length,"wp-interactions"),t.length),{type:"snackbar",isDismissible:!0,id:"PASTE_ACTIONS"})},onDelete:()=>{if(E&&d.length&&window.confirm((0,c.sprintf)((0,c._n)("Are you sure you want to delete %d action?","Are you sure you want to delete %d actions?",d.length,"wp-interactions"),d.length))){const e=[...i];d.forEach((t=>{const n=e.findIndex((e=>e.key===t));e.splice(n,1)})),m([]),a(e),A.current.focus()}},onSelectAll:e=>{E&&(e.preventDefault(),m(i.map((({key:e})=>e))))},onEscape:e=>{E&&(e.preventDefault(),m([]))}});const F="time"===n?"button":"live";(0,w.useEffect)((()=>{b(!1)}),[D]),(0,w.useEffect)((()=>{if(v&&I.current){if("button"===F){const{startTimes:e,translateY:t}=(e=>{const t=[],n=[];let i=-30,a=0;return i+=e.reduce(((e,{timing:t})=>(t.isStartingState&&(e+=0===e?40:30),e)),0),e.forEach((({timing:e})=>{e.isStartingState||(t.includes(1e3*e.start)?a+=30:(i+=40+a,n.push(i),t.push(1e3*e.start),a=0))})),{startTimes:t,translateY:n}})(i),n=I.current,a=400,r=Mn({defaults:{ease:"easeOutCirc"},onUpdate:e=>{n.innerHTML=parseFloat(parseInt(e.currentTime)/1e3).toFixed(2)}});return e.forEach(((e,i)=>{const o=t[i-1]||10;r.add(n,{duration:a,translateY:[o,t[i]]},e-a)})),x(!0),()=>{try{r.cancel()}catch(e){}}}const e=Mn({defaults:{ease:"easeOutCirc"},autoplay:!1,onUpdate:e=>{t.innerHTML=parseInt(e.currentTime)+"%"}}),t=I.current,n=Array.from(t.parentElement.querySelectorAll(".wpi-timeline__item:not(.wpi-timeline__item--secondary), .wpi-timeline__drop-gap.is-force-label"));n.forEach(((i,a)=>{if(a===n.length-1)return;const r=parseInt(i.dataset.start||i.dataset.label),o=n[a+1],s=parseInt(o.dataset.start||o.dataset.label),l=t.parentElement.getBoundingClientRect(),c=i.getBoundingClientRect(),u=o.getBoundingClientRect(),p=c.top-l.top+c.height/2-t.offsetHeight/2,d=u.top-l.top+u.height/2-t.offsetHeight/2;e.add(t,{duration:s-r,translateY:[p,d]},r)}));const a=t=>{const{animation:n}=t.detail;if(void 0!==n.currentTime){const t=e._lastTime===e._elapsedTime?1:120;Nn(e,{progress:n.currentTime/n.duration,duration:t,ease:"outQuad",composition:"blend"}),x(!0)}};return window.addEventListener(`wpi/timeline/animation-update/${l}`,a),()=>{window.removeEventListener(`wpi/timeline/animation-update/${l}`,a);try{e.cancel()}catch(e){}}}}),[v,F,i,l]),(0,w.useEffect)((()=>{const e=e=>{e.target.closest(`.instance-${M.current}`)||k(!1),d.length&&(e.target.closest(".wpi-popover")||e.target.closest(".wpi-timeline__box")&&e.target.closest(`.instance-${M.current}`)||m([]))};return document.addEventListener("mousedown",e),()=>document.removeEventListener("mousedown",e)}),[d]),(0,w.useEffect)((()=>{E&&window?.dispatchEvent(new window.CustomEvent("wpi/timeline-focused",{detail:{instance:M.current}}));const e=e=>{e.detail.instance!==M.current&&k(!1)};return window?.addEventListener("wpi/timeline-focused",e),()=>window?.removeEventListener("wpi/timeline-focused",e)}),[E]);const[V,$]=((e,t,n)=>{const i=(0,w.useRef)(null),a=(0,w.useMemo)((()=>{i.current||(i.current=jn.spawn());const a=(0,f.cloneDeep)(e);return a.timelines=[{...a.timelines[n],actions:(0,f.cloneDeep)(t)}],(e=>{if("block"===e.target.type){const t=W(e.target.value);t&&(e.target.value=`block-${t}`)}e.timelines.forEach(((t,n)=>{t.actions.forEach(((t,i)=>{if("block"===t.target.type){const a=W(t.target.value);a&&(e.timelines[n].actions[i].target.value=`block-${a}`)}}))}))})(a),i.current?.configure([a]),i.current?.init(),i.current?.getStartingActionStyles()||""}),[e,n,t]);return[i,a]})(s,i,l);(e=>{const t=(0,w.useRef)(null);(0,w.useEffect)((()=>{const e=(0,f.debounce)((()=>{t.current&&!O()?.contains(t.current)&&O()?.appendChild(t.current)}),50),n=new MutationObserver((()=>{e()}));return n.observe(document.body,{subtree:!0,childList:!0}),()=>{n.disconnect(),setTimeout((()=>{t.current?.remove()}),60)}}),[]),(0,w.useEffect)((()=>{O()&&!t.current&&(t.current=document.createElement("style"),t.current.type="text/css",t.current.setAttribute("class","wpi-action-starting-states"),O().appendChild(t.current)),t.current&&(t.current.innerHTML=e)}),[e])})($),(0,w.useEffect)((()=>{const e=()=>{x(!1),V.current?.stopPreview(l)};return v||e(),()=>{v&&e()}}),[v,V,l]),(0,w.useEffect)((()=>{u?V.current?.editPreview(u,l):V.current?.stopPreview(l)}),[u,i,V,l]),(0,w.useEffect)((()=>{const e=()=>{v&&(V.current?.stopPreview(l),setTimeout((()=>V.current?.playPreview(l))))};return window?.addEventListener("wpi/timeline-restart-preview",e),()=>window?.removeEventListener("wpi/timeline-restart-preview",e)}),[v,V,l]);const j=t=>{const{action:r,index:o,interactionType:s,isSecondary:l,stepProvidedValues:c,warningMessage:w=""}=t;return(0,e.createElement)(Jn,{key:r.key,type:n,action:r,hasTrigger:"page"!==s,isSelected:u===r.key,isHighlighted:d.includes(r.key),isSecondary:l,warningMessage:w,stepProvidedValues:c,onDrag:C,onSelect:()=>{p(r.key),g(-1),b(!1),m([r.key])},onDeselect:()=>{p(null),g(-1)},onDelete:()=>{const e=[...i];e.splice(o,1),p(null),b(!1),a(e)},onChange:e=>{const t=[...i];t[o]=e,b(!1),0!==o&&!i[o-1]?.timing.isStartingState&&e.timing.isStartingState&&(t.splice(o,1),t.unshift(e)),a(t)},onStartTimeFocus:()=>b(!1),onStartTimeChange:e=>{const t=[...i],n=i[o].timing.start,r=0===o||i[o].timing.start!==i[o-1].timing.start;if(t[o].timing.start=e,r)for(let a=o+1;a<i.length&&t[a].timing.start===n;a++)t[a].timing.start=e;b(!1),a(t)},onDrop:(e,t)=>{const n=[...i],s=i[o].timing.start,l=n.findIndex((t=>t.key===e));if(!_.actions[n[l].type].hasStartingState&&s<0)return;-1!==l&&(n[l].timing.start=s),n[l].timing.isStartingState=s<0;const c=n.splice(l,1)[0],u=n.findIndex((({key:e})=>e===r.key));"top"===t?n.splice(u,0,c):n.splice(u+1,0,c),a(n)},onMouseDown:()=>{if(P)m((e=>e.includes(r.key)?e.filter((e=>e!==r.key)):[...e,r.key]));else if(N){if(!d.length)return m([r.key]);const e=[],t=i.findIndex((({key:e})=>e===d[0])),n=i.findIndex((({key:e})=>e===r.key)),a=t<n?1:-1;for(let r=t;r!==n+a;r+=a)e.push(i[r].key);m(e)}},onKeyDown:e=>{if(N){if(N&&d.length&&(e.preventDefault(),k(!0),"ArrowUp"===e.key||"ArrowDown"===e.key)){const t=d[0];let n=i.findIndex((({key:e})=>e===t));-1!==h&&(n=h),n="ArrowUp"===e.key?n>0?n-1:0:n<i.length-1?n+1:i.length-1,g(n);const a=n>o?n:o,r=[];for(let e=n<o?n:o;e<=a;e++)r.push(i[e].key);m(r)}}else if("ArrowUp"===e.key||"ArrowDown"===e.key){e.preventDefault();const t=e.target.closest(".wpi-timeline__item");"ArrowUp"===e.key?t?.previousElementSibling&&t.previousElementSibling.classList.contains("wpi-timeline__item")?t.previousElementSibling.querySelector(".wpi-timeline__box").focus():t?.previousElementSibling.previousElementSibling&&t.previousElementSibling.previousElementSibling.classList.contains("wpi-timeline__item")?t.previousElementSibling.previousElementSibling.querySelector(".wpi-timeline__box").focus():A.current.querySelector(".wpi-timeline__box")?.focus():"ArrowDown"===e.key&&(t?.nextElementSibling&&t.nextElementSibling.classList.contains("wpi-timeline__item")?t.nextElementSibling.querySelector(".wpi-timeline__box").focus():t?.nextElementSibling.nextElementSibling&&t.nextElementSibling.nextElementSibling.classList.contains("wpi-timeline__item")?t.nextElementSibling.nextElementSibling.querySelector(".wpi-timeline__box").focus():(0,f.last)(A.current.querySelectorAll(".wpi-timeline__box"))?.focus())}},onFocus:()=>{g(-1),b(!1),m([r.key]),k(!0)}})},q="page"===_.interactions[s.type]?.type?"page":"element",z=[];return(0,e.createElement)(o.BaseControl,{className:"wpi-list-control",label:(0,c.__)("Action Timeline","wp-interactions"),help:/Mac|iPod|iPhone|iPad/i.test(window.navigator?.platform||"")?(0,c.__)("Command+C to copy, Command+V to paste. Shift+click for multiple selections.","wp-interactions"):(0,c.__)("Ctrl+C to copy, Ctrl+V to paste. Shift+click for multiple selections.","wp-interactions")},(0,e.createElement)(ki,{type:n,onClick:()=>{R.current=(0,f.last)(d),b(!1)},onAddAction:e=>{let t=50;if("time"===n)t=0,R.current&&(t=i.find((({key:e})=>e===R.current))?.timing.start||0),t||(t=i.reduce(((e,{timing:t})=>{const n=parseFloat(t.start);return n>e?n:e}),0)+.5);else{t=50,R.current&&(t=i.find((({key:e})=>e===R.current))?.timing.start||0);const n=i.reduce(((t,n)=>t+(n.type===e?1:0)),0);n?1===n&&(t=50):t=0}const r=(e=>{const{actionType:t,start:n=0,targetType:i="trigger"}=e,a=L("1234567890abcdef",10),r=_.actions[t],o=Object.keys(r.properties).reduce(((e,t)=>{const n=r.properties[t];return e[t]=n.default,e}),{}),s=r?.defaultEasing||"outCirc";return{type:t,key:`action_${a(10)}`,target:{type:i,value:"",blockName:"",options:""},timing:{isStartingState:!1,start:n,duration:.5,easing:s,customEasing:""},value:o}})({actionType:e,start:i.length?t:0,targetType:"element"===q?"trigger":"block"}),o=[...i,r];a(o),p(r.key)}}),(0,e.createElement)("div",{className:r()("wpi-timeline",`wpi-timeline--${n}`,`instance-${M.current}`,{"is--empty":!i.length}),onMouseDown:()=>{k(!0)},role:"button",tabIndex:0,ref:A},v&&(0,e.createElement)("div",{className:"wpi-timeline-time-highlight",ref:I,style:{visibility:T?"":"hidden"}},"time"===n?"0.00":"0%"),"percentage"===n&&!!i.length&&(0,f.range)(-1,101).reduce(((t,r)=>{if(-1===r&&!i[0]?.timing.isStartingState)return t;let o=!1;0===r&&(i.find((e=>0===e.timing.start))||(o=!0)),r<=0&&t.push((0,e.createElement)(Xn,{forceLabel:o,key:`gap-${r}`,time:r,label:r<0?"«":`${r}%`,onDrop:e=>{const t=[...i],n=t.findIndex((t=>t.key===e));t[n].timing.start=r,t[n].timing.isStartingState=!1;let o=0;-1===r&&t[0].timing.isStartingState&&(t[n].timing.start=-1,t[n].timing.isStartingState=!0),0===r&&i.some((e=>!e.timing.isStartingState||(o++,!1))),t.splice(o,0,t.splice(n,1)[0]),a(t)}}));let s=!1,l=!1;return i.forEach(((e,a)=>{let o=!1;(-1===r&&e.timing.isStartingState||r>=0&&e.timing.start===r)&&(o=!0),o&&(s=!0,t.push(j({action:e,index:a,interactionType:q,isSecondary:l,stepProvidedValues:(0,f.cloneDeep)(z),warningMessage:zn(e,0,i,n)})),l=!0);const c=i[a].type,{provides:u}=(c?_.actions[c]:null)||[];u?.forEach((e=>{const t=i[a]?.value[e];t&&z.push(t)}))})),r>0&&r<100&&!s&&t.push((0,e.createElement)(Xn,{key:`gap-${r}`,label:`${r}%`,onDrop:e=>{const t=[...i],n=t.findIndex((t=>t.key===e));t[n].timing.start=r,t[n].timing.isStartingState=!1;let o=0;i.some((e=>!(e.timing.start<r&&(o++,1)))),t.splice(o,0,t.splice(n,1)[0]),a(t)}})),t}),[]),"time"===n&&i.map(((t,r)=>{const o=i[r-1]?.timing.start,s=o===t.timing?.start,l=(0,e.createElement)(w.Fragment,{key:t.key||r},!s&&(0,e.createElement)(Xn,{label:(()=>{if(S){if(S?.key===t.key)return"";if(i[r-1]?.key===S?.key)return""}let e=0;if(r>0){const t=parseFloat(i[r].timing.start);e=parseFloat(i[r-1].timing.start),e+=e+.5<t?.5:(t-e)/2,e<0&&(e=0)}return 0===r&&i[0].timing.isStartingState?"«":e.toFixed(2)})(),onDrop:e=>{const n=[...i],o=n.findIndex((t=>t.key===e));if(!_.actions[n[o].type].hasStartingState&&0===r)return;if(i[o-1]?.timing.start!==i[o].timing.start&&i[o+1]?.timing.start!==i[o].timing.start&&(e===t.key||e===i[r-1]?.key))return;let s=0;if(r>0){const e=parseFloat(i[r].timing.start);s=parseFloat(i[r-1].timing.start),s+=s+.5<e?.5:(e-s)/2,s<0&&(s=0)}n[o].timing.start=s,n[o].timing.isStartingState=!1,0===r&&n[r].timing.isStartingState&&(n[o].timing.start=-1,n[o].timing.isStartingState=!0),n.splice(r,0,n.splice(o,1)[0]),a(n)}}),j({action:t,index:r,interactionType:q,isSecondary:s,stepProvidedValues:(0,f.cloneDeep)(z),warningMessage:zn(t,0,i,n)})),c=i[r].type,{provides:u}=(c?_.actions[c]:null)||[];return u?.forEach((e=>{const t=i[r]?.value[e];t&&z.push(t)})),l})),!!i.length&&(0,e.createElement)(Xn,{isTall:!0,forceLabel:"time"!==n&&!i.find((e=>100===e.timing.start)),label:"percentage"===n?"100%":"time"===n&&(0,f.last)(i)?.key===S?.key?"":(parseFloat(i[i.length-1].timing.start)+.5).toFixed(2),onDrop:e=>{const t=[...i],r=parseFloat(i[i.length-1].timing.start),o=t.findIndex((t=>t.key===e));(i[o-1]?.timing.start===i[o].timing.start||i[o+1]?.timing.start===i[o].timing.start||o!==i.length-1||"percentage"===n)&&("time"===n?(t[o].timing.start=r+.5,t[o].timing.isStartingState=!1):(t[o].timing.start=100,t[o].timing.isStartingState=!1),t.push(t.splice(o,1)[0]),a(t))}}),!i.length&&(0,e.createElement)("div",{className:"wpi-list-control__empty-description"},(0,e.createElement)(B,{width:"32",height:"32"}),(0,e.createElement)("p",null,(0,c.__)("Add an action by clicking on the + above to start building your timeline sequence.","wp-interactions")))),"button"===F&&(0,e.createElement)(w.Fragment,null,!v&&(0,e.createElement)(o.Button,{label:(0,c.__)("Preview Timeline","wp-interactions"),icon:"controls-play",onClick:()=>{V.current.playPreview(l),b(!0)},disabled:!i.length},(0,c.__)("Preview","wp-interactions")),v&&(0,e.createElement)(o.Button,{label:(0,c.__)("Stop Preview","wp-interactions"),icon:"controls-pause",onClick:()=>b(!1),isBusy:!0,disabled:!i.length},(0,c.__)("Stop Preview","wp-interactions"))),"live"===F&&(0,e.createElement)(o.ToggleControl,{label:(0,c.__)("Live Preview","wp-interactions"),icon:"controls-play",checked:v,onChange:()=>{b((e=>(e||V.current.playPreview(l),!e)))}},(0,c.__)("Live Preview","wp-interactions")))},Xn=t=>{const{isTall:n=!1,onDrop:i=Hn,label:a="",forceLabel:o=!1}=t,[s,l]=(0,w.useState)(!1);return(0,e.createElement)("div",{className:r()("wpi-timeline__drop-gap",{"wpi-timeline__box--highlight":s,"is-tall":n,"is-force-label":o,[`time-${isNaN(parseInt(a))?"initial":parseInt(a)}`]:a}),onDragOver:()=>{l(!0)},onDragLeave:()=>{l(!1)},onDrop:e=>{const t=e.dataTransfer.getData("text/plain");i(t),l(!1)},"data-label":a})},Kn={size:"small",icon:"update-alt",variant:"tertiary",label:(0,c.__)("Change Action","wp-interactions")},Jn=t=>{const{action:n={},type:i="time",isSecondary:a=!1,isSelected:s=!1,isHighlighted:l=!1,hasTrigger:u=!0,warningMessage:p=null,onSelect:d=Hn,onDeselect:m=Hn,onDelete:h=Hn,onChange:g=Hn,onStartTimeFocus:f=Hn,onStartTimeChange:v=Hn,onDrop:b=Hn,onMouseDown:E=Hn,onKeyDown:k=Hn,onFocus:S=Hn,onDrag:C=Hn,stepProvidedValues:T=Yn}=t,I=r()("wpi-timeline__item",{"wpi-timeline__item--secondary":a,"wpi-timeline__item--selected":s||l,"wpi-timeline__item--is-initial":n.timing.isStartingState}),A=_.actions[n.type],D=void 0===A?.hasTarget||A.hasTarget,P=void 0===A?.hasStartingState||A.hasStartingState,N=void 0===A?.hasDuration||A.hasDuration,O=void 0===A?.hasEasing||A.hasEasing,B=void 0===A?.isRequiredTarget||A.isRequiredTarget;let R=void 0===A?.hasStagger||A.hasStagger;A?.isAnimation||(R=!1);const[L,F]=(0,w.useState)(),V=(0,w.useRef)(),$=(0,w.useRef)(),[j,W]=(0,w.useState)(null),[q,z]=(0,w.useState)(!1),[H,U]=(0,w.useState)(!1),Y=ae(),G=ie();(0,w.useEffect)((()=>()=>{"block"===n.target.type&&""!==n.target.value&&window?.dispatchEvent(new window.CustomEvent("wpi/highlight-block",{detail:{anchor:null}}))}),[n.target.type,n.target.value]),(0,w.useEffect)((()=>{U(null)}),[s]),(0,w.useEffect)((()=>{s&&setTimeout((()=>$.current?.focus({preventScroll:!0})))}),[s]);const Q="time"===i?parseFloat(n.timing.start).toFixed(2):parseInt(n.timing.start),X=!A?.shortName&&!A?.name;let K=A?.shortName||A?.name||n.type||(0,c.__)("Unknown","wp-interactions");const J=A?.dynamicName;if(J){const e={...n.value};Object.keys(e).forEach((t=>{const n=e[t],i=A?.properties[t];"select"===i?.type&&(e[t]=i.options[0]?.label||n,i.options.some((i=>i.value===n&&(e[t]=i.label,!0))))}));const t=((e,t)=>{let n=e;e.includes("{")||(n="{"+n+"}");const i=((e,t)=>e.replace(/{\s*([^}\s]+)\s*}/g,((e,n)=>t[n.trim()]||e)))(n,t);return i.match(/{\s*([^}\s]+)\s*}/g)?"":i})(J,e);t&&(K=t)}const Z=((e,t)=>{const{hasTarget:n,isRequiredTarget:i}=t;return i&&n&&"trigger"!==e.target?.type&&!e.target?.value?{type:"no-target",message:(0,c.__)("Please select a target.","wp-interactions")}:null})(n,{hasTrigger:u,hasTarget:D,isRequiredTarget:B})||p,ee="selector"===n.target.type?(0,c.__)("elements","wp-interactions"):(0,c.__)("blocks","wp-interactions"),te="selector"===n.target.type?(0,c.__)("element","wp-interactions"):(0,c.__)("block","wp-interactions");return(0,e.createElement)("div",{className:I,"data-start":n.timing.start},(0,e.createElement)(o.__experimentalNumberControl,{className:r()("wpi-timeline__time-input",{"is--starting-state":n.timing.isStartingState}),spinControls:"none",size:"small",isDragEnabled:!1,type:n.timing.isStartingState?"text":"number",value:n.timing.isStartingState?"«":Q,onFocus:()=>f(),onChange:e=>{const t="time"===i?parseFloat(parseFloat(e).toFixed(2)):parseInt(e);if(!("percentage"===i&&(t<0||t>100)||"time"===i&&t<0)){if(n.timing.isStartingState&&(!isNaN(t)||""===e)){const i={...n};return i.timing.start=""===e?0:t,i.timing.isStartingState=!1,void g(i)}v(t||0)}},suffix:"time"===i?"":"%"}),(0,e.createElement)("div",{className:"wpi-timeline__dot"}),(0,e.createElement)("div",{className:r()("wpi-timeline__box",{[`wpi-timeline__box--${j}`]:j,"wpi-timeline__box--dragging":q,"wpi-timeline__box--has-warning":Z}),onMouseDown:e=>{E(e),Y||G||e.target.closest(".wpi-timeline__item")&&(s?m():d())},onKeyDown:e=>{k(e),Y||G||e.target.closest(".wpi-timeline__item")&&("Enter"!==e.key&&" "!==e.key||(s?m():d(),e.preventDefault()))},role:"button",tabIndex:"0",draggable:"true",onDragStart:e=>{e.dataTransfer.setDragImage(V.current,0,0),e.dataTransfer.setData("text/plain",n.key),m(),C(n),z(!0)},onDragEnd:()=>{C(!1),z(!1)},onDragOver:e=>{const t=V.current.getBoundingClientRect();e.clientY<t.top+t.height/2?W("top"):W("bottom")},onDragLeave:()=>{W(null)},onDrop:e=>{const t=e.dataTransfer.getData("text/plain");b(t,j),W(null)},ref:V,onMouseEnter:()=>{"block"===n.target.type&&""!==n.target.value&&setTimeout((()=>{(0,y.dispatch)("core/block-editor").clearSelectedBlock(),window?.dispatchEvent(new window.CustomEvent("wpi/highlight-block",{detail:{anchor:n.target.value}}))}))},onMouseLeave:()=>{"block"===n.target.type&&""!==n.target.value&&setTimeout((()=>{window?.dispatchEvent(new window.CustomEvent("wpi/highlight-block",{detail:{anchor:null}}))}))},onFocus:e=>{Y||G||S(e)}},Z&&(0,e.createElement)(o.Tooltip,{delay:0,text:Z.message},(0,e.createElement)(o.Dashicon,{icon:"warning"})),D?(0,e.createElement)("span",{className:"wpi-timeline__target"},"trigger"===n.target.type?(0,c.__)("Block","wp-interactions"):"window"===n.target.type?(0,c.__)("Window","wp-interactions"):"block-name"===n.target.type?n.target.value:n.target.blockName||n.target.value):(0,e.createElement)("div",null),(0,e.createElement)("span",{className:r()(["wpi-timeline__type",{"wpi-timeline__type--unknown":X}]),title:X?(0,c.__)("Unknown Action Type","wp-interactions"):void 0},K)),!A&&s&&(0,e.createElement)(o.Popover,{placement:"left",offset:8,noArrow:!!H&&void 0,className:"wpi-popover wpi-action-popover",onClose:H?Hn:m,ref:F,focusOnMount:!1},(0,e.createElement)(o.PanelBody,null,(0,e.createElement)(Ti,{alignItems:"start"},(0,e.createElement)(o.Dashicon,{icon:"warning"}),(0,e.createElement)("div",null,(0,e.createElement)("h4",{style:{marginTop:0}},(0,c.__)("Action configuration not found.","wp-interactions")),(0,e.createElement)("p",{style:{marginBottom:0}},(0,c.__)("What happened? Either the interaction contains invalid configuration, or this action is not available in your plan, or it has been removed from the plugin.","wp-interactions")))),(0,e.createElement)(Ti,null,(0,e.createElement)(o.Button,{variant:"tertiary",isDestructive:!0,icon:"trash",label:(0,c.__)("Remove action","wp-interactions"),style:{marginLeft:"auto"},onClick:h})))),!!A&&s&&(0,e.createElement)(o.Popover,{placement:"left",offset:8,noArrow:!!H&&void 0,className:"wpi-popover wpi-action-popover",onClose:H?Hn:m,ref:F,focusOnMount:!1},(0,e.createElement)("div",{style:{width:H?0:void 0,height:H?0:void 0,overflow:H?"hidden":void 0}},(0,e.createElement)(o.PanelBody,null,(0,e.createElement)(o.Button,{className:"wpi-add-action-popover__close-button",size:"small",variant:"tertiary",icon:"no-alt",label:(0,c.__)("Close Action","wp-interactions"),showTooltip:!1,onClick:()=>{m(),V.current.focus()},onKeyDown:e=>{"ArrowUp"!==e.key&&"ArrowDown"!==e.key||k(e)},ref:$}),(0,e.createElement)(Ti,{justifyContent:"start"},(0,e.createElement)("h4",{style:{margin:0}},A?.name||(0,c.__)("Unknown Action","wp-interactions")),(0,e.createElement)(ki,{buttonProps:Kn,onAddAction:e=>{const t=((e,t)=>{const n=_.actions[t],i=Object.keys(n.properties).reduce(((e,t)=>{const i=n.properties[t];return e[t]=i.default,e}),{});return Object.keys(i).forEach((t=>{void 0===e.value[t]&&(e.value[t]=i[t])})),{...e,type:t}})(n,e);g(t)}})),(0,e.createElement)("p",{style:{marginTop:8}},A?.description,(0,e.createElement)(o.Button,{className:"wpi-list-control__title-tip",icon:"info-outline",iconSize:"16",size:"small",variant:"tertiary",label:(0,c.__)("Learn more","wp-interactions"),onClick:()=>window?.open("https://docs.wpinteractions.com/article/574-what-are-the-types-of-actions","_docs")})),Object.keys(A?.properties||{}).map((t=>{const a=A.properties[t],r=n.value[t];if("percentage"===i&&A.provides.includes(t))return null;let o="time"===i&&A.hasDynamic;return n.timing.isStartingState&&(o=!1),(0,e.createElement)(M,{key:t,property:a,value:r,hasDynamic:o,stepProvidedValues:T,properties:n.value,onChange:e=>{const i={...n};Array.isArray(i.value)&&!i.length&&(i.value={}),i.value[t]=e,g(i)}})})),(0,e.createElement)(xi,null),D&&(0,e.createElement)(w.Fragment,null,(0,e.createElement)(li,{label:A.labelAppliedTo||(0,c.__)("Applied to","wp-interactions"),targets:A?.targets||null,assignBlockIdOnPick:!0,hasTrigger:u,anchor:L,offset:0,value:n.target,onChange:e=>{U(!1);const t={...n,target:{...n.target,...e}};"block-name"!==e.type&&"selector"!==e.type&&"class"!==e.type&&delete t.timing.stagger,g(t)},onBlockSelectClick:()=>U(!0),onBlockSelectDone:()=>U(!1)}),["selector","block-name","class"].includes(n.target.type)&&(0,e.createElement)(o.SelectControl,{label:(0,c.__)("Matching","wp-interactions"),labelPosition:"edge",options:[{label:(0,c.sprintf)((0,c.__)("All matching %s","wp-interactions"),ee),value:""},{label:(0,c.sprintf)((0,c.__)("Only match %s in the main content area","wp-interactions"),ee),value:"content-area"},{label:(0,c.sprintf)((0,c.__)("Only match %s that are not the interaction trigger","wp-interactions"),ee),value:"not-trigger"},{label:(0,c.sprintf)((0,c.__)("Only match %s that are children of the interaction trigger","wp-interactions"),ee),value:"children"},{label:(0,c.__)("Only match siblings of the interaction trigger","wp-interactions"),value:"siblings"},{label:(0,c.__)("Only match siblings and the interaction trigger","wp-interactions"),value:"siblings-with-trigger"},{label:(0,c.sprintf)((0,c.__)("Only match %s with the same parent as the interaction trigger","wp-interactions"),ee),value:"parent"},{label:(0,c.sprintf)((0,c.__)("Only match %s with the same index as the current interaction trigger","wp-interactions"),ee),value:"same-index",disabled:P},{label:(0,c.sprintf)((0,c.__)("Only match %s with the same index as the current interaction trigger including the trigger","wp-interactions"),ee),value:"same-index-with-trigger",disabled:P},{label:(0,c.sprintf)((0,c.__)("Only match %s that do not have the same index as the current interaction trigger","wp-interactions"),ee),value:"not-same-index",disabled:P},{label:(0,c.sprintf)((0,c.__)("Only match the first matching %s","wp-interactions"),te),value:"first",disabled:P},{label:(0,c.sprintf)((0,c.__)("Only match the last matching %s","wp-interactions"),te),value:"last",disabled:P}],value:n.target.options||"",onChange:e=>{const t={...n,target:{...n.target,options:e}};g(t)}}),"no-target"===Z?.type&&(0,e.createElement)("span",{className:"wpi-warning-text"},Z.message),(0,e.createElement)(xi,null)),P&&(0,e.createElement)(o.ToggleControl,{label:(0,c.__)("Set as starting state","wp-interactions"),checked:n.timing.isStartingState,onChange:e=>{const t={...n};t.timing.start=e?-1:0,t.timing.isStartingState=e,g(t)}}),!n.timing.isStartingState&&(0,e.createElement)(w.Fragment,null,"time"===i&&(0,e.createElement)(o.__experimentalNumberControl,{__unstableInputWidth:"90px",label:(0,c.__)("Starting Time","wp-interactions"),isShiftStepEnabled:!0,isDragEnabled:!0,labelPosition:"edge",shiftStep:.1,step:.01,min:0,disableUnits:!0,placeholder:"0.0",suffix:"s",value:n.timing.start,onChange:e=>{const t={...n},i=parseFloat(e);!isNaN(i)&&i>=0&&(t.timing.start=parseFloat(e),g(t))}}),"percentage"===i&&(0,e.createElement)(o.__experimentalNumberControl,{__unstableInputWidth:"90px",label:(0,c.__)("Position","wp-interactions"),isShiftStepEnabled:!0,isDragEnabled:!0,labelPosition:"edge",shiftStep:5,step:1,min:0,disableUnits:!0,placeholder:"0",suffix:"%",value:n.timing.start,onChange:e=>{const t={...n},i=parseInt(e);!isNaN(i)&&i>=0&&i<=100&&(t.timing.start=i,g(t))}}),N&&"time"===i&&(0,e.createElement)(o.__experimentalNumberControl,{__unstableInputWidth:"90px",label:(0,c.__)("Duration","wp-interactions"),isShiftStepEnabled:!0,isDragEnabled:!0,labelPosition:"edge",shiftStep:.1,step:.01,min:0,disableUnits:!0,placeholder:"0.5",suffix:"s",value:n.timing.duration,onChange:e=>{const t={...n};t.timing.duration=parseFloat(e),g(t)}}),O&&(0,e.createElement)(w.Fragment,null,(0,e.createElement)(Si,{columns:"custom"===n.timing.easing?"1fr 1fr":"1fr"},(0,e.createElement)(o.SelectControl,{labelPosition:"edge",label:(0,c.__)("Easing","wp-interactions"),value:n.timing.easing,onChange:e=>{const t={...n};t.timing.easing=e,g(t)}},(0,e.createElement)(x,null)),"custom"===n.timing.easing&&(0,e.createElement)(o.TextControl,{placeholder:(0,c.__)("linear","wp-interactions"),value:n.timing.customEasing,onChange:e=>{const t={...n};t.timing.customEasing=e,g(t)}})),"custom"===n.timing.easing&&(0,e.createElement)("p",{className:"wpi-timeline__easing-help"},(0,c.__)("Enter a custom easing value.","wp-interactions")," ",(0,e.createElement)("a",{href:"https://docs.wpinteractions.com/article/575-how-to-add-a-custom-easing-value",target:"_docs"},(0,c.__)("Learn more","wp-interactions")))),R&&("block-name"===n.target.type||"selector"===n.target.type||"class"===n.target.type)&&(0,e.createElement)(o.__experimentalNumberControl,{__unstableInputWidth:"90px",label:(0,c.__)("Stagger","wp-interactions"),isShiftStepEnabled:!0,isDragEnabled:!0,labelPosition:"edge",shiftStep:.1,step:.01,min:0,disableUnits:!0,placeholder:"0",suffix:"s",value:n.timing.stagger||0,onChange:e=>{const t={...n};t.timing.stagger=parseFloat(e),g(t)},help:(0,c.__)("Delays the animation for each element.","wp-interactions")})),(0,e.createElement)(Ti,null,(0,e.createElement)(o.Button,{variant:"tertiary",isDestructive:!0,icon:"trash",label:(0,c.__)("Remove action","wp-interactions"),style:{marginLeft:"auto"},onClick:h}))))))},Zn=t=>(0,e.createElement)("svg",{xmlns:"http://www.w3.org/2000/svg",height:"1em",viewBox:"0 0 512 512",...t},(0,e.createElement)("path",{d:"M462.6 232H368v48h94.6c-11 95.7-86.9 171.6-182.6 182.6V368h-48v94.6c-95.7-11-171.6-86.9-182.6-182.6H144v-48H49.4c11-95.7 86.9-171.6 182.6-182.6V144h48V49.4c95.7 11 171.6 86.9 182.6 182.6zM256 512a256 256 0 1 0 0-512 256 256 0 1 0 0 512z"})),ei=()=>{},ti=t=>{const{placement:n="left-start",offset:i=24,onClose:a=ei,onBlockSelect:s=ei,isSmall:l=!1,anchor:u=null}=t,{selectedClientId:p,blockName:d}=(0,y.useSelect)((e=>{const t=e("wpi/block-select").getSelectedClientId(),n=e("core/block-editor").getBlock(t);return{selectedClientId:t,blockName:n?.name||""}}));return(0,w.useEffect)((()=>((0,y.dispatch)("wpi/block-select").setSelectMode(!0),()=>{(0,y.dispatch)("wpi/block-select").setSelectMode(!1),(0,y.dispatch)("wpi/block-select").setSelectedClientId(null)})),[]),(0,e.createElement)(o.Popover,{className:"wpi-popover wpi-popover-block-picker",placement:n,offset:i,noArrow:!1,anchor:u},(0,e.createElement)(o.PanelBody,null,(0,e.createElement)(Ti,{className:r()({"wpi-picker--small":l}),justifyContent:"flex-end"},(0,e.createElement)("p",null,(0,c.__)("Please select a block in the editor area to add this interaction to.","wp-interactions")),(0,e.createElement)(o.Button,{variant:"primary",onClick:()=>{s(p,d)},disabled:!p},(0,c.__)("Select Block","wp-interactions")),(0,e.createElement)(o.Button,{variant:"secondary",onClick:a,onKeyDown:e=>{"Escape"===e.key&&a()}},(0,c.__)("Cancel","wp-interactions")))))},ni=["a","abbr","acronym","address","applet","area","article","aside","audio","b","base","basefont","bdi","bdo","bgsound","big","blink","blockquote","body","br","button","canvas","caption","center","cite","code","col","colgroup","command","content","data","datalist","dd","del","details","dfn","dialog","dir","div","dl","dt","element","em","embed","fieldset","figcaption","figure","font","footer","form","frame","frameset","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","iframe","image","img","input","ins","isindex","kbd","keygen","label","legend","li","link","listing","main","map","mark","marquee","menu","menuitem","meta","meter","nav","nobr","noembed","noframes","noscript","object","ol","optgroup","option","output","p","param","picture","plaintext","pre","progress","q","rp","rt","ruby","s","samp","script","section","select","shadow","slot","small","source","spacer","span","strike","strong","style","sub","summary","sup","table","tbody","td","template","textarea","tfoot","th","thead","time","title","tr","track","tt","u","ul","var","video","wbr"],ii=(e,t)=>{if("block"===e&&t)try{if(document?.querySelectorAll("#"+t).length>1)return{type:"duplicate-block-id",message:(0,c.__)("Multiple blocks with the same ID found. Please ensure that the ID is unique.","wp-interactions")}}catch(e){}return null};let ai=null;const ri=()=>{if(ai)return ai;const e=wp.blocks.getBlockTypes().reduce(((e,t)=>{if(!1!==t.supports?.className){const n=(0,f.startCase)(t.category)||(0,c.__)("Uncategorized","wp-interactions");e[n]||(e[n]=[]),e[n].push({label:`${t.title} (${t.name})`,value:t.name})}return e}),{});return Object.keys(e).forEach((t=>{e[t]=e[t].sort(((e,t)=>e.label<t.label?-1:e.label>t.label?1:0))})),ai=e,e},oi=t=>{const n=ri();return(0,e.createElement)(o.SelectControl,{label:(0,c.__)("Block","wp-interactions"),...t},Object.keys(n).map((t=>(0,e.createElement)("optgroup",{key:t,label:t},n[t].map((t=>(0,e.createElement)("option",{key:t.value,value:t.value},t.label)))))))},si=()=>{},li=t=>{const{label:n=(0,c.__)("Element Trigger","wp-interactions"),value:i={type:"block",value:""},targets:a=null,isHorizontal:r=!0,hasTrigger:s=!1,hasPickerPopover:l=!0,onChange:u=si,onBlockSelectClick:p=si,onBlockSelectDone:d=si,anchor:m=null,offset:h=24}=t,[g,_]=(0,w.useState)(!1),[v,b]=(0,w.useState)(null),E=(0,w.useRef)({}),k=(0,e.createElement)(e.Fragment,null,(0,e.createElement)(o.Button,{className:"wpi-target-block-button",icon:(0,e.createElement)(Zn,{width:"16",height:"16"}),variant:"secondary",ref:b,onClick:()=>{p(),l&&!g&&_(!0)}}),l&&g&&(0,e.createElement)(ti,{anchor:m||v,placement:"left",offset:h,isSmall:!0,onBlockSelect:(e,t)=>{const n={...i,blockName:t};let a="block"===i.type?"id":"class";"id"===a&&((0,y.select)("core/blocks").getBlockType(t)?.attributes?.anchor?n.value=Q(e,!0):a="class"),"class"===a&&(n.value=X(e,!0),n.type="class"),u(n),_(!1),d()},onClose:()=>{_(!1),d()}}));let S=r?"0.8fr 1fr":"1fr",C="top";"block"!==i.type&&"selector"!==i.type&&"block-name"!==i.type&&"class"!==i.type&&(S="1fr",C="edge");let T=[...s?[{value:"trigger",label:(0,c.__)("Interaction Trigger","wp-interactions")}]:[],{value:"block",label:(0,c.__)("Block","wp-interactions")},{value:"block-name",label:(0,c.__)("Block Name","wp-interactions")},{value:"class",label:(0,c.__)("CSS Class","wp-interactions")},{value:"selector",label:(0,c.__)("CSS Selector","wp-interactions")}];Array.isArray(a)&&a.length&&(T=a.map((e=>{if(!e.label){if("trigger"===e.value)return{...e,label:(0,c.__)("Interaction Trigger","wp-interactions")};if("block"===e.value)return{...e,label:(0,c.__)("Block","wp-interactions")};if("block-name"===e.value)return{...e,label:(0,c.__)("Block Name","wp-interactions")};if("class"===e.value)return{...e,label:(0,c.__)("CSS Class","wp-interactions")};if("selector"===e.value)return{...e,label:(0,c.__)("CSS Selector","wp-interactions")};if("window"===e.value)return{...e,label:(0,c.__)("Window","wp-interactions")};if("document"===e.value)return{...e,label:(0,c.__)("Document","wp-interactions")}}return e}))),s||(T=T.filter((e=>"trigger"!==e.value)));const[x,I]=(0,w.useState)(ii(i.type,i.value));return(0,w.useEffect)((()=>{const e=()=>{I((e=>{const t=ii(i.type,i.value);return(0,f.isEqual)(e,t)?e:t}))};e();const t=(0,y.subscribe)((0,f.throttle)(e,500));return()=>t()}),[i.type,i.value]),(0,e.createElement)(e.Fragment,null,(0,e.createElement)(Si,{columns:S,alignItems:"start"},(0,e.createElement)(o.SelectControl,{label:n,labelPosition:C,options:T,value:i.type,onChange:e=>{const t={...i,type:e};"block-name"===e&&(E.current[e]?t.value=E.current[e]:t.value=Object.values(ri())[0]?.[0]?.value||"core/button"),"block-name"!==e&&"block-name"===i.type&&E.current.other&&(t.value=E.current.other);const n="block-name"===i.type?"block-name":"other";E.current[n]=i.value,u(t)},id:"wpi-target-type-select"}),"block"===i.type&&(0,e.createElement)(Ti,{justifyContent:"start"},r&&k,(0,e.createElement)(o.TextControl,{id:"wpi-target-block-input",label:(0,c.__)("Block Anchor / ID","wp-interactions"),value:i.value,onChange:e=>u({...i,blockName:"",value:e}),onBlur:()=>{if(i.value){const e=i.value.replace(/^[.#]/,"");e!==i.value&&u({...i,value:e})}},placeholder:(0,c.__)("Select block or enter block anchor id","wp-interactions")}),!r&&k),"class"===i.type&&(0,e.createElement)(Ti,{justifyContent:"start"},r&&k,(0,e.createElement)(o.TextControl,{label:(0,c.__)("CSS Class","wp-interactions"),value:i.value,onChange:e=>u({...i,blockName:"",value:e}),onBlur:()=>{if(i.value){const e=i.value.replace(/^[.#]/,"");e!==i.value&&u({...i,value:e})}}}),!r&&k),"block-name"===i.type&&(0,e.createElement)(oi,{label:(0,c.__)("Block Name","wp-interactions"),value:i.value,onChange:e=>u({...i,value:e})}),"selector"===i.type&&(0,e.createElement)(o.TextControl,{label:(0,c.__)("CSS Selector","wp-interactions"),value:i.value,onChange:e=>u({...i,blockName:"",value:e})})),"trigger"===i.type&&(0,e.createElement)("label",{className:"wpi-target-selector__help",htmlFor:"wpi-target-type-select"},(0,c.__)("This action will be applied to the element that initially triggered the interaction.","wp-interactions")," ",(0,e.createElement)("a",{href:"https://docs.wpinteractions.com/article/573-what-is-the-element-picker",target:"_docs"},(0,c.__)("Learn more","wp-interactions"))),"block"===i.type&&(0,e.createElement)("label",{className:"wpi-target-selector__help",htmlFor:"wpi-target-block-input"},(0,c.__)("Enter the block id of the block that will trigger the interaction.","wp-interactions")," ",(0,e.createElement)("a",{href:"https://docs.wpinteractions.com/article/573-what-is-the-element-picker",target:"_docs"},(0,c.__)("Learn more","wp-interactions"))),"block-name"===i.type&&(0,e.createElement)("label",{className:"wpi-target-selector__help",htmlFor:"wpi-target-block-input"},(0,c.__)("Select the type of block that will trigger the interaction, this can match multiple blocks.","wp-interactions")," ",(0,e.createElement)("a",{href:"https://docs.wpinteractions.com/article/573-what-is-the-element-picker",target:"_docs"},(0,c.__)("Learn more","wp-interactions"))),"class"===i.type&&(0,e.createElement)("label",{className:"wpi-target-selector__help",htmlFor:"wpi-target-block-input"},(0,c.__)("Enter the class of the elements that will trigger the interaction, this can match multiple elements.","wp-interactions")," ",(0,e.createElement)("a",{href:"https://docs.wpinteractions.com/article/573-what-is-the-element-picker",target:"_docs"},(0,c.__)("Learn more","wp-interactions"))),"selector"===i.type&&(0,e.createElement)("label",{className:"wpi-target-selector__help",htmlFor:"wpi-target-block-input"},(0,c.__)("Enter the CSS selector of the elements that will trigger the interaction, this can match mutiple elements.","wp-interactions")," ",(0,e.createElement)("a",{href:"https://docs.wpinteractions.com/article/573-what-is-the-element-picker",target:"_docs"},(0,c.__)("Learn more","wp-interactions"))),"selector"===i.type&&(e=>{const t=e.match(/^([\d\w\-_]+)/),n=t?t[1]:null;return!!n&&!ni.includes(n.toLowerCase())})(i.value)&&(0,e.createElement)("label",{className:"wpi-target-selector__help wpi-target-selector__warn",htmlFor:"wpi-target-block-input"},(0,c.__)('You may have forgotten to add a "." or "#" in front of your selector.',"wp-interactions")),x&&(0,e.createElement)("span",{className:"wpi-warning-text"},x.message))},ci=()=>{},ui=()=>{window.dispatchEvent(new CustomEvent("wpi/timeline-restart-preview"))},pi={interaction:null,isDirty:!1},di=t=>{const{editMode:n="edit",onChange:i=ci,onClose:a=ci,onDelete:s=ci,initialDirty:l="new"===t.editMode,onDirtyChange:u=ci}=t,[p,d]=(0,w.useState)((()=>{return e=t.interaction,pi.interaction?.key===e.key?pi.interaction:(0,f.cloneDeep)(e);var e})),[m,h]=(0,w.useState)((()=>{return e=l,n=t.interaction,pi.interaction?.key===n.key?pi.isDirty:e;var e,n})),[g,y]=(0,w.useState)("idle"),v=(0,w.useRef)(),b=(0,w.useRef)(),E=(0,w.useRef)();(0,w.useEffect)((()=>{pi.interaction=p,pi.isDirty=m}),[p,m]),(0,w.useEffect)((()=>{pi.interaction?.key!==t.interaction.key&&(d((0,f.cloneDeep)(t.interaction)),h("new"===t.editMode||t.initialDirty))}),[t.interaction]),(0,w.useEffect)((()=>{u(m)}),[u,m]),(0,w.useEffect)((()=>{"new"===n&&v.current?v.current.focus():"edit"===n&&b.current&&b.current.focus()}),[n]),(0,w.useEffect)((()=>{const e=()=>{if(m)return event.preventDefault(),event.returnValue="d wqdwq"};return window.addEventListener("beforeunload",e,{capture:!0}),()=>window.removeEventListener("beforeunload",e,{capture:!0})}),[m]),(0,w.useLayoutEffect)((()=>{E.current?.parentElement&&(E.current.style.width=E.current.parentElement.clientWidth+"px")}),[]);const k=(e,t)=>{d((n=>{const i={...n};return i.timelines[e]={...i.timelines[e],...t},i})),h(!0)},S=_.interactions[p.type],C=(x=p,"element"!==S.type||x.target?.value?null:{type:"no-trigger",message:(0,c.__)("Error: This field is required. Please enter an interaction trigger.","wp-interactions")});var x;const I=(0,w.useCallback)((()=>{m?confirm((0,c.__)("Are you sure you want to discard your changes?","wp-interactions"))&&a(!0):a(!0)}),[m,a]),A=(0,w.useCallback)((()=>{confirm((0,c.__)("Are you sure you want to discard your changes?","wp-interactions"))&&a()}),[a]),D=(0,w.useCallback)((e=>{y("publishing"),i(p).then((()=>{y("idle"),h(!1),e&&setTimeout(e,1)}))}),[p,i]);return(0,w.useEffect)((()=>{const e=e=>{D(e.detail?.callback)};return window?.addEventListener("wpi/save-interaction",e),()=>{window?.removeEventListener("wpi/save-interaction",e)}}),[D]),(0,w.useEffect)((()=>{const e=()=>{"new"===n?A():I()};return window?.addEventListener("wpi/close-interaction",e),()=>{window?.removeEventListener("wpi/close-interaction",e)}}),[n,A,I]),(0,e.createElement)(e.Fragment,null,(0,e.createElement)("div",{className:"wpi-interaction-card-controls interface-complementary-area edit-post-sidebar",ref:E},(0,e.createElement)(o.Button,{variant:"secondary",icon:"arrow-left-alt2",label:(0,c.__)("Back","wp-interactions"),ref:b,onClick:"new"===n?A:I,onKeyDown:e=>{"Escape"===e.key&&(e.preventDefault(),e.stopPropagation(),"new"===n?A():I())},disabled:"idle"!==g,showTooltip:!1}),"edit"===n&&(0,e.createElement)(o.Button,{variant:"tertiary",isDestructive:!0,icon:"trash",label:(0,c.__)("Delete Interaction","wp-interactions"),onClick:()=>{confirm((0,c.__)("Are you sure you want to delete this interaction?","wp-interactions"))&&(y("deleting"),s().then((()=>{a()})))},isBusy:"deleting"===g,disabled:"idle"!==g}),(m||"new"===n)&&(0,e.createElement)(e.Fragment,null,(0,e.createElement)(o.Button,{isDestructive:!0,label:(0,c.__)("Discard Changes","wp-interactions"),onClick:"new"===n?A:()=>{confirm((0,c.__)("Are you sure you want to discard your changes?","wp-interactions"))&&(d((0,f.cloneDeep)(t.interaction)),h(!1))},disabled:"idle"!==g},(0,c.__)("Discard","wp-interactions")),(0,e.createElement)(o.Button,{variant:"primary",label:(0,c.__)("Save Changes","wp-interactions"),onClick:()=>{if("no-trigger"===C?.type){const e=document.querySelector(".wpi-panel-interaction-trigger");if(e)return e.classList.contains("is-opened")||e.querySelector("button").click(),e.scrollIntoView({behavior:"smooth",block:"center"}),void setTimeout((()=>{e.classList.add("wpi-panel-blink"),setTimeout((()=>{e?.classList.remove("wpi-panel-blink")}),1500)}),100)}D()},isBusy:"publishing"===g,disabled:"idle"!==g},(0,c.__)("Save","wp-interactions")))),(0,e.createElement)("div",{className:"wpi-interaction-card"},(0,e.createElement)("h2",null,"new"===n?(0,c.sprintf)((0,c.__)("New %s","wp-interactinos"),S.name):(0,c.sprintf)((0,c.__)("Editing %s","wp-interactinos"),S.name)),(0,e.createElement)("p",{className:"wpi-panel-description"},S.description),(0,e.createElement)(o.ToggleControl,{label:p.active?(0,c.__)("Active","wp-interactions"):(0,c.__)("Inactive","wp-interactions"),checked:p.active,className:r()("wpi-interaction__active-toggle",{"is-active":p.active}),onChange:e=>{d((t=>({...t,active:e}))),h(!0)}}),(0,e.createElement)(o.TextControl,{label:(0,c.__)("Interaction Name","wp-interactions"),ref:v,value:p.title,onChange:e=>{d((t=>({...t,title:e}))),h(!0)},placeholder:S.name})),S.options.length>0&&(0,e.createElement)(o.PanelBody,{title:(0,c.__)("Settings","wp-interactions"),initialOpen:!0},S.options.map((t=>{const{type:n,condition:i}=t,a={},r="number"===n?o.__experimentalNumberControl:"select"===n?o.SelectControl:"toggle"===n?o.ToggleControl:o.TextControl;if("toggle"===n&&(void 0!==p.options?.[t.name]?a.checked=p.options?.[t.name]:a.checked=t.placeholder||!1),i){const{option:e,value:t}=i,n=S.options.find((t=>t.name===e))?.placeholder;if((void 0!==p.options?.[e]?p.options?.[e]:n)!==t)return null}return(0,e.createElement)(r,{...t,key:t.name,value:p.options?.[t.name]||"",onChange:e=>{d((n=>({...n,options:{...n.options,[t.name]:e}}))),h(!0),ui()},...a})}))),S.timelines.map(((t,n)=>{const i=S.timelines[n],{onceOnly:a=!0,alwaysReset:r=!0}=i;return(0,e.createElement)(o.PanelBody,{key:n,title:t.title},t.description&&(0,e.createElement)("p",{className:"wpi-panel-description"},t.description),(0,e.createElement)(Qn,{type:S.timelineType,actions:p.timelines[n]?.actions||[],onChange:e=>((e,t)=>{d((n=>{const i={...n};return i.timelines[e]||(i.timelines[e]={}),i.timelines[e].actions=t,i.timelines[e].actions.sort(((e,t)=>e.timing.start-t.timing.start)),i})),h(!0)})(n,e),interaction:p,timelineIndex:n}),"time"===S.timelineType&&(0,e.createElement)(e.Fragment,null,(0,e.createElement)(xi,null),(0,e.createElement)("h4",null,(0,c.__)("Timeline Options","wp-interactions")),a&&(0,e.createElement)(o.ToggleControl,{label:(0,c.__)("Once only","wp-interactions"),checked:p.timelines[n]?.onceOnly||!1,onChange:e=>k(n,{onceOnly:e})}),r&&(0,e.createElement)(o.ToggleControl,{label:(0,c.__)("Always reset","wp-interactions"),checked:p.timelines[n]?.reset||!1,onChange:e=>k(n,{reset:e})}),(0,e.createElement)(o.ToggleControl,{label:(0,c.__)("Play reversed","wp-interactions"),checked:p.timelines[n]?.reverse||!1,onChange:e=>{k(n,{reverse:e}),ui()}}),(0,e.createElement)(o.ToggleControl,{label:(0,c.__)("Alternate","wp-interactions"),checked:p.timelines[n]?.alternate||!1,onChange:e=>{k(n,{alternate:e}),ui()}}),(0,e.createElement)(o.ToggleControl,{label:(0,c.__)("Loop","wp-interactions"),checked:p.timelines[n]?.loop||!1,onChange:e=>{k(n,{loop:e}),ui()}}),p.timelines[n]?.loop&&(0,e.createElement)(e.Fragment,null,(0,e.createElement)(o.__experimentalNumberControl,{__unstableInputWidth:"90px",label:(0,c.__)("Loop times","wp-interactions"),isShiftStepEnabled:!0,isDragEnabled:!0,labelPosition:"edge",shiftStep:5,step:1,min:1,disableUnits:!0,placeholder:(0,c.__)("Infinite","wp-interactions"),value:p.timelines[n]?.loopTimes,onChange:e=>{let t=parseInt(e);(isNaN(t)||t<1)&&(t=""),k(n,{loopTimes:t}),ui()}}),(0,e.createElement)(o.__experimentalNumberControl,{__unstableInputWidth:"90px",label:(0,c.__)("Loop delay","wp-interactions"),isShiftStepEnabled:!0,isDragEnabled:!0,labelPosition:"edge",shiftStep:.1,step:.01,min:0,disableUnits:!0,placeholder:"0.0",suffix:"s",value:p.timelines[n]?.loopDelay,onChange:e=>{let t=parseInt(e);isNaN(t)&&(t=0),k(n,{loopDelay:t}),ui()}})),(0,e.createElement)(xi,null),(0,e.createElement)(o.ToggleControl,{label:(0,c.__)("Debug Mode","wp-interactions"),help:(0,c.__)("Show debugging info in the frontend when this timeline plays.","wp-interactions"),checked:p.timelines[n]?.debug||!1,onChange:e=>{k(n,{debug:e}),ui()}})),"percentage"===S.timelineType&&(0,e.createElement)(e.Fragment,null,(0,e.createElement)(xi,null),(0,e.createElement)("h4",null,(0,c.__)("Timeline Options","wp-interactions")),(0,e.createElement)(o.ToggleControl,{label:(0,c.__)("Debug Mode","wp-interactions"),help:(0,c.__)("Show debugging info in the frontend when this timeline plays.","wp-interactions"),checked:p.timelines[n]?.debug||!1,onChange:e=>{k(n,{debug:e}),ui()}})))})),"element"===S.type&&(0,e.createElement)(o.PanelBody,{title:(0,c.__)("Interaction Trigger","wp-interactions"),initialOpen:!1,className:"wpi-panel-interaction-trigger"},C&&(0,e.createElement)("span",{className:"wpi-warning-text"},C.message),(0,e.createElement)(li,{isHorizontal:!1,assignBlockIdOnPick:!0,value:p.target,onChange:e=>{d((t=>({...t,target:e}))),h(!0)}})),(0,e.createElement)(o.PanelBody,{title:(0,c.__)("Location Rules","wp-interactions"),initialOpen:!1},(0,e.createElement)(T,{locations:p.locations,onChange:e=>{d((t=>{const n={...t};return n.locations=e,n})),h(!0)}})),(0,e.createElement)(o.PanelBody,null,(0,e.createElement)("em",{style:{fontSize:12}},(0,c.sprintf)((0,c.__)("Interaction key: %s","wp-interactions"),p.key))))},mi=()=>{},hi=(0,w.forwardRef)(((t,n)=>{const{onClick:i=mi,onDelete:a=mi,highlightEnabled:s=!1,interaction:l={},isHighlighted:u=!1}=t,[p,d]=(0,w.useState)(!1),[m,h]=(0,w.useState)(!1),[g,f]=(0,w.useState)(!!s&&u),y=ie();(0,w.useEffect)((()=>{s&&f(u)}),[u,s]),(0,w.useEffect)((()=>{if(s&&"block"===l.target.type){if(m)return setTimeout((()=>{window?.dispatchEvent(new window.CustomEvent("wpi/highlight-block",{detail:{anchor:l.target.value}}))})),()=>window?.dispatchEvent(new window.CustomEvent("wpi/highlight-block",{detail:{anchor:null}}));window?.dispatchEvent(new window.CustomEvent("wpi/highlight-block",{detail:{anchor:null}}))}}),[m,l.target.type,l.target.value,s]);const v=(_.interactions[l.type]?.name||l.type)+" / "+(l.timelines[0].actions.map((e=>_.actions[e.type]?.name||e.type)).join(", ")||(0,c.__)("None","wp-interactions")),b=r()("wpi-list__item-button",`wpi-list__item-button--${l.key}`,{"is--highlighted":g,"is--highlight-enabled":s,"is--inactive":!l.active});return(0,e.createElement)(o.Button,{className:b,ref:n,variant:"secondary",onClick:i,disabled:p,onMouseEnter:()=>h(!0),onMouseLeave:()=>h(!1)},s&&(0,e.createElement)("div",{className:"wpi-list__item-button__icon"}),(0,e.createElement)("div",{className:"wpi-list__item-button__grid-label"},(0,e.createElement)("div",{className:"wpi-list__item-button__title"},l.title),!l.active&&(0,e.createElement)("span",{className:"wpi-list__item-button__label"},(0,c.__)("inactive","wp-interactions")),(0,e.createElement)("div",{className:"wpi-list__item-button__bottom-line"},v)),(0,e.createElement)(o.Button,{variant:"tertiary",className:"wpi-list__item-button__delete",icon:"trash",size:"small",iconSize:"16",isDestructive:!0,isBusy:p,disabled:p,onClick:e=>{e.preventDefault(),e.stopPropagation(),d(!0),y||confirm((0,c.__)("Are you sure you want to delete this interaction? To delete without prompting, hold down the shift key when deleting.","wp-interactions"))?a():d(!1)}}))})),gi=t=>(0,e.createElement)("svg",{xmlns:"http://www.w3.org/2000/svg",height:"1em",viewBox:"0 0 448 512",...t},(0,e.createElement)("path",{d:"M0 88C0 39.4 39.4 0 88 0h360v400h-32v64h32v48H80c-44.2 0-80-35.8-80-80 0-2.7.1-5.4.4-8H0V88zm80 312c-17.7 0-32 14.3-32 32s14.3 32 32 32h288v-64H80zm-32-41.3c9.8-4.3 20.6-6.7 32-6.7h320V48H88c-22.1 0-40 17.9-40 40v270.7zM152 112h200v48H128v-48h24zm0 80h200v48H128v-48h24z"})),_i=()=>{},fi=t=>{const{offset:a=13,initialSelected:r="element",showPickerLabel:s=!1,title:l=(0,c.__)("Add Interaction","wp-interactions"),showInteractionPicker:u=!0,showElementOption:p=!0,showPageOption:d=!0,showLibraryOption:m=!0,showElementPicker:h=!0,onAddInteraction:g=_i,onClose:v=_i}=t,[b,E]=(0,w.useState)(r),[k,S]=(0,w.useState)(null),[C,T]=(0,w.useState)(!1),{getBlockNamesByClientId:x,getSelectedBlockClientId:I}=(0,y.useSelect)((e=>({getBlockNamesByClientId:e("core/block-editor").getBlockNamesByClientId,getSelectedBlockClientId:e("core/block-editor").getSelectedBlockClientId}))),[A,D]=(0,w.useState)({type:"block",value:Q(I(),!1)||"",blockName:(0,f.first)(x(I()))||""}),P=!p&&d?(0,c.__)("My Page Interactions","wp-interactions"):p&&!d?(0,c.__)("My Element Interactions","wp-interactions"):(0,c.__)("My Interactions","wp-interactions"),{interactions:N,interactionsFiltered:M}=ne(),{elementInteractions:O,pageInteractions:B}=N.reduce(((e,t)=>{const n=_.interactions[t.type];return n&&("element"===n?.type?e.elementInteractions.push(t):"page"===n?.type&&e.pageInteractions.push(t)),e}),{elementInteractions:[],pageInteractions:[]});return C?(0,e.createElement)(ti,{offset:a,flip:!0,variant:"toolbar",onBlockSelect:(e,t)=>{const n={...A,blockName:t};let i="block"===A?"id":"class";"id"===i&&((0,y.select)("core/blocks").getBlockType(t)?.attributes?.anchor?n.value=Q(e,!0):i="class"),"class"===i&&(n.value=X(e,!0),n.type="class"),D(n),T(!1)},onClose:()=>T(!1)}):(0,e.createElement)(o.Popover,{className:"wpi-popover wpi-add-interaction-popover",offset:a,onClose:v,flip:!0,variant:"toolbar"},(0,e.createElement)(o.PanelBody,null,(0,e.createElement)(o.Button,{className:"wpi-add-interaction-popover__close-button",size:"small",variant:"tertiary",icon:"no-alt",label:(0,c.__)("Close Action","wp-interactions"),showTooltip:!1,onClick:v}),(0,e.createElement)(Ti,{style:{marginBottom:"16px"},justifyContent:"start",gridGap:"0"},(0,e.createElement)("h4",{style:{margin:0}},l),(0,e.createElement)(o.Button,{className:"wpi-list-control__title-tip",icon:"info-outline",iconSize:"16",size:"small",variant:"tertiary",label:(0,c.__)("Learn more","wp-interactions"),onClick:()=>window?.open("https://docs.wpinteractions.com/article/571-what-are-interactions","_docs")})),u&&(0,e.createElement)(e.Fragment,null,(0,e.createElement)(o.__experimentalToggleGroupControl,{isBlock:!0,label:s?(0,c.__)("Pick the type of interaction to create","wp-interactions"):void 0,value:b,onChange:E},p&&(0,e.createElement)(o.__experimentalToggleGroupControlOption,{value:"element",label:(0,e.createElement)("div",{className:"wpi-add-interaction__option-label"},(0,e.createElement)(n,{width:"20",height:"20"}),(0,e.createElement)("h4",null,(0,c.__)("Element Interaction","wp-interactions")),(0,e.createElement)("p",null,(0,c.__)("Define actions that occur when user interacts with elements on your page","wp-interactions"))),onMouseEnter:()=>S((0,c.__)("Examples of element interactions: fade in element, tilt element to look at the mouse","wp-interactions")),onMouseLeave:()=>S(null)}),d&&(0,e.createElement)(o.__experimentalToggleGroupControlOption,{value:"page",label:(0,e.createElement)("div",{className:"wpi-add-interaction__option-label"},(0,e.createElement)(i,{width:"20",height:"20"}),(0,e.createElement)("h4",null,(0,c.__)("Page Interaction","wp-interactions")),(0,e.createElement)("p",null,(0,c.__)("Define actions that occur when there's a change in your page's state","wp-interactions"))),onMouseEnter:()=>S((0,c.__)("Examples of page interactions: display post meta, parallax scroll effect, scroll when url hash changes","wp-interactions")),onMouseLeave:()=>S(null)}),m&&(0,e.createElement)(o.__experimentalToggleGroupControlOption,{value:"library",label:(0,e.createElement)("div",{className:"wpi-add-interaction__option-label"},(0,e.createElement)(gi,{width:"20",height:"20"}),(0,e.createElement)("h4",null,P),(0,e.createElement)("p",null,(0,c.__)("Reuse interactions that you have previously created","wp-interactions"))),onMouseEnter:()=>S((0,c.__)("Duplicate, edit, and reuse interactions that you have previously created","wp-interactions")),onMouseLeave:()=>S(null)})),(0,e.createElement)("div",{style:{marginTop:"24px"}})),h&&"element"===b&&(0,e.createElement)(li,{value:A,onChange:D,hasPickerPopover:!1,onBlockSelectClick:()=>T(!0)}),(0,e.createElement)("div",{style:{marginTop:"24px"}}),("element"===b||"page"===b)&&(0,e.createElement)(e.Fragment,null,(0,e.createElement)("h4",null,(0,c.__)("Pick an Interaction","wp-interactions")),(0,e.createElement)("div",{className:"wpi-add-interaction-popover__interaction-list wpi-interaction-list"},_.interactionCategories[b].map((t=>(0,e.createElement)(o.MenuGroup,{key:t.name,label:t.name},t.interactions.map((t=>{const n=_.interactions[t];return(0,e.createElement)(o.MenuItem,{key:t,onClick:()=>{var e;"block"===A.type&&(e=A.value,Object.keys(G).some((t=>G[t]===e&&((0,y.dispatch)("core/block-editor").updateBlockAttributes(t,{anchor:e}),(0,y.dispatch)("wpi/interactions").setDidModifyPostContent(!0),delete G[t],!0)))),g(t,A),v()},onMouseEnter:()=>S(t),onMouseLeave:()=>S(null)},n?.name||t)}))))))),"library"===b&&(0,e.createElement)(e.Fragment,null,p&&!!O.length&&(0,e.createElement)(e.Fragment,null,(0,e.createElement)("h4",{className:"components-menu-group__label"},(0,c.__)("Your Element Interactions","wp-interactions")),(0,e.createElement)("div",{className:"wpi-add-interaction-popover__interaction-list wpi-add-interaction-popover__interaction-list-2"},O.map((t=>{const n=!!M.find((e=>e.key===t.key));return(0,e.createElement)(Ti,{className:"wpi-popover-interaction-item components-button components-menu-item__button",alignItems:"center",key:t.key},(0,e.createElement)("span",{onMouseEnter:()=>S(n?(0,c.__)("This interaction is already in this post, edit or duplicate this interaction","wp-interactions"):(0,c.__)("Add this interaction to this post or duplicate this interaction","wp-interactions")),onMouseLeave:()=>S(null)},t.title),(0,e.createElement)(o.Button,{label:(0,c.__)("Add interaction to this post","wp-interactions"),icon:"plus-alt2",variant:"secondary",size:"small",iconSize:16,onMouseEnter:()=>S((0,c.__)("A new Location Rule will be added to this interaction","wp-interactions")),onMouseLeave:()=>S(null),disabled:n,onClick:()=>{const e=(0,f.cloneDeep)(t),n=z();e.locations.push([n]),K(),window.dispatchEvent(new window.CustomEvent("wpi/edit-interaction",{detail:{interaction:e,initialDirty:!0}})),v()}}),(0,e.createElement)(o.Button,{label:(0,c.__)("Edit interaction","wp-interactions"),icon:"edit",variant:"secondary",size:"small",iconSize:16,onMouseEnter:()=>S((0,c.__)("Edit this interaction","wp-interactions")),onMouseLeave:()=>S(null),onClick:()=>{K(),window.dispatchEvent(new window.CustomEvent("wpi/edit-interaction",{detail:{key:t.key}})),v()}}),(0,e.createElement)(o.Button,{label:(0,c.__)("Duplicate interaction","wp-interactions"),icon:"admin-page",variant:"secondary",size:"small",iconSize:16,onMouseEnter:()=>S((0,c.__)("This interaction will be duplicated into a new interaction","wp-interactions")),onMouseLeave:()=>S(null),onClick:()=>{const e=z(),n=H(t,{active:!0,locations:[[e]]});K(),window.dispatchEvent(new window.CustomEvent("wpi/edit-interaction",{detail:{interaction:n,editMode:"new"}})),v()}}))})))),p&&d&&!!O.length&&(0,e.createElement)("div",{style:{marginTop:"24px"}}),d&&!!B.length&&(0,e.createElement)(e.Fragment,null,(0,e.createElement)("h4",{className:"components-menu-group__label"},(0,c.__)("Your Page Interactions","wp-interactions")),(0,e.createElement)("div",{className:"wpi-add-interaction-popover__interaction-list wpi-add-interaction-popover__interaction-list-2"},B.map((t=>{const n=!!M.find((e=>e.key===t.key));return(0,e.createElement)(Ti,{className:"wpi-popover-interaction-item components-button components-menu-item__button",alignItems:"center",key:t.key},(0,e.createElement)("span",{onMouseEnter:()=>S(n?(0,c.__)("This interaction is already in this post, edit or duplicate this interaction","wp-interactions"):(0,c.__)("Add this interaction to this post or duplicate this interaction","wp-interactions")),onMouseLeave:()=>S(null)},t.title),(0,e.createElement)(o.Button,{label:(0,c.__)("Add interaction to this post","wp-interactions"),icon:"plus-alt2",variant:"secondary",size:"small",iconSize:16,onMouseEnter:()=>S((0,c.__)("A new Location Rule will be added to this interaction","wp-interactions")),onMouseLeave:()=>S(null),disabled:n,onClick:()=>{const e=(0,f.cloneDeep)(t),n=z();e.locations.push([n]),K(),window.dispatchEvent(new window.CustomEvent("wpi/edit-interaction",{detail:{interaction:e,initialDirty:!0}})),v()}}),(0,e.createElement)(o.Button,{label:(0,c.__)("Edit interaction","wp-interactions"),icon:"edit",variant:"secondary",size:"small",iconSize:16,onMouseEnter:()=>S((0,c.__)("Edit this interaction","wp-interactions")),onMouseLeave:()=>S(null),onClick:()=>{K(),window.dispatchEvent(new window.CustomEvent("wpi/edit-interaction",{detail:{key:t.key}})),v()}}),(0,e.createElement)(o.Button,{label:(0,c.__)("Duplicate interaction","wp-interactions"),icon:"admin-page",variant:"secondary",size:"small",iconSize:16,onMouseEnter:()=>S((0,c.__)("This interaction will be duplicated into a new interaction","wp-interactions")),onMouseLeave:()=>S(null),onClick:()=>{const e=z(),n=H(t,{active:!0,locations:[[e]]});K(),window.dispatchEvent(new window.CustomEvent("wpi/edit-interaction",{detail:{interaction:n,editMode:"new"}})),v()}}))})))),p&&d&&!N.length&&(0,e.createElement)("p",{className:"wpi-add-interaction-popover__empty-note"},(0,c.__)("You don't have any interactions yet","wp-interactions")),p&&!d&&!O.length&&(0,e.createElement)("p",{className:"wpi-add-interaction-popover__empty-note"},(0,c.__)("You don't have any element interactions yet","wp-interactions")),!p&&d&&!B.length&&(0,e.createElement)("p",{className:"wpi-add-interaction-popover__empty-note"},(0,c.__)("You don't have any page interactions yet","wp-interactions")),(p||d)&&N.length&&(0,e.createElement)(o.Button,{variant:"secondary",href:_.manageInteractionsUrl,target:"_manage",style:{marginTop:"16px",width:"100%",justifyContent:"center"}},(0,c.__)("Manage all your interactions","wp-interacitons"))),(0,e.createElement)(e.Fragment,null,(0,e.createElement)("div",{style:{marginTop:"16px"}}),(0,e.createElement)(Ti,{className:"wpi-popover-help",justifyContent:"start"},(0,e.createElement)(o.Dashicon,{icon:"info-outline"})," ",k?_.interactions[k]?.description||k:(0,c.__)("Hover over an interaction to show a description of what it is","wp-interactions")))))},wi=()=>{},yi=t=>{const{type:n="element",onAddInteraction:i=wi}=t,[a,r]=(0,w.useState)(!1);return(0,e.createElement)("div",null,(0,e.createElement)(o.Button,{icon:"plus-alt2",label:(0,c.__)("Add Interaction","wp-interactions"),onClick:()=>r((e=>!e)),onMouseDown:e=>e.preventDefault(),onKeyDown:e=>{"Enter"!==e.key&&" "!==e.key||(r((e=>!e)),e.preventDefault())}}),a&&(0,e.createElement)(fi,{showPageOption:"page"===n,showElementOption:"element"===n,initialSelected:n,onAddInteraction:i,onClose:()=>r(!1)}))},vi=()=>{},bi=[],Ei=[];_.actionCategories.forEach((e=>{e.actions.forEach((e=>{const{type:t}=_.actions[e];"time"!==t&&"all"!==t||bi.push(e),"percentage"!==t&&"all"!==t||Ei.push(e)}))}));const ki=t=>{const{onAddAction:n=vi,onClick:i=vi,type:a="time",buttonProps:s={}}=t,[l,u]=(0,w.useState)(!1),[p,d]=(0,w.useState)(""),[m,h]=(0,w.useState)(null),g=(0,w.useRef)(),y=(0,w.useRef)(),[v,b]=(0,w.useState)((0,f.cloneDeep)("time"===a?bi:Ei)),[E,k]=(0,w.useState)(-1),S=()=>{u(!1),g.current.focus()};return(0,w.useEffect)((()=>{d(""),l&&setTimeout((()=>y.current.focus()),1)}),[l]),(0,w.useEffect)((()=>{let e=(0,f.cloneDeep)("time"===a?bi:Ei);p&&(e=e.filter((e=>{const{name:t,keywords:n}=_.actions[e];return t.toLowerCase().includes(p.toLowerCase())||n.some((e=>e.toLowerCase().includes(p.toLowerCase())))}))),b(e),k(p&&e.length?0:null)}),[p,a]),(0,e.createElement)("div",null,(0,e.createElement)(o.Button,{label:(0,c.__)("Add Action","wp-interactions"),icon:"plus-alt2",ref:g,...s,onClick:()=>{u((e=>!e)),i()},onMouseDown:e=>e.preventDefault(),onKeyDown:e=>{"Enter"!==e.key&&" "!==e.key||(u((e=>!e)),i(),e.preventDefault())}}),l&&(0,e.createElement)(o.Popover,{className:r()("wpi-popover","wpi-action-list-popover"),placement:"left",onClose:S,focusOnMount:!1},(0,e.createElement)(o.PanelBody,null,(0,e.createElement)(o.Button,{className:"wpi-add-action-popover__close-button",size:"small",variant:"tertiary",icon:"no-alt",label:(0,c.__)("Cancel","wp-interactions"),showTooltip:!1,onClick:S}),(0,e.createElement)(Ti,{style:{marginBottom:"16px"},justifyContent:"start",gridGap:"0"},(0,e.createElement)("h4",{style:{margin:0}},(0,c.__)("Add Action","wp-interactions")),(0,e.createElement)(o.Button,{className:"wpi-list-control__title-tip",icon:"info-outline",iconSize:"16",size:"small",variant:"tertiary",label:(0,c.__)("Learn more","wp-interactions"),onClick:()=>window?.open("https://docs.wpinteractions.com/article/572-what-is-an-action","_docs")})),(0,e.createElement)(o.TextControl,{label:(0,c.__)("Search actions","wp-interactions"),hideLabelFromVision:!0,placeholder:(0,c.__)("Search actions","wp-interactions"),value:p,ref:y,onChange:e=>{d(e)},onKeyDown:e=>{"Enter"===e.key&&-1!==E?(n(v[E]),u(!1)):"ArrowDown"===e.key?(e.preventDefault(),k((e=>null===e||e+1>v.length-1?0:e+1))):"ArrowUp"===e.key&&(e.preventDefault(),k((e=>null===e||e-1<0?v.length-1:e-1)))}}),(0,e.createElement)("div",{style:{marginTop:"24px"}}),(0,e.createElement)("div",{className:"wpi-action-list-wrapper wpi-interaction-list"},_.actionCategories.map((t=>t.actions.reduce(((e,t)=>(("time"===a?bi:Ei).includes(t)&&e++,e)),0)?(0,e.createElement)(o.MenuGroup,{key:t.name,label:t.name},t.actions.map((t=>{if(!("time"===a?bi:Ei).includes(t))return null;const i=v.includes(t),s=-1!==E&&v.indexOf(t)===E;return(0,e.createElement)(o.MenuItem,{key:t,className:r()("wpi-action-list-item",{"wpi-action-list-item--focused":s}),onClick:()=>{n(t),u(!1)},style:{opacity:p&&i?1:p?.3:1,fontWeight:p&&i?"bold":"normal"},onMouseEnter:()=>h(t),onMouseLeave:()=>h(null)},_.actions[t].name,"time"===a&&!(0,f.isEmpty)(_.actions[t].provides)&&(0,e.createElement)("span",{className:"wpi-action-list-item-data"},(0,c.__)("data","wp-interactions")))}))):null))),(0,e.createElement)("div",{style:{marginTop:"24px"}}),(0,e.createElement)(Ti,{className:"wpi-popover-help",justifyContent:"start"},(0,e.createElement)(o.Dashicon,{icon:"info-outline"})," ",m?_.actions[m].description:(0,c.__)("Hover over an action to show a description of what it does","wp-interactions")))))},Si=t=>{const{columns:n,alignItems:i="center",...a}=t;return(0,e.createElement)("div",{...a,style:{display:"grid",gridGap:"8px",gridTemplateColumns:n||"1fr 1fr",alignItems:i}})},Ci={},Ti=t=>{const{justifyContent:n="space-between",alignItems:i="center",gridGap:a="8px",style:r=Ci,...o}=t;return(0,e.createElement)("div",{...o,style:{display:"flex",justifyContent:n,alignItems:i,gridGap:a,...r}})},xi=()=>(0,e.createElement)("div",{style:{height:"1px",backgroundColor:"#ddd",margin:"16px -16px"}}),Ii=wp.plugins,Ai=(0,F.createHigherOrderComponent)((n=>i=>{const[a,r]=(0,w.useState)(!1),l=(0,y.useSelect)((e=>!!e("core/blocks").getBlockType(i.name)?.attributes?.anchor),[i.name]),{interactions:u,deleteInteraction:p}=ne(),d=(_=i.attributes.anchor,(0,y.useSelect)((e=>e("wpi/interactions").getInteractions().filter((t=>te(t,e))).reduce(((e,t)=>("block"===t.target.type&&t.target.value===_&&e.push(t.key),e)),[])),[_])),m=d.length?"select":"add",[h,g]=(0,w.useState)(m);var _;if((0,w.useEffect)((()=>{g(d.length?"select":"add")}),[i.attributes.anchor,d.length]),(0,w.useEffect)((()=>{a||g(m)}),[a,m]),(0,w.useEffect)((()=>{i.isSelected||r(!1)}),[i.isSelected]),!(0,y.dispatch)("core/edit-post")&&!(0,y.dispatch)("core/edit-site"))return(0,e.createElement)(n,{...i});if(!l)return(0,e.createElement)(n,{...i});const f=0===d.length?(0,c.__)("Add interaction to block","wp-interactions"):(0,c.__)("Add or view interactions","wp-interactions");return(0,e.createElement)(e.Fragment,null,(0,e.createElement)(n,{...i}),(0,e.createElement)(s.BlockControls,null,(0,e.createElement)(o.ToolbarGroup,null,(0,e.createElement)(o.ToolbarButton,{icon:(0,e.createElement)(t,{width:"20",height:"20"}),title:f,onClick:()=>r((e=>!e)),onMouseDown:e=>e.preventDefault(),onKeyDown:e=>{"Enter"!==e.key&&" "!==e.key||(r((e=>!e)),e.preventDefault())},isActive:!!d.length}),a&&"add"===h&&(0,e.createElement)(fi,{title:(0,c.__)("Add Element Interaction for this Block","wp-interactions"),showInteractionPicker:!1,showElementPicker:!1,onAddInteraction:e=>{K();const t=Q(i.clientId);window.dispatchEvent(new window.CustomEvent("wpi/add-interaction",{detail:{type:e,target:{type:"block",value:t,blockName:i.name}}}))},onClose:()=>r(!1)}),a&&"select"===h&&(0,e.createElement)(o.Popover,{className:"wpi-block-toolbar-button__select-popover",offset:13,flip:!0,variant:"toolbar"},(0,e.createElement)(o.PanelBody,null,(0,e.createElement)(o.Button,{className:"wpi-block-toolbar-button__select-popover__add-button",variant:"secondary",onClick:()=>g("add"),iconPosition:"right"},(0,c.__)("Add new interaction to block","wp-interactions")," ",(0,e.createElement)(o.Dashicon,{icon:"arrow-right-alt2"})),(0,e.createElement)("div",{style:{marginTop:"24px"}}),(0,e.createElement)(o.BaseControl,{label:(0,c.__)("Edit current interactions","wp-interactions")},d.map((t=>(0,e.createElement)(hi,{key:t,interaction:u.find((e=>e.key===t)),onClick:()=>{K(),window.dispatchEvent(new window.CustomEvent("wpi/edit-interaction",{detail:{key:t}})),r(!1)},onDelete:()=>{window.dispatchEvent(new window.CustomEvent("wpi/close-interaction")),p(t)}})))))))))}),"withBlockToolbarButton");(0,l.addFilter)("editor.BlockEdit","wpi/block-toolbar-button",Ai);const Di=()=>{const[n,i]=(0,w.useState)(!1);return(0,e.createElement)(e.Fragment,null,(0,e.createElement)(o.ToolbarButton,{onClick:()=>i((e=>!e)),onMouseDown:e=>e.preventDefault(),onKeyDown:e=>{"Enter"!==e.key&&" "!==e.key||(i((e=>!e)),e.preventDefault())},className:"ugb-insert-library-button",icon:(0,e.createElement)(t,{width:"20",height:"20"})},(0,c.__)("Interactions","wp-interactions")),n&&(0,e.createElement)(fi,{title:(0,c.__)("WP Interactions","wp-interactions"),initialSelected:"",showPickerLabel:!0,onAddInteraction:(e,t)=>{K(),window.dispatchEvent(new window.CustomEvent("wpi/add-interaction",{detail:{type:e,target:t}}))},onClose:()=>i(!1)}))};J((()=>{const t=document.createElement("div");t.classList.add("wpi-add-interaction-button-wrapper"),(0,w.createRoot)(t).render((0,e.createElement)(Di,null)),(0,y.subscribe)((()=>{setTimeout((()=>{const e=document.querySelector(".edit-post-header-toolbar");if(e&&!e.querySelector(".wpi-add-interaction-button-wrapper")){const n=e.querySelector(".ugb-insert-library-button__wrapper");n?n.after(t):e.appendChild(t)}}),100)}))}));const Pi=(0,F.createHigherOrderComponent)((t=>n=>{const[i,a]=(0,w.useState)(!1);(0,w.useEffect)((()=>{const e=e=>{n.attributes.anchor&&e.detail.anchor===n.attributes.anchor?a(!0):a(!1)};return window?.addEventListener("wpi/highlight-block",e),()=>{window?.removeEventListener("wpi/highlight-block",e),a(!1)}}),[n.attributes.anchor]);const r=(0,y.useSelect)((e=>i?e("core/blocks").getBlockType(n.name).title:""),[n.name,i]);return i?(0,e.createElement)(e.Fragment,null,(0,e.createElement)(t,{...n}),(0,e.createElement)("style",null,`.editor-styles-wrapper [data-block="${n.clientId}"] {\n\t\t\t\t\t\t\toutline: 1px solid #05f;\n\t\t\t\t\t\t\toutline-offset: 2px;\n\t\t\t\t\t\t}\n\t\t\t\t\t\t.editor-styles-wrapper [data-block="${n.clientId}"]::before {\n\t\t\t\t\t\t\tall: reset;\n\t\t\t\t\t\t\tcontent: "${r.replace(/"/g,'\\"')}";\n\t\t\t\t\t\t\tposition: absolute;\n\t\t\t\t\t\t\ttop: 100%;\n\t\t\t\t\t\t\ttransform: translateY(2px);\n\t\t\t\t\t\t\tleft: -3px;\n\t\t\t\t\t\t\tcolor: #fff;\n\t\t\t\t\t\t\tbackground: #05f;\n\t\t\t\t\t\t\tpadding: 4px 8px;\n\t\t\t\t\t\t\tfont-size: 12px !important;\n\t\t\t\t\t\t\tz-index: 2;\n\t\t\t\t\t\t\tfont-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen-Sans, Ubuntu, Cantarell, "Helvetica Neue", sans-serif !important;\n\t\t\t\t\t\t\tline-height: 1 !important;\n\t\t\t\t\t\t\tletter-spacing: normal !important;\n\t\t\t\t\t\t\tfont-weight: normal !important;\n\t\t\t\t\t\t\tfont-style: normal !important;\n\t\t\t\t\t\t}`)):(0,e.createElement)(t,{...n})}),"withBlockHighlight");(0,l.addFilter)("editor.BlockEdit","wpi/block-highlight",Pi);const Ni={selectMode:!1,selectedClientId:null};(0,y.register)((0,y.createReduxStore)("wpi/block-select",{reducer:(e=Ni,t)=>{switch(t.type){case"SET_MODE":return t.selectMode?document?.body?.classList?.add("wpi-block-select-mode"):document?.body?.classList?.remove("wpi-block-select-mode"),{...e,selectMode:t.selectMode};case"SET_SELECTED_CLIENT_ID":return{...e,selectedClientId:t.selectedClientId};default:return e}},actions:{setSelectMode:e=>({type:"SET_MODE",selectMode:e}),setSelectedClientId:e=>({type:"SET_SELECTED_CLIENT_ID",selectedClientId:e})},selectors:{getSelectMode:e=>e.selectMode,getSelectedClientId:e=>e.selectedClientId}}));const Mi=(0,F.createHigherOrderComponent)((t=>n=>{const{selectMode:i,blockName:a}=(0,y.useSelect)((e=>{if(!n.isSelected)return{};const t=e("wpi/block-select").getSelectMode();return{selectMode:t,blockName:t?n.name:""}}),[n.name,n.isSelected]);return(0,w.useEffect)((()=>{i?setTimeout((()=>(0,y.dispatch)("wpi/block-select").setSelectedClientId(n.clientId))):(0,y.dispatch)("wpi/block-select").setSelectedClientId(null)}),[n.clientId,i]),i?(0,e.createElement)(e.Fragment,null,(0,e.createElement)(t,{...n}),(0,e.createElement)("style",null,`.editor-styles-wrapper [data-block="${n.clientId}"] {\n\t\t\t\t\t\t\toutline: 1px solid #05f !important;\n\t\t\t\t\t\t\toutline-offset: 2px !important;\n\t\t\t\t\t\t\ttransition: none !important;\n\t\t\t\t\t\t}\n\t\t\t\t\t\t.editor-styles-wrapper [data-block="${n.clientId}"]:hover {\n\t\t\t\t\t\t\toutline: 1px solid #05f !important;\n\t\t\t\t\t\t\toutline-offset: 2px !important;\n\t\t\t\t\t\t\ttransition: none !important;\n\t\t\t\t\t\t}\n\t\t\t\t\t\t.editor-styles-wrapper [data-block="${n.clientId}"]::before {\n\t\t\t\t\t\t\tall: reset;\n\t\t\t\t\t\t\tcontent: "${a}";\n\t\t\t\t\t\t\tposition: absolute;\n\t\t\t\t\t\t\ttop: 100%;\n\t\t\t\t\t\t\ttransform: translateY(2px);\n\t\t\t\t\t\t\tleft: -3px;\n\t\t\t\t\t\t\tcolor: #fff;\n\t\t\t\t\t\t\tbackground: #05f;\n\t\t\t\t\t\t\tpadding: 4px 8px;\n\t\t\t\t\t\t\tfont-size: 12px !important;\n\t\t\t\t\t\t\tz-index: 2;\n\t\t\t\t\t\t\tfont-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen-Sans, Ubuntu, Cantarell, "Helvetica Neue", sans-serif !important;\n\t\t\t\t\t\t\tline-height: 1 !important;\n\t\t\t\t\t\t\tletter-spacing: normal !important;\n\t\t\t\t\t\t\tfont-weight: normal !important;\n\t\t\t\t\t\t\tfont-style: normal !important;\n\t\t\t\t\t\t}`)):(0,e.createElement)(t,{...n})}),"withBlockSelect");(0,l.addFilter)("editor.BlockEdit","wpi/block-select",Mi);(0,Ii.registerPlugin)("wpi-editor",{render:()=>{const a=window.wp.editSite?.PluginSidebar,r=window.wp.editPost?.PluginSidebar,s=a||r||null,l=(0,y.useSelect)((e=>{const t=e("core/block-editor").getSelectedBlockClientId();return t?e("core/block-editor").getBlockAttributes(t)?.anchor:null})),[u,p]=(0,w.useState)(null),[d,m]=(0,w.useState)({}),[h,g]=(0,w.useState)("edit"),[v,b]=(0,w.useState)(!0),E=(0,w.useRef)(),k=(0,w.useRef)(!1),{interactions:S,interactionsFiltered:C,loadingError:T,updateInteraction:x,deleteInteraction:I}=ne();(e=>{const t=(0,w.useRef)(!1);(0,w.useEffect)((()=>{if(!document.querySelector(".interface-interface-skeleton__header"))return;const n=new MutationObserver((()=>{if(!t.current){const n=document.querySelector(".editor-preview-dropdown__button-external");if(!n)return;t.current=!0;const i=t=>{const a=n.cloneNode(!0);e((()=>a.click()))&&(n.removeEventListener("click",i),t.stopImmediatePropagation(),t.preventDefault())};n.addEventListener("click",i)}}));n.observe(document.body,{childList:!0,subtree:!0});const i=document.querySelector(".editor-post-publish-button__button"),a=t=>{e((()=>i.click()))&&(t.stopImmediatePropagation(),t.preventDefault())};return i&&i.addEventListener("click",a),()=>{n.disconnect(),i?.removeEventListener("click",a)}}),[e])})((e=>{if(k.current&&confirm((0,c.__)("You have unsaved changes in your interaction. Do you want to save it before continuing?","wp-interactions")))return window?.dispatchEvent(new CustomEvent("wpi/save-interaction",{detail:{callback:e}})),!0}));const A=(0,w.useCallback)((e=>S.find((t=>t.key===e))),[S]),D=(0,w.useCallback)(((e,t=null)=>{if(u&&k.current)return void alert((0,c.__)("You currently editing an interaction, please save or discard your changes first.","wp-interactions"));g("new");const n=((e,t=null)=>{const n=L("1234567890abcdef",10),i=_.interactions[e];let a=i.name;if("block"===t?.type&&""!==t?.value){const e=(e=>{let t=null;const n=i=>{t||i.some((i=>i.attributes.anchor===e?(t=i.name,!0):(i.innerBlocks.length&&n(i.innerBlocks),!1)))};return n((0,y.select)("core/block-editor").getBlocks()),t})(t.value);if(e){const t=(0,y.select)("core/blocks").getBlockType(e).title;a=(0,c.sprintf)((0,c.__)("%s %s","wp-interactions"),t,i.name)}}return{key:`interaction_${n(10)}`,title:q((0,f.startCase)(a)),active:!0,type:e,target:t||{type:"block",value:""},timelines:(0,f.range)(i.timelines.length).map((()=>({loop:!1,onceOnly:!1,alternate:!1,reset:!1,reverse:!1,actions:[]}))),options:{},locations:[[{...z()}]]}})(e,t);p(n)}),[u]),P=(0,w.useCallback)(((e,t)=>{u&&k.current?alert((0,c.__)("You currently editing an interaction, please save or discard your changes first.","wp-interactions")):(void 0!==t.editMode&&g(t.editMode),m(t),p("string"==typeof e?A(e):e))}),[A,u]);(0,w.useEffect)((()=>{const e=e=>{D(e.detail.type,e.detail.target)},t=e=>{const{key:t,interaction:n,...i}=e.detail;P(t||n,i)};return window?.addEventListener("wpi/add-interaction",e),window?.addEventListener("wpi/edit-interaction",t),()=>{window?.removeEventListener("wpi/add-interaction",e),window?.removeEventListener("wpi/edit-interaction",t)}}),[D,P]),(0,w.useEffect)((()=>{u||m({})}),[u]),(0,w.useEffect)((()=>{const e=JSON.parse(localStorage.getItem("wpi-dismissed-errors")||"[]"),t=T?.interactionKey;T?.interactionKey&&(e.includes(t)?b(!1):b(!0))}),[T]);const{elementInteractions:N,pageInteractions:M}=C.reduce(((e,t)=>{const n=_.interactions[t.type];return"element"===n?.type?e.elementInteractions.push(t):"page"===n?.type&&e.pageInteractions.push(t),e}),{elementInteractions:[],pageInteractions:[]});return s?(0,e.createElement)(s,{name:"sidebar",title:(0,c.__)("WP Interactions","wp-interactions"),className:"wpi-sidebar",icon:(0,e.createElement)(t,{width:"20",height:"20"})},null===u&&T&&v&&(0,e.createElement)(o.PanelBody,null,(0,e.createElement)(o.Notice,{status:"error",onDismiss:()=>b(!1),isDismissible:!1},(0,e.createElement)("p",null,T.message),(0,e.createElement)("p",null,(0,c.__)("Check the browser console for more details.","wp-interactions")),(0,e.createElement)("div",{className:"wpi-dismiss-button-container"},(0,e.createElement)(o.Button,{className:"wpi-dismiss-button",variant:"secondary",size:"small",onClick:()=>{const e=JSON.parse(localStorage.getItem("wpi-dismissed-errors")||"[]"),t=T?.interactionKey;localStorage.setItem("wpi-dismissed-errors",JSON.stringify([...e,t])),b(!1)}},(0,c.__)("Dismiss","wp-interactions"))))),S.length>0&&null===u&&(0,e.createElement)(o.PanelBody,null,C.length>0&&(0,e.createElement)("p",{className:"wpi-editor-footer"},(0,c.__)("These interactions are on this page because of their location rules.","wp-interactions")),0===C.length&&(0,e.createElement)("p",{className:"wpi-editor-footer"},(0,c.__)("There are no interactions on this page because no matches were found in the location rules.","wp-interactions")),(0,e.createElement)(o.Button,{variant:"tertiary",size:"small",href:_.manageInteractionsUrl,target:"_manage"},(0,c.__)("Manage all your interactions","wp-interacitons"))),null===u&&(0,e.createElement)("div",{ref:E},(0,e.createElement)(o.PanelBody,{title:(0,c.__)("Element Triggered","wp-interactions")},(0,e.createElement)(o.BaseControl,{className:"wpi-list-control",label:(0,e.createElement)(e.Fragment,null,(0,c.__)("Element Interactions","wp-interactions"),(0,e.createElement)(o.Button,{className:"wpi-list-control__title-tip",icon:"info-outline",iconSize:"16",size:"small",variant:"tertiary",label:(0,c.__)("Learn more","wp-interactions"),onClick:()=>window?.open("https://docs.wpinteractions.com/article/571-what-are-interactions","_docs")}))},(0,e.createElement)(yi,{type:"element",onAddInteraction:D}),(0,e.createElement)("div",null,N.map((t=>(0,e.createElement)(hi,{key:t.key,highlightEnabled:!0,interaction:t,isHighlighted:"block"===t.target.type&&l===t.target.value,onClick:()=>{p(t)},onDelete:()=>{I(t.key)}}))),!N.length&&(0,e.createElement)("div",{className:"wpi-list-control__empty-description"},(0,e.createElement)(n,{width:"32",height:"32"}),(0,e.createElement)("p",null,(0,c.__)("Define actions that occur when user interacts with elements on your page","wp-interactions")))))),(0,e.createElement)(o.PanelBody,{title:(0,c.__)("Page Triggered","wp-interactions")},(0,e.createElement)(o.BaseControl,{className:"wpi-list-control",label:(0,e.createElement)(e.Fragment,null,(0,c.__)("Page Interactions","wp-interactions"),(0,e.createElement)(o.Button,{className:"wpi-list-control__title-tip",icon:"info-outline",iconSize:"16",size:"small",variant:"tertiary",label:(0,c.__)("Learn more","wp-interactions"),onClick:()=>window?.open("https://docs.wpinteractions.com/article/571-what-are-interactions","_docs")}))},(0,e.createElement)(yi,{type:"page",onAddInteraction:D}),(0,e.createElement)("div",null,M.map((t=>(0,e.createElement)(hi,{key:t.key,highlightEnabled:!0,interaction:t,isHighlighted:"block"===t.target.type&&l===t.target.value,onClick:()=>{p(t)},onDelete:()=>{I(t.key)}}))),!M.length&&(0,e.createElement)("div",{className:"wpi-list-control__empty-description"},(0,e.createElement)(i,{width:"32",height:"32"}),(0,e.createElement)("p",null,(0,c.__)("Define actions that occur when there's a change in your page's state","wp-interactions"))))))),null!==u&&(0,e.createElement)(di,{...d,editMode:h,interaction:u,onChange:e=>x(e).then((()=>{g("edit")})),onClose:(e=!1)=>{e&&setTimeout((()=>{E.current?.querySelector(`.wpi-list__item-button--${u.key}`)?.focus()})),p(null),g("edit")},onDelete:()=>I(u.key),onDirtyChange:e=>k.current=e})):null}})})()})();