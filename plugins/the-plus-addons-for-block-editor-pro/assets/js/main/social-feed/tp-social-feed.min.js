document.addEventListener("DOMContentLoaded",()=>{tpsocialFeed(document)});function tpsocialFeed(a){let b=a.querySelectorAll(".tpgb-social-feed");b&&b.forEach(b=>{function c(a){var d=a.target;if(d.classList.contains("readbtn")&&d.closest(".tpgb-social-feed")){a.stopImmediatePropagation();let c=d.closest(".tpgb-social-feed"),m=d.getAttribute("aria-label");var e=d.closest(".tpgb-message"),h=e.closest(".tpgb-isotope .post-loop-inner"),i=f,j=e.querySelector(".showtext");if(e.classList.contains("show-text"))e.classList.remove("show-text","show-less"),d.innerHTML=m,e.querySelector(".sf-dots").style.display="inline",!0===i.ScrollOn&&!0===i.TextLimit&&(j.classList.remove(i.className),j.removeAttribute("style"));else{e.classList.add("show-text","show-less"),d.innerHTML="Show Less",e.querySelector(".sf-dots").style.display="none";var k=b.querySelectorAll(".showtext");!0===i.ScrollOn&&!0===i.TextLimit&&k&&k.forEach(function(a){a.clientHeight>=i.Height&&(j.classList.add(i.className),j.style.height=i.Height+"px")})}if(h){var l=new Isotope(h,{itemSelector:".grid-item",resizable:!0,sortBy:"original-order",layoutMode:"masonry"==g?"masonry":"fitRows"});l.layout()}}if(d.classList.contains("readbtn")&&d.closest(".fancybox-si")){let a=d.closest(".tpgb-message"),b=f,c=d.closest(".tpgb-message");a.classList.contains("show-text")?(a.classList.remove("show-text","show-less"),d.innerHTML="Show More",a.querySelector(".sf-dots").style.display="inline","true"===b.FancyScroll&&"true"===b.TextLimit&&(c.classList.remove(b.Fancyclass),c.removeAttribute("style"))):(a.classList.add("show-text","show-less"),d.innerHTML="Show Less",a.querySelector(".sf-dots").style.display="none","true"===b.FancyScroll&&"true"===b.TextLimit&&Array.from(c).forEach(function(a){a.clientHeight>=b.FancyHeight&&(a.classList.add(b.Fancyclass),a.style.height=b.FancyHeight+"px")}))}this.removeEventListener("click",a=>{c(a)})}let d=b.getAttribute("data-id"),e=b.getAttribute("data-fancy-option")?JSON.parse(b.getAttribute("data-fancy-option")):"",f=b.getAttribute("data-scroll-normal")?JSON.parse(b.getAttribute("data-scroll-normal")):"",g=b.getAttribute("data-layout"),h={Carousel:{infinite:e.loop,transition:e.transitionEffect},Toolbar:{display:{right:e.button}},contentClick:e.clickContent};e.arrows||(h.Carousel.Navigation=!1),h.Thumbs=!1,Fancybox.bind("[data-fancybox=\""+d+"\"]",h);let i=b.querySelectorAll(".grid-item.feed-Facebook");if(i&&i.forEach(a=>{let b=a.getAttribute("data-index");Fancybox.bind("[data-fancybox=\"album-"+b+"-"+d+"\"]",h)}),f&&!0===f.ScrollOn&&!1===f.TextLimit){let a=b.querySelectorAll(".tpgb-message");a&&a.forEach(function(a){a.clientHeight>=f.Height&&(a.classList.add(f.className),a.style.height=f.Height+"px")})}if(!0===f.FancyScroll&&!1===f.TextLimit){let a=b.querySelectorAll(".fancybox-si .tpgb-message");a.forEach(function(a){a.classList.add(f.Fancyclass),a.style.height=f.FancyHeight+"px"})}document.addEventListener("click",function(a){c(a)});let j=b.querySelector(".feed-load-more");j&&j.addEventListener("click",function(c){c.preventDefault();let d=j.getAttribute("data-loadattr"),e=j.getAttribute("data-display"),f=j.getAttribute("data-loadview"),g=j.getAttribute("data-loadclass"),h=j.getAttribute("data-layout"),i=j.getAttribute("data-loadingtxt"),k=j.textContent,l=c.currentTarget.closest(".tpgb-block-"+g);j.dataset.requestRunning&&"true"==j.dataset.requestRunning||(j.dataset.requestRunning="true",j.textContent=i,fetch(tpgb_config&&tpgb_config.ajax_url?tpgb_config.ajax_url:tpgb_load.ajaxUrl,{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:"action=tpgb_feed_load&view="+e+"&loadFview="+f+"&loadattr="+d}).then(function(a){return a.json()}).then(function(a){var c=a&&a.HTMLContent?a.HTMLContent:"",d=a&&a.totalFeed?a.totalFeed:"",g=a&&a.FilterStyle?a.FilterStyle:"",i=a&&a.allposttext?a.allposttext:"";if(""==a)j.classList.add("hide");else{var m=l.querySelector(".all .tpgb-category-count"),n=l.querySelector(".post-loop-inner");n.insertAdjacentHTML("beforeend",c);var o=l.querySelectorAll(".grid-item").length;if(m&&(m.innerHTML="",m.insertAdjacentHTML("beforeend",o)),"style-2"==g||"style-3"==g){var p=b.querySelectorAll(".tpgb-filter-list .tpgb-category-list:not(.all)");p&&p.forEach(function(a){var b=a.querySelector("span:nth-child(2)").dataset.hover,c=l.querySelectorAll(".grid-item."+b).length;a.querySelector("span:nth-child(1).tpgb-category-count").innerHTML="",a.querySelector("span:nth-child(1).tpgb-category-count").insertAdjacentHTML("beforeend",c)})}if(("grid"==h||"masonry"==h)&&b.classList.contains("tpgb-isotope")&&"function"==typeof tppoMaso){var q=new Isotope(n,{itemSelector:".grid-item",resizable:!0,sortBy:"original-order",layoutMode:"masonry"===h?"masonry":"fitRows"}),r=document.createElement("div");r.innerHTML=a,q.insert(r.querySelectorAll(".grid-item")),setTimeout(()=>{q.layout(),q.reloadItems()},300)}o>=d?(j.classList.add("hide"),j.parentNode.insertAdjacentHTML("beforeend","<div class=\"tpgb-feed-loaded\">"+i+"</div>")):j.textContent=k}e=+e+ +f,j.setAttribute("data-display",e)}).finally(function(){if(j.dataset.requestRunning="false",("grid"==h||"masonry"==h)&&"function"==typeof tppoMaso&&b.classList.contains("tpgb-isotope")&&tppoMaso(a),l.classList.contains("tpgb-isotope")&&("grid"==h||"masonry"==h)){var c=l.querySelectorAll(".tpgb-carousel:not(.is-initialized)");c.forEach(function(a){"function"==typeof splide_init&&splide_init(a)})}}))});let k=b.querySelector(".tpgb-feed-lazy-load");if(k&&b.classList.contains("tpgb-isotope")){var l,m,n,o,p,q,r=window,s=function(){l=r.innerWidth,m=r.innerHeight,n=document.querySelector("body").offsetHeight,p=b.offsetHeight,q=b.offsetTop+50,setTimeout(function(){p=b.offsetHeight,q=b.offsetTop+50},50)};s(),r.addEventListener("resize",s),r.addEventListener("scroll",function(c){if(c.preventDefault(),s(),o=r.pageYOffset,p=b.offsetHeight,q=b.offsetTop+50,b.querySelector(".tpgb-feed-lazy-load")&&o<n&&o+60>p+q-m){let b=k.querySelector(".feed-lazy-load"),c=b.dataset.lazyattr,d=b.dataset.totalfeed,e=b.getAttribute("data-display"),f=b.dataset.lazyview,g=b.dataset.lazyclass,h=b.dataset.lazylayout,i=b.innerHTML,j=b.closest(".tpgb-block-"+g);if(b.dataset.requestRunning&&"true"==b.dataset.requestRunning)return;b.dataset.requestRunning="true",+d>=+e&&fetch(tpgb_config&&tpgb_config.ajax_url?tpgb_config.ajax_url:tpgb_load.ajaxUrl,{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:"action=tpgb_feed_load&view="+e+"&loadFview="+f+"&loadattr="+c}).then(function(a){return a.json()}).then(function(c){var d=c&&c.HTMLContent?c.HTMLContent:"",g=c&&c.totalFeed?c.totalFeed:"",k=c&&c.FilterStyle?c.FilterStyle:"",l=c&&c.allposttext?c.allposttext:"";if(""===c)b.classList.add("hide");else{var m=j.querySelector(".all .tpgb-category-count"),n=j.querySelector(".post-loop-inner");n.insertAdjacentHTML("beforeend",d);var o=j.querySelectorAll(".grid-item").length;if(m&&(m.innerHTML="",m.appendChild(document.createTextNode(o))),"style-2"===k||"style-3"===k){var p=j.querySelectorAll(".tpgb-filter-list .tpgb-category-list:not(.all)");p&&p.forEach(function(a){var b=a.querySelector("span:nth-child(2)").dataset.hover,c=j.querySelectorAll(".grid-item."+b).length;a.querySelector("span:nth-child(1).tpgb-category-count").innerHTML="",a.querySelector("span:nth-child(1).tpgb-category-count").appendChild(document.createTextNode(c))})}if(("grid"===h||"masonry"===h)&&"function"==typeof tppoMaso&&j.classList.contains("tpgb-isotope")&&tppoMaso(a),!(o>=+g))b.innerHTML=i;else if(!b.nextElementSibling||!b.nextElementSibling.classList.contains("tpgb-feed-loaded")){b.classList.add("hide");var q=document.createElement("div");q.classList.add("tpgb-feed-loaded"),q.innerHTML=l,b.parentNode.appendChild(q)}}e=+e+ +f,b.setAttribute("data-display",e)}).finally(function(){b.dataset.requestRunning="false"}).then(function(){if(j.classList.contains("tpgb-isotope")){("grid"===h||"masonry"===h)&&"function"==typeof tppoMaso&&tppoMaso(a);var b=j.querySelectorAll(".tpgb-carousel:not(.is-initialized)");b.forEach(function(a){"function"==typeof splide_init&&splide_init(a)})}})}})}})}