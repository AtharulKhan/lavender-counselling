document.addEventListener("DOMContentLoaded",(function(){const e=document.querySelectorAll(".tp-form-block");0!==e.length&&e.forEach((e=>{let t,r,n,a={},o=null,c=null,i=!1,l=null;if(e.getAttribute("data-block-id")){const s=e.querySelector(".nxt-form");a=s.getAttribute("data-formdata")||"";const u=e.querySelector(".nxt-country-dropdown");u&&(t=u.value,u.addEventListener("change",(function(){t=this.value})));e.querySelectorAll(".nxt-time-richtext, .nxt-date-richtext").forEach((e=>{const t=e.classList.contains("nxt-time-richtext")?"time":"date";e.addEventListener("click",(e=>{e.target.type=t})),e.addEventListener("blur",(e=>{e.target.type="text"}))}));const d=s.hasAttribute("data-actionoption")&&""!==s.getAttribute("data-actionoption").trim()?JSON.parse(s.getAttribute("data-actionoption")).map((e=>e.value)):"",p=s.getAttribute("data-cap");let h,y,f="";if(d&&Array.isArray(d)){const e=d.some((e=>"redirect"===e.toLowerCase()));e&&s.hasAttribute("data-redirect")&&(f=s.getAttribute("data-redirect")),e&&s.hasAttribute("data-link-blank")&&(h=s.getAttribute("data-link-blank")),e&&s.hasAttribute("data-link-nofollow")&&(y=s.getAttribute("data-link-nofollow"))}const b=e.querySelector(".nxt-secured-option");if(b){const e=b.getAttribute("data-security"),t=JSON.parse(e)||{};n=t.securityOptions,r=t.captchaOptions}const x=(e,t)=>{if(!e||!e.hasAttribute("data-required")||"false"===e.getAttribute("data-required"))return!0;const r=e.value.trim(),n=t.getAttribute("data-error-message");if(!r)return t.textContent=n||"This field is required.",!1;return/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(r)?(t.textContent="",!0):(t.textContent=n||"Please enter a valid email address.",!1)},m=(e,t)=>{if(!e||!e.hasAttribute("data-required")||"false"===e.getAttribute("data-required"))return!0;const r=e.value.trim(),n=t.getAttribute("data-error-message");return r?(t.textContent="",!0):(t.textContent=n||"This field is required.",!1)},g=(t,r)=>{if(!t||!t.hasAttribute("data-required")||"false"===t.getAttribute("data-required"))return!0;let n=!1;if("radio"===t.type){const r=e.querySelectorAll(`input[type="radio"][name="${t.name}"]`);n=Array.from(r).some((e=>e.checked))}else n=t.checked;let a="This field is required.";if(r&&"function"==typeof r.getAttribute){const e=r.getAttribute("data-error-message");e&&(a=e)}return n?(r&&(r.textContent=""),!0):(r&&(r.textContent=a),!1)},A=(e,t)=>{if(!e||!e.hasAttribute("data-required")||"false"===e.getAttribute("data-required"))return!0;const r=ee(e.value.trim()),n=t.getAttribute("data-error-message");return r?(t.textContent="",!0):(t.textContent=n||"This field is required.",!1)},q=(e,t)=>{if(!e||!e.hasAttribute("data-required")||"false"===e.getAttribute("data-required"))return!0;const r=/^(0?[0-9]|1[0-9]|2[0-3]):([0-5][0-9])$/.test(e.value.trim()),n=t?.getAttribute("data-error-message");return r?(t.textContent="",!0):(t.textContent=n||"This field is required.",!1)},S=(e,t)=>{if(!e||!e.hasAttribute("data-required")||"false"===e.getAttribute("data-required"))return!0;const r=/^\d{4}-(0[1-9]|1[0-2])-(0[1-9]|[12][0-9]|3[01])$/.test(e.value.trim()),n=t?.getAttribute("data-error-message");return r?(t.textContent="",!0):(t.textContent=n||"Invalid date format. Use YYYY-MM-DD.",!1)},v=(e,t)=>{if(!e)return t.textContent="",!0;const r=e.getAttribute("data-pattern"),n=e.value.trim(),a=t.getAttribute("data-error-message");if(e.hasAttribute("data-required")&&"false"!==e.getAttribute("data-required")&&!n)return t.textContent=a||"This field is required.",!1;if(n&&r){if(!new RegExp(r).test(n))return t.textContent=a||"Please enter a valid number.",!1}return t.textContent="",!0},E=e.querySelectorAll(".nxt-name-richtext"),k=e.querySelectorAll(".nxt-email-richtext"),w=e.querySelectorAll(".nxt-message-richtext"),C=e.querySelectorAll(".tp-form-checkbox-button"),L=e.querySelectorAll(".tp-form-radio-button "),j=e.querySelectorAll(".nxt-option-field"),T=e.querySelectorAll(".nxt-url-richtext"),$=e.querySelectorAll(".nxt-number-richtext"),_=e.querySelectorAll(".nxt-time-richtext"),O=e.querySelectorAll(".nxt-date-richtext"),P=e.querySelectorAll(".nxt-phone-richtext"),R=e.querySelectorAll(".nxt-error-show"),D=e.querySelectorAll(".nxt-error-email"),M=e.querySelectorAll(".nxt-message-error"),N=(e.querySelectorAll(".nxt-error-checkbox"),e.querySelectorAll(".nxt-error-radiobox"),e.querySelectorAll(".nxt-error-select")),Y=e.querySelectorAll(".nxt-error-number"),U=e.querySelectorAll(".nxt-error-url"),z=e.querySelectorAll(".nxt-error-time"),J=e.querySelectorAll(".nxt-error-date"),F=e.querySelectorAll(".nxt-error-phone");E.forEach(((e,t)=>{e.addEventListener("input",(()=>m(e,R[t])))})),k.forEach(((e,t)=>{e.addEventListener("input",(()=>x(e,D[t])))})),w.forEach(((e,t)=>{e.addEventListener("input",(()=>m(e,M[t])))})),C.forEach((e=>{const t=e.querySelectorAll('input[type="checkbox"]'),r=e.querySelector(".nxt-error-checkbox");t.forEach((e=>{e.addEventListener("change",(()=>g(e,r)))}))})),L.forEach((e=>{const t=e.querySelectorAll('input[type="radio"]'),r=e.querySelector(".nxt-error-radiobox");t.forEach((e=>{e.addEventListener("change",(()=>g(e,r)))}))})),j.forEach(((e,t)=>{e.addEventListener("change",(()=>m(e,N[t])))})),$.forEach(((e,t)=>{e.addEventListener("input",(()=>m(e,Y[t])))})),T.forEach(((e,t)=>{e.addEventListener("input",(()=>A(e,U[t])))})),_.forEach(((e,t)=>{e.addEventListener("input",(()=>q(e,U[t])))})),O.forEach(((e,t)=>{e.addEventListener("input",(()=>S(e,J[t])))})),P.forEach(((e,t)=>{e.addEventListener("input",(()=>v(e,F[t])))}));const H=()=>{let e=!0;const t=(t,r,n)=>{t.forEach(((t,a)=>{if(t.hasAttribute("data-required")){const o=r(t,n[a]);e=e&&o}}))};return t(E,m,R),t(k,x,D),t(w,m,M),t(j,m,N),t($,m,Y),t(T,m,U),t(_,q,z),t(O,S,J),t(P,v,F),C.forEach((t=>{const r=t.querySelector('input[type="checkbox"]'),n=t.querySelector(".nxt-error-checkbox");if(r&&r.hasAttribute("data-required")){const t=g(r,n);e=e&&t}})),L.forEach((t=>{const r=t.querySelector('input[type="radio"]'),n=t.querySelector(".nxt-error-radiobox");if(r&&r.hasAttribute("data-required")){const t=g(r,n);e=e&&t}})),e};if("honeypot"===n){s.querySelectorAll("input:not([type='submit']), textarea, select").forEach(((e,t)=>{const r=document.createElement("div");r.style.display="none";const n=document.createElement("input");n.type="text",n.name=`honeypot_${t+1}`,n.className="nxt-honeypot-field",r.appendChild(n),e.insertAdjacentElement("afterend",r)}))}const I=e.querySelector(".nxt-accept-richtext"),V=e.querySelector(".nxt-submit-button");I&&(I.required?V.disabled=!I.checked:V.disabled=!1,I.addEventListener("change",(()=>{I.required?V.disabled=!I.checked:V.disabled=!1})));const W=e.querySelector(".nxt-form"),X=()=>{const t=document.createElement("script");t.src="https://challenges.cloudflare.com/turnstile/v0/api.js?render=explicit",t.async=!0,t.defer=!0,e.appendChild(t),t.onload=()=>{}};if(W){W.addEventListener("submit",(function(e){if(e.preventDefault(),!H())return;if(i)return;if(i=!0,"recaptcha"===n)if("v3"===r)grecaptcha.ready((function(){grecaptcha.execute(p,{action:"submit"}).then(Q)}));else if("v2i"===r)grecaptcha.execute(o);else if("v2"===r){const e=grecaptcha.getResponse(o);e?Q(e):(i=!1,te("Please complete the reCAPTCHA.",!0))}else i=!1;else"cloudflare"===n?(!l&&G(),turnstile.reset(l),turnstile.execute(l)):Z()}));"recaptcha"===n?(t=>{const r=document.createElement("script");r.src="v3"===t?`https://www.google.com/recaptcha/api.js?render=${p}`:"https://www.google.com/recaptcha/api.js?onload=onRecaptchaLoadCallback&render=explicit",r.async=!0,r.defer=!0,e.appendChild(r),r.onload=()=>{"v3"===t&&grecaptcha.ready((()=>{}))}})(r):"cloudflare"===n&&X()}let B=b&&b.hasAttribute("data-cloud")?b.getAttribute("data-cloud"):"";const G=()=>{const t=e.querySelector("#recaptcha-container");t&&(l=turnstile.render(t,{sitekey:B,callback:K}))},K=e=>{c=e,Z()};const Q=e=>{c=e,Z()},Z=()=>{!function(a){const o=new FormData,l=e=>{const r=[],n=e.type;let a="";const o="checkbox"===n?e.closest(".tp-form-checkbox-button")?.querySelector(".nxt-check-title-label"):"radio"===n?e.closest(".tp-form-radio-button")?.querySelector(".nxt-radio-title-label"):e.closest(".nxt-input-container")?.previousElementSibling||e.closest(".nxt-radio-box")?.querySelector("label")||e.closest(".nxt-time-input")?.querySelector(".nxt-time-label")||e.closest(".nxt-date-input")?.querySelector(".nxt-date-label")||e.closest(".nxt-option-container")?.querySelector(".nxt-option-label")||e.closest(".nxt-phone-input")?.querySelector(".nxt-phone-label")||e.closest(".nxt-message-input")?.querySelector(".nxt-message-label");if(a=o?o.innerText.trim():e.name,("radio"===n||"checkbox"===n)&&!e.checked)return r;let c=e.value||"";return"tel"===n&&t&&e.value&&(c=`${t} ${e.value}`),c&&r.push({label:a,value:c}),r},s=e.querySelectorAll(".nxt-form input:not([type='submit']), .nxt-form select, .nxt-form textarea"),u=Array.from(s),p=new Map;u.forEach((t=>{if("checkbox"===t.type){const r=t.name;if(!p.has(r)){const n=e.querySelectorAll(`input[name="${r}"]:checked`),a=Array.from(n).map((e=>e.value));if(a.length>0){const e=t.closest(".tp-form-checkbox-button")?.querySelector(".nxt-check-title-label")?.innerText.trim()||r;o.append(e,a.join(", "))}p.set(r,!0)}}else{l(t).forEach((({label:e,value:t})=>{o.append(e,t)}))}}));[...new Set(u.map((e=>e.name)))].forEach((e=>{const t=u.filter((t=>t.name===e)).map((e=>l(e))).flat();if(t.length>0){const r=["Email","Auto Respond Email"];Array.isArray(d)&&d.some((e=>r.includes(e)));if(Array.isArray(d)&&d.some((e=>!r.includes(e)))){const r=t.map((e=>e.value)).join(", ");o.append(`${e}-field`,r)}}}));const b=new Map;e.querySelectorAll('input[type="radio"]:checked').forEach((e=>{const t=e.closest(".nxt-radio-box")?.querySelector(".nxt-radio-title-label"),r=t?.innerText.trim()||"radio-group";b.has(r)||b.set(r,[]),b.get(r).push(e.value)})),b.forEach(((e,t)=>{const r=e.join(", ");o.append(t,r)})),o.append("actionOption",a||[]),o.append("action","nxt_form_pro_action"),o.append("nonce",tpgb_config.tpgb_nonce),"recaptcha"===n||"cloudflare"===n?(o.append("captchaopt",r),o.append("securityValue",n),o.append("g-recaptcha-response",c||"")):o.append("captchaopt","none");if([{to:"emailto1",subject:"subject1",message1:"message1"},{subject:"subject2",message1:"message2"}].forEach(((e,t)=>{const r=a[`emailTo${t+1}`],n=a[`subject${t+1}`],c=a[`message${t+1}`];r&&o.append(e.to,r),n&&o.append(e.subject,n),c&&o.append(e.message1,c)})),!d||0===d.length)return te("No form action is selected.",!0),void(i=!1);if(H()){if(d&&Array.isArray(d)&&(1!==d.length||"redirect"!==d[0].toLowerCase())){const t=e.querySelector(".nxt-submit"),r=t.querySelector(".nxt-loader"),n=t.querySelector(".nxt-button-svg");let a=t.querySelector(".nxt-btn-text");a&&(a.style.display="none"),n&&(n.style.display="none"),r.style.display="inline-block",fetch(tpgb_config.ajax_url,{method:"POST",body:o,credentials:"same-origin",headers:{"X-WP-Nonce":tpgb_config.tpgb_nonce}}).then((e=>e.json())).then((t=>{if(i=!1,r.style.display="none",n&&(n.style.display="inline-block"),a&&(a.style.display="inline-block"),t.success){const t=e.querySelector(".nxt-success-message").getAttribute("data-success-message")||"Your submission was successful.";te(t,!1),setTimeout((()=>{window.location.reload()}),1e3)}else{const e=t.data||"Unknown error occurred.";te(e,!0),r.style.display="none",n&&(n.style.display="inline-block"),a&&(a.style.display="inline-block")}})).catch((e=>{r.style.display="none",n&&(n.style.display="inline-block"),a&&(a.style.display="inline-block"),te("An error occurred while sending the form data.",!0),i=!1}))}setTimeout((()=>{if(f&&ee(f))if("1"===h){let e=window.open("","_blank");if("1"===y){let t=e.document.createElement("a");t.setAttribute("href",f),t.setAttribute("rel","nofollow"),e.document.body.appendChild(t),t.click()}else e.location.href=f}else window.location.href=f}),2e3)}}(a)};const ee=e=>{try{return new URL(e),!0}catch(e){return!1}},te=(t,r)=>{const n=e.querySelector(".nxt-success-message");n&&(n.textContent=t,n.classList.remove("nxt-success-message","nxt-error-message"),n.classList.add(r?"nxt-error-message":"nxt-success-message"),n.style.display="block")};window.onRecaptchaLoadCallback=function(){if(e.querySelector("#recaptcha-container"))if("v2i"===r){e.querySelector("#recaptcha-container")&&(o=grecaptcha.render("recaptcha-container",{sitekey:p,size:"invisible",callback:Q}))}else if("v2"===r){e.querySelector("#recaptcha-container")&&(o=grecaptcha.render("recaptcha-container",{sitekey:p,size:"normal"}))}}}}))}));