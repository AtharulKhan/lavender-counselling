var loading=!1;document.addEventListener("DOMContentLoaded",function(){var a=document.querySelectorAll(".tpgb-lazy-load");a&&a.forEach(function(a){var b=a.closest(".tpgb-isotope"),c=a.closest(".tpgb-metro"),d=b?b:c;d.offsetHeight&&lazyInit(d)})});var windowWidth,windowHeight,documentHeight,scrollTop,containerHeight,containerOffset,tpagblazystore="",recalcValues=function(){windowWidth=window.innerWidth,windowHeight=window.innerHeight,documentHeight=document.body.clientHeight};function lazyInit(a){tpagblazystore=a;var b=a.closest(".tpgb-tab-content"),c=a.closest(".tpgb-tab-content")&&a.closest(".tpgb-tab-content").parentNode.closest(".tpgb-tab-content")?a.closest(".tpgb-tab-content").parentNode.closest(".tpgb-tab-content").parentNode.closest(".tpgb-tab-content"):"";if(!(c&&c.length&&!c.classList.contains("active"))){var d=a.closest(".tpgb-tab-content")?a.closest(".tpgb-tab-content").parentNode.closest(".tpgb-tab-content"):"";d&&d.length&&!d.classList.contains("active")||b&&!b.classList.contains("active")||(window.addEventListener("resize",recalcValues),window.removeEventListener("scroll",tpgblazycall),window.addEventListener("scroll",tpgblazycall))}}function tpgblazycall(a){a.preventDefault(),recalcValues(),scrollTop=window.scrollY;var b=tpagblazystore.offsetHeight,c=tpagblazystore.offsetTop+50;scrollTop<documentHeight&&scrollTop>b+c-windowHeight&&!loading&&(loading=!0,tpgb_lazy_load_ajax(tpagblazystore))}function tpgb_lazy_load_ajax(a=""){var b=a.querySelector(".post-lazy-load"),c=JSON.parse(b.dataset.dypost),d=b.dataset.postOption;if((null==c.offset_posts||""==c.offset_posts)&&(c.offset_posts=0),c.total_page>=c.page){c.offset=parseInt(c.page-1)*parseInt(c.load_more)+parseInt(c.display_post)+parseInt(c.offset_posts);var e=new XMLHttpRequest;e.open("POST",tpgb_config&&tpgb_config.ajax_url?tpgb_config.ajax_url:tpgb_load.ajaxUrl,!0),e.setRequestHeader("Content-Type","application/x-www-form-urlencoded;"),e.onload=function(){if(200===e.status&&400>e.status){var a=e.responseText;if(""===a)b.classList.add("hide");else{var d=document.getElementById(c.load_class),f=d.querySelector(".post-loop-inner");if(("grid"===c.layout||"masonry"===c.layout)&&d.classList.contains("tpgb-isotope")){var g=new Isotope(f,{itemSelector:".grid-item",resizable:!0,sortBy:"original-order",layoutMode:"masonry"==c.layout?"masonry":"fitRows",transitionDuration:c.disableAnim?0:"0.4s"}),h=document.createElement("div");h.innerHTML=a,g.insert(h.querySelectorAll(".grid-item")),g.layout(),g.reloadItems()}if(d.classList.contains("tpgb-metro")&&(f.insertAdjacentHTML("beforeend",a),"function"==typeof tppoMetro&&tppoMetro(document)),"function"==typeof tppostList&&tppostList(document),0<d.querySelectorAll(".tpgb-category-filter").length&&(d.querySelectorAll(" .tpgb-filter-data .tpgb-categories > .tpgb-filter-list > a").forEach(function(a){var b=a.dataset.filter,c=0;void 0!==b&&""!==b&&("*"===b?c=d.querySelectorAll(".post-loop-inner .grid-item").length:c=d.querySelectorAll(" .post-loop-inner .grid-item"+b).length),0<c&&null!=a.querySelector(".tpgb-category-count")&&(a.querySelector(".tpgb-category-count").innerHTML=c)}),"function"==typeof tpFilter&&tpFilter(d)),d.classList.contains("tpgb-equal-height")&&"function"==typeof equalHeightFun&&(equalHeightFun(d),setTimeout(function(){g.layout()},100)),0<d.querySelectorAll(".tpgb-messagebox").length&&"function"==typeof tpmsgBox&&tpmsgBox(d),0<d.querySelectorAll(".tpgb-fancy-popup").length){let a=d.querySelectorAll(".tpgb-fancy-popup");a.forEach(function(a){tpgb_fancy_popup(a)})}0<d.querySelectorAll(".tpgb-accordion").length&&"function"==typeof accordionJS&&accordionJS(d),0<d.querySelectorAll(".tpgb-heading-animation").length&&"function"==typeof tpheAnim&&tpheAnim(d)}c.page++,c.page===c.total_page?(b.classList.add("hide"),c.page=c.page,b.parentNode.insertAdjacentHTML("beforeend","<div class=\"tpgb-post-loaded\">"+c.loaded_posts+"</div>")):(c.page=c.page,b.setAttribute("data-page",c.page));var i=JSON.stringify(c);b.dataset.dypost=i}loading=!1},e.send("action=tpgb_post_load&option="+encodeURIComponent(d)+"&dyOpt="+encodeURIComponent(JSON.stringify(c)))}else b.classList.add("hide")}